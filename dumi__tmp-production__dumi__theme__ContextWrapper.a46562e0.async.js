"use strict";(self.webpackChunkbiominer_components=self.webpackChunkbiominer_components||[]).push([[923,242],{34576:function($a,Pt,g){g.r(Pt),g.d(Pt,{default:function(){return _n}});var yn=g(5574),v=g.n(yn),s=g(97857),Qt=g.n(s),wt=g(67294),Lt=g(61748),Sa=g(64236),Zn=g(68696),Rn=g(90482),t=g(92279),Ma=g(85893),ja=Qt()({},t);function _n(){var Gn=(0,Lt.pC)(),xa=(0,wt.useState)(!1),Fn=v()(xa,2),Na=Fn[0],Ne=Fn[1],Oe=(0,wt.useRef)(Lt.m8.location.pathname);return(0,wt.useEffect)(function(){return Lt.m8.listen(function(pn){pn.location.pathname!==Oe.current&&(Oe.current=pn.location.pathname,document.documentElement.scrollTo(0,0))})},[]),(0,Ma.jsx)(Sa.D.Provider,{value:{pkg:{name:"biominer-components",version:"0.3.22",license:"MIT",authors:[]},historyType:"browser",entryExports:ja,demos:Zn.DE,components:Zn.wx,locales:Rn.k,loading:Na,setLoading:Ne,hostname:void 0,themeConfig:{footer:'Open Source - MIT Licensed | Copyright\xA92020 <br /> Powered by <a href="https://biominer.3steps.cn">OpenProphetDB Team</a>',prefersColor:{default:"light",switch:!0},nprogress:!0,lastUpdated:!0,name:"UI4NM"},_2_level_nav_available:!0},children:Gn})}},23242:function($a,Pt,g){g.r(Pt),g.d(Pt,{stat_total_node_count:function(){return yn},stat_total_relation_count:function(){return v}});var yn=function(Qt){return Qt.reduce(function(wt,Lt){return wt+Lt.entity_count},0)},v=function(Qt){return Qt.reduce(function(wt,Lt){return wt+Lt.relation_count},0)}},92279:function($a,Pt,g){g.r(Pt),g.d(Pt,{AiIcon:function(){return Xo},BatchNodesSearcher:function(){return pi},CanvasStatisticsChart:function(){return ji},DataArea:function(){return Ur},EdgeTable:function(){return Li},GraphStoreForm:function(){return ki},GraphStoreTable:function(){return Ai},GraphTable:function(){return Ti},GuideScoperViewer:function(){return Fn},KnowledgeGraph:function(){return Wd},KnowledgeGraphEditor:function(){return Tl},LinkedNodesSearcher:function(){return fi},MarkdownViewer:function(){return mn},Movable:function(){return _t},NodeTable:function(){return wi},NodeUploader:function(){return ui},PathologyViewer:function(){return ja},PlotlyViewer:function(){return vn},QueryForm:function(){return Si},ReactChatPlugin:function(){return rl},SharedNodesSearcher:function(){return vi},SimilarityChart:function(){return bi},SimilarityNodesSearcher:function(){return yi},StatisticsChart:function(){return Ii},StatisticsDataArea:function(){return Yr},Toolbar:function(){return Nn},TransferTable:function(){return si},UserIcon:function(){return al}});var yn=g(5574),v=g.n(yn),s=g(67294),Qt=g(69203),wt=g.n(Qt),Lt={message:"Faster and stronger heavy-duty components will come soon."},Sa={message:"\u7A0D\u540E\u5B8C\u6210"},Zn=function(e){return e==="zh_CN"?Sa:Lt},Rn=Zn,t=g(85893),Ma=function(e){var n=e.style,a=e.locale,r=e.id,i=e.prefixUrl,o=e.tileSources,d=e.showNavigator,c=e.degrees,y=e.showRotationControl,S="https://cdn.jsdelivr.net/npm/openseadragon@2.4/build/openseadragon/images/",M=(0,s.useState)(Rn("en_US")),N=v()(M,2),h=N[0],w=N[1];return(0,s.useEffect)(function(){a&&w(Rn(a))},[a]),(0,s.useEffect)(function(){console.log("Test: ",r,o),wt()({id:r,prefixUrl:i!==void 0?i:S,tileSources:o,showNavigator:d!==void 0?d:!0,degrees:c!==void 0?c:0,showRotationControl:y!==void 0?y:!1})},[r,i,o,d,c,y]),(0,t.jsx)("div",{className:"pathology-viewer",style:n,children:(0,t.jsx)("div",{id:r,className:"pathology-viewer__container"})})},ja=Ma,_n="https://biosolver.cn/#/grna-query-details?entrezId=",Gn=function(e,n,a){return a==9606||a==10090?"".concat(e).concat(n,"&taxid=").concat(a,"&isEmbeded=true"):"".concat(e).concat(n,"&isEmbeded=true")},xa=function(e){var n=(0,s.useRef)(null),a=e.geneId,r=e.taxid,i=e.url,o=e.id,d=(0,s.useState)(Gn(_n,a,r)),c=v()(d,2),y=c[0],S=c[1],M=(0,s.useState)(o||"guide-scoper-viewer"),N=v()(M,2),h=N[0],w=N[1];return(0,s.useEffect)(function(){if(i&&i!==_n){var p=Gn(i,a,r);S(p),window.addEventListener("message",function(u){var f=new URL(y).origin;if(u.origin===f&&u.data&&u.data.type==="resizeIframe"){var b=document.getElementById(h);b&&(e.height||(b.style.height="".concat(u.data.height,"px")),e.width||(b.style.width="".concat(u.data.width,"px")))}})}},[i]),(0,s.useEffect)(function(){o&&w(o)},[o]),(0,t.jsx)("iframe",{id:h,className:"guide-scoper-viewer",src:y,ref:n,width:e.width||"100%",height:e.height||"100%",scrolling:"auto"})},Fn=xa,Na=g(19632),Ne=g.n(Na),Oe=g(32983),pn=g(49175),Xa=g(76199),Hi=function(e){var n=(0,s.useState)(null),a=v()(n,2),r=a[0],i=a[1],o=(0,s.useState)(""),d=v()(o,2),c=d[0],y=d[1],S=(0,s.useState)(Ne()(e.rehypePlugins||[])),M=v()(S,2),N=M[0],h=M[1],w=(0,s.useState)([Xa.Z].concat(Ne()(e.remarkPlugins||[]))),p=v()(w,2),u=p[0],f=p[1],b=function(D){if(D.match(/^(minio|file):\/\//))return e.getFile?e.getFile({filelink:D}).then(function(k){return k}).catch(function(k){return k.data.msg?k.data.msg:k.data}):new Promise(function(k,U){k("Please specify getFile function.")});try{return fetch(D).then(function(k){return k.status!==200?"No Content.":k.text()})}catch(k){return console.log("Cannot fetch ".concat(D,", the reason is ").concat(k)),new Promise(function(U,F){F("No Content.")})}};return(0,s.useEffect)(function(){!e.url&&!e.markdown?console.log("MarkdownViewer: no url or markdown"):(e.url&&(b(e.url).then(function(L){return i(L||null)}),y(e.url)),e.markdown&&(i(e.markdown),y(e.markdown)))},[e.url,e.markdown]),r?(0,t.jsx)(pn.D,{rehypePlugins:N,className:"markdown-viewer",remarkPlugins:u,children:r},c):(0,t.jsx)(Oe.Z,{})},mn=(0,s.memo)(Hi),Ki=g(97857),m=g.n(Ki),Ji=g(12444),Vt=g.n(Ji),$i=g(72004),Wt=g.n($i),Xi=g(25098),qa=g.n(Xi),qi=g(31996),eo=g.n(qi),to=g(26037),no=g.n(to),q=g(5963),ao=g(45697),Te=g.n(ao),er=["shiftKey","ctrlKey"],ro=["calendar","fromNow"],io=g(42559),tr=function(e){return e.replace(/^\s+|\s+$/g,"")},oo=Object.defineProperty,nr=Object.getOwnPropertySymbols,lo=Object.prototype.hasOwnProperty,so=Object.prototype.propertyIsEnumerable,ar=(l,e,n)=>e in l?oo(l,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[e]=n,co=(l,e)=>{for(var n in e||(e={}))lo.call(e,n)&&ar(l,n,e[n]);if(nr)for(var n of nr(e))so.call(e,n)&&ar(l,n,e[n]);return l};const Su=l=>React.createElement("svg",co({xmlns:"http://www.w3.org/2000/svg",width:"1.5em",height:"1.5em",viewBox:"0 0 24 24"},l),React.createElement("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),React.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}));var uo="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxLjVlbSIgaGVpZ2h0PSIxLjVlbSIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMi4wMSAyMSAyMyAxMiAyLjAxIDMgMiAxMGwxNSAyLTE1IDJ6Ii8+PHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjwvc3ZnPg==";function rr(l){var e=(0,s.useState)(""),n=v()(e,2),a=n[0],r=n[1],i=function(S){r(S.target.value)},o=function(S){var M=tr(a);M.length&&c(M)},d=function(S){if((l.onSendKey===void 0||S[l.onSendKey])&&S.charCode===13){var M=tr(a);return M.length&&c(M),S.preventDefault(),!1}},c=function(S){l.onSendMessage(S),r("")};return(0,t.jsxs)("div",{className:"react-chat-inputBox ".concat(l.disabled?"disabled":""),children:[(0,t.jsx)(io.Z,{maxRows:3,className:"react-chat-textarea",placeholder:l.disabled?l.disabledInputPlaceholder:l.placeholder,value:a,onChange:i,onKeyPress:d,autoFocus:!0,disabled:l.disabled}),(0,t.jsx)("button",{className:"react-chat-sendButton",onClick:o,disabled:l.disabled,children:(0,t.jsx)("img",{src:uo,className:l.disabled?"react-chat-SendIcon-disable":"react-chat-SendIcon"})})]})}rr.propTypes={onSendMessage:Te().func.isRequired,disabled:Te().bool,disabledInputPlaceholder:Te().string,placeholder:Te().string,onSendKey:Te().oneOf(er)};var ho=g(30381),Ca=g.n(ho),fo=Object.defineProperty,ir=Object.getOwnPropertySymbols,go=Object.prototype.hasOwnProperty,yo=Object.prototype.propertyIsEnumerable,or=(l,e,n)=>e in l?fo(l,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[e]=n,po=(l,e)=>{for(var n in e||(e={}))go.call(e,n)&&or(l,n,e[n]);if(ir)for(var n of ir(e))yo.call(e,n)&&or(l,n,e[n]);return l};const Mu=l=>React.createElement("svg",po({xmlns:"http://www.w3.org/2000/svg",width:24,height:24},l),React.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),React.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"}));var mo="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCI+PHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjxwYXRoIGQ9Ik0xMiAyQzYuNDggMiAyIDYuNDggMiAxMnM0LjQ4IDEwIDEwIDEwIDEwLTQuNDggMTAtMTBTMTcuNTIgMiAxMiAyem0xIDE1aC0ydi0yaDJ2MnptMC00aC0yVjdoMnY2eiIvPjwvc3ZnPg==",vo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYAQMAAADaua+7AAAABlBMVEUAgAAAgAAvApEWAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAFklEQVQImWNgIAFwMDSAaWYGA2K1AAAiqQC8t2zWVgAAAABJRU5ErkJggg==",So=Object.defineProperty,lr=Object.getOwnPropertySymbols,Mo=Object.prototype.hasOwnProperty,jo=Object.prototype.propertyIsEnumerable,sr=(l,e,n)=>e in l?So(l,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[e]=n,xo=(l,e)=>{for(var n in e||(e={}))Mo.call(e,n)&&sr(l,n,e[n]);if(lr)for(var n of lr(e))jo.call(e,n)&&sr(l,n,e[n]);return l};const ju=l=>React.createElement("svg",xo({className:"dislike_svg__icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:200,height:200},l),React.createElement("path",{d:"M885.9 490.3c3.6-12 5.4-24.4 5.4-37 0-28.3-9.3-55.5-26.1-77.7 3.6-12 5.4-24.4 5.4-37 0-28.3-9.3-55.5-26.1-77.7 3.6-12 5.4-24.4 5.4-37 0-51.6-30.7-98.1-78.3-118.4a66.1 66.1 0 0 0-26.5-5.4H144c-17.7 0-32 14.3-32 32v364c0 17.7 14.3 32 32 32h129.3l85.8 310.8C372.9 889 418.9 924 470.9 924c29.7 0 57.4-11.8 77.9-33.4 20.5-21.5 31-49.7 29.5-79.4l-6-122.9h239.9c12.1 0 23.9-3.2 34.3-9.3 40.4-23.5 65.5-66.1 65.5-111 0-28.3-9.3-55.5-26.1-77.7zM184 456V172h81v284h-81zm627.2 160.4H496.8l9.6 198.4c.6 11.9-4.7 23.1-14.6 30.5-6.1 4.5-13.6 6.8-21.1 6.7a44.28 44.28 0 0 1-42.2-32.3L329 459.2V172h415.4a56.85 56.85 0 0 1 33.6 51.8c0 9.7-2.3 18.9-6.9 27.3l-13.9 25.4 21.9 19a56.76 56.76 0 0 1 19.6 43c0 9.7-2.3 18.9-6.9 27.3l-13.9 25.4 21.9 19a56.76 56.76 0 0 1 19.6 43c0 9.7-2.3 18.9-6.9 27.3l-14 25.5 21.9 19a56.76 56.76 0 0 1 19.6 43c0 19.1-11 37.5-28.8 48.4z"}));var No="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PHBhdGggZD0iTTg4NS45IDQ5MC4zYzMuNi0xMiA1LjQtMjQuNCA1LjQtMzcgMC0yOC4zLTkuMy01NS41LTI2LjEtNzcuNyAzLjYtMTIgNS40LTI0LjQgNS40LTM3IDAtMjguMy05LjMtNTUuNS0yNi4xLTc3LjcgMy42LTEyIDUuNC0yNC40IDUuNC0zNyAwLTUxLjYtMzAuNy05OC4xLTc4LjMtMTE4LjRhNjYuMSA2Ni4xIDAgMCAwLTI2LjUtNS40SDE0NGMtMTcuNyAwLTMyIDE0LjMtMzIgMzJ2MzY0YzAgMTcuNyAxNC4zIDMyIDMyIDMyaDEyOS4zbDg1LjggMzEwLjhDMzcyLjkgODg5IDQxOC45IDkyNCA0NzAuOSA5MjRjMjkuNyAwIDU3LjQtMTEuOCA3Ny45LTMzLjQgMjAuNS0yMS41IDMxLTQ5LjcgMjkuNS03OS40bC02LTEyMi45aDIzOS45YzEyLjEgMCAyMy45LTMuMiAzNC4zLTkuMyA0MC40LTIzLjUgNjUuNS02Ni4xIDY1LjUtMTExIDAtMjguMy05LjMtNTUuNS0yNi4xLTc3Ljd6TTE4NCA0NTZWMTcyaDgxdjI4NGgtODF6bTYyNy4yIDE2MC40SDQ5Ni44bDkuNiAxOTguNGMuNiAxMS45LTQuNyAyMy4xLTE0LjYgMzAuNS02LjEgNC41LTEzLjYgNi44LTIxLjEgNi43YTQ0LjI4IDQ0LjI4IDAgMCAxLTQyLjItMzIuM0wzMjkgNDU5LjJWMTcyaDQxNS40YTU2Ljg1IDU2Ljg1IDAgMCAxIDMzLjYgNTEuOGMwIDkuNy0yLjMgMTguOS02LjkgMjcuM2wtMTMuOSAyNS40IDIxLjkgMTlhNTYuNzYgNTYuNzYgMCAwIDEgMTkuNiA0M2MwIDkuNy0yLjMgMTguOS02LjkgMjcuM2wtMTMuOSAyNS40IDIxLjkgMTlhNTYuNzYgNTYuNzYgMCAwIDEgMTkuNiA0M2MwIDkuNy0yLjMgMTguOS02LjkgMjcuM2wtMTQgMjUuNSAyMS45IDE5YTU2Ljc2IDU2Ljc2IDAgMCAxIDE5LjYgNDNjMCAxOS4xLTExIDM3LjUtMjguOCA0OC40eiIvPjwvc3ZnPg==",Co=Object.defineProperty,cr=Object.getOwnPropertySymbols,Io=Object.prototype.hasOwnProperty,bo=Object.prototype.propertyIsEnumerable,dr=(l,e,n)=>e in l?Co(l,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[e]=n,wo=(l,e)=>{for(var n in e||(e={}))Io.call(e,n)&&dr(l,n,e[n]);if(cr)for(var n of cr(e))bo.call(e,n)&&dr(l,n,e[n]);return l};const xu=l=>React.createElement("svg",wo({className:"like_svg__icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:200,height:200},l),React.createElement("path",{d:"M885.9 533.7c16.8-22.2 26.1-49.4 26.1-77.7 0-44.9-25.1-87.4-65.5-111.1a67.67 67.67 0 0 0-34.3-9.3H572.4l6-122.9c1.4-29.7-9.1-57.9-29.5-79.4A106.62 106.62 0 0 0 471 99.9c-52 0-98 35-111.8 85.1l-85.9 311H144c-17.7 0-32 14.3-32 32v364c0 17.7 14.3 32 32 32h601.3c9.2 0 18.2-1.8 26.5-5.4 47.6-20.3 78.3-66.8 78.3-118.4 0-12.6-1.8-25-5.4-37 16.8-22.2 26.1-49.4 26.1-77.7 0-12.6-1.8-25-5.4-37 16.8-22.2 26.1-49.4 26.1-77.7-.2-12.6-2-25.1-5.6-37.1zM184 852V568h81v284h-81zm636.4-353-21.9 19 13.9 25.4a56.2 56.2 0 0 1 6.9 27.3c0 16.5-7.2 32.2-19.6 43l-21.9 19 13.9 25.4a56.2 56.2 0 0 1 6.9 27.3c0 16.5-7.2 32.2-19.6 43l-21.9 19 13.9 25.4a56.2 56.2 0 0 1 6.9 27.3c0 22.4-13.2 42.6-33.6 51.8H329V564.8l99.5-360.5a44.1 44.1 0 0 1 42.2-32.3c7.6 0 15.1 2.2 21.1 6.7 9.9 7.4 15.2 18.6 14.6 30.5l-9.6 198.4h314.4C829 418.5 840 436.9 840 456c0 16.5-7.2 32.1-19.6 43z"}));var Lo="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PHBhdGggZD0iTTg4NS45IDUzMy43YzE2LjgtMjIuMiAyNi4xLTQ5LjQgMjYuMS03Ny43IDAtNDQuOS0yNS4xLTg3LjQtNjUuNS0xMTEuMWE2Ny42NyA2Ny42NyAwIDAgMC0zNC4zLTkuM0g1NzIuNGw2LTEyMi45YzEuNC0yOS43LTkuMS01Ny45LTI5LjUtNzkuNEExMDYuNjIgMTA2LjYyIDAgMCAwIDQ3MSA5OS45Yy01MiAwLTk4IDM1LTExMS44IDg1LjFsLTg1LjkgMzExSDE0NGMtMTcuNyAwLTMyIDE0LjMtMzIgMzJ2MzY0YzAgMTcuNyAxNC4zIDMyIDMyIDMyaDYwMS4zYzkuMiAwIDE4LjItMS44IDI2LjUtNS40IDQ3LjYtMjAuMyA3OC4zLTY2LjggNzguMy0xMTguNCAwLTEyLjYtMS44LTI1LTUuNC0zNyAxNi44LTIyLjIgMjYuMS00OS40IDI2LjEtNzcuNyAwLTEyLjYtMS44LTI1LTUuNC0zNyAxNi44LTIyLjIgMjYuMS00OS40IDI2LjEtNzcuNy0uMi0xMi42LTItMjUuMS01LjYtMzcuMXpNMTg0IDg1MlY1NjhoODF2Mjg0aC04MXptNjM2LjQtMzUzLTIxLjkgMTkgMTMuOSAyNS40YTU2LjIgNTYuMiAwIDAgMSA2LjkgMjcuM2MwIDE2LjUtNy4yIDMyLjItMTkuNiA0M2wtMjEuOSAxOSAxMy45IDI1LjRhNTYuMiA1Ni4yIDAgMCAxIDYuOSAyNy4zYzAgMTYuNS03LjIgMzIuMi0xOS42IDQzbC0yMS45IDE5IDEzLjkgMjUuNGE1Ni4yIDU2LjIgMCAwIDEgNi45IDI3LjNjMCAyMi40LTEzLjIgNDIuNi0zMy42IDUxLjhIMzI5VjU2NC44bDk5LjUtMzYwLjVhNDQuMSA0NC4xIDAgMCAxIDQyLjItMzIuM2M3LjYgMCAxNS4xIDIuMiAyMS4xIDYuNyA5LjkgNy40IDE1LjIgMTguNiAxNC42IDMwLjVsLTkuNiAxOTguNGgzMTQuNEM4MjkgNDE4LjUgODQwIDQzNi45IDg0MCA0NTZjMCAxNi41LTcuMiAzMi4xLTE5LjYgNDN6Ii8+PC9zdmc+",To=Object.defineProperty,ur=Object.getOwnPropertySymbols,Do=Object.prototype.hasOwnProperty,Eo=Object.prototype.propertyIsEnumerable,hr=(l,e,n)=>e in l?To(l,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[e]=n,Ao=(l,e)=>{for(var n in e||(e={}))Do.call(e,n)&&hr(l,n,e[n]);if(ur)for(var n of ur(e))Eo.call(e,n)&&hr(l,n,e[n]);return l};const Nu=l=>React.createElement("svg",Ao({className:"delete_svg__icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:200,height:200},l),React.createElement("path",{d:"M382.32 405.358v384a20.626 20.626 0 0 1-21.577 21.284h-43.3a20.626 20.626 0 0 1-21.578-21.357v-384A20.626 20.626 0 0 1 317.443 384h43.154a20.626 20.626 0 0 1 21.577 21.358h.073zm172.91 0v384a20.626 20.626 0 0 1-21.65 21.284h-43.155a20.626 20.626 0 0 1-21.577-21.357v-384A20.626 20.626 0 0 1 490.425 384h43.155a20.626 20.626 0 0 1 21.577 21.358zm172.91 0v384a20.626 20.626 0 0 1-21.65 21.284h-43.155a20.626 20.626 0 0 1-21.577-21.357l-.073-384A20.626 20.626 0 0 1 663.262 384h43.227a20.626 20.626 0 0 1 21.578 21.358zm86.381 482.67V256H209.484v631.954a74.825 74.825 0 0 0 14.482 45.056c3.365 3.804 5.778 5.632 7.095 5.632h561.883c1.317 0 3.657-1.828 7.095-5.632a74.825 74.825 0 0 0 14.556-44.983zM360.743 170.641h302.519l-32.402-77.97a19.017 19.017 0 0 0-11.484-7.314H405.287a19.017 19.017 0 0 0-11.483 7.314l-33.06 77.97zM987.431 192v42.642A20.626 20.626 0 0 1 965.854 256h-64.878v631.954c0 36.937-10.532 68.755-31.744 95.744-21.211 26.844-46.592 40.302-76.288 40.302H231.061c-29.696 0-55.15-13.02-76.288-38.985-21.212-26.039-31.744-57.49-31.744-94.354V256H58.15a20.626 20.626 0 0 1-21.577-21.358V192a20.626 20.626 0 0 1 21.577-21.358h208.677L314.15 59.32c6.73-16.457 18.871-30.428 36.425-41.984C368.131 5.778 385.977 0 403.971 0h216.064c17.993 0 35.84 5.778 53.394 17.335 17.554 11.556 29.696 25.6 36.425 41.984l47.323 111.323h208.677A20.626 20.626 0 0 1 987.431 192z"}));var ko="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PHBhdGggZD0iTTM4Mi4zMiA0MDUuMzU4djM4NGEyMC42MjYgMjAuNjI2IDAgMCAxLTIxLjU3NyAyMS4yODRoLTQzLjNhMjAuNjI2IDIwLjYyNiAwIDAgMS0yMS41NzgtMjEuMzU3di0zODRBMjAuNjI2IDIwLjYyNiAwIDAgMSAzMTcuNDQzIDM4NGg0My4xNTRhMjAuNjI2IDIwLjYyNiAwIDAgMSAyMS41NzcgMjEuMzU4aC4wNzN6bTE3Mi45MSAwdjM4NGEyMC42MjYgMjAuNjI2IDAgMCAxLTIxLjY1IDIxLjI4NGgtNDMuMTU1YTIwLjYyNiAyMC42MjYgMCAwIDEtMjEuNTc3LTIxLjM1N3YtMzg0QTIwLjYyNiAyMC42MjYgMCAwIDEgNDkwLjQyNSAzODRoNDMuMTU1YTIwLjYyNiAyMC42MjYgMCAwIDEgMjEuNTc3IDIxLjM1OHptMTcyLjkxIDB2Mzg0YTIwLjYyNiAyMC42MjYgMCAwIDEtMjEuNjUgMjEuMjg0aC00My4xNTVhMjAuNjI2IDIwLjYyNiAwIDAgMS0yMS41NzctMjEuMzU3bC0uMDczLTM4NEEyMC42MjYgMjAuNjI2IDAgMCAxIDY2My4yNjIgMzg0aDQzLjIyN2EyMC42MjYgMjAuNjI2IDAgMCAxIDIxLjU3OCAyMS4zNTh6bTg2LjM4MSA0ODIuNjdWMjU2SDIwOS40ODR2NjMxLjk1NGE3NC44MjUgNzQuODI1IDAgMCAwIDE0LjQ4MiA0NS4wNTZjMy4zNjUgMy44MDQgNS43NzggNS42MzIgNy4wOTUgNS42MzJoNTYxLjg4M2MxLjMxNyAwIDMuNjU3LTEuODI4IDcuMDk1LTUuNjMyYTc0LjgyNSA3NC44MjUgMCAwIDAgMTQuNTU2LTQ0Ljk4M3pNMzYwLjc0MyAxNzAuNjQxaDMwMi41MTlsLTMyLjQwMi03Ny45N2ExOS4wMTcgMTkuMDE3IDAgMCAwLTExLjQ4NC03LjMxNEg0MDUuMjg3YTE5LjAxNyAxOS4wMTcgMCAwIDAtMTEuNDgzIDcuMzE0bC0zMy4wNiA3Ny45N3pNOTg3LjQzMSAxOTJ2NDIuNjQyQTIwLjYyNiAyMC42MjYgMCAwIDEgOTY1Ljg1NCAyNTZoLTY0Ljg3OHY2MzEuOTU0YzAgMzYuOTM3LTEwLjUzMiA2OC43NTUtMzEuNzQ0IDk1Ljc0NC0yMS4yMTEgMjYuODQ0LTQ2LjU5MiA0MC4zMDItNzYuMjg4IDQwLjMwMkgyMzEuMDYxYy0yOS42OTYgMC01NS4xNS0xMy4wMi03Ni4yODgtMzguOTg1LTIxLjIxMi0yNi4wMzktMzEuNzQ0LTU3LjQ5LTMxLjc0NC05NC4zNTRWMjU2SDU4LjE1YTIwLjYyNiAyMC42MjYgMCAwIDEtMjEuNTc3LTIxLjM1OFYxOTJhMjAuNjI2IDIwLjYyNiAwIDAgMSAyMS41NzctMjEuMzU4aDIwOC42NzdMMzE0LjE1IDU5LjMyYzYuNzMtMTYuNDU3IDE4Ljg3MS0zMC40MjggMzYuNDI1LTQxLjk4NEMzNjguMTMxIDUuNzc4IDM4NS45NzcgMCA0MDMuOTcxIDBoMjE2LjA2NGMxNy45OTMgMCAzNS44NCA1Ljc3OCA1My4zOTQgMTcuMzM1IDE3LjU1NCAxMS41NTYgMjkuNjk2IDI1LjYgMzYuNDI1IDQxLjk4NGw0Ny4zMjMgMTExLjMyM2gyMDguNjc3QTIwLjYyNiAyMC42MjYgMCAwIDEgOTg3LjQzMSAxOTJ6Ii8+PC9zdmc+",Cu=function(e){return _jsxs("div",{className:"tooltip",children:[e.children,_jsx("span",{className:"tooltiptext",children:e.title})]})};function Oo(){return navigator.languages!=null?navigator.languages[0]:navigator.language}function Po(l){var e=l.type,n=l.timestamp,a=l.timestampFormat,r=l.buttons,i=l.left,o=l.author,d=l.hasError,c=l.text,y=l.likeHandler,S=l.dislikeHandler,M=l.deleteHandler,N=Oo();if(e==="text"||e==="indicator"||e==="markdown"){var h;n&&(a==="calendar"?h=Ca()(n).locale(N).calendar():a==="fromNow"?h=Ca()(n).locale(N).fromNow():h=Ca()(n).locale(N).format(a));var w=r?r.map(function(u,f){if(u.type==="URL")return(0,t.jsx)("a",{href:u.payload,rel:"noreferrer",target:"_blank",className:"react-chat-message-button",children:u.title},f)}):[],p=l.rehypePlugins||[];return(0,t.jsxs)("div",{className:"react-chat-messageBox ".concat(i?"react-chat-messageBoxLeft":"react-chat-messageBoxRight"),children:[(0,t.jsx)("img",{alt:"avater img",src:o.avatarUrl?o.avatarUrl:vo,className:"react-chat-avatar ".concat(i?"react-chat-avatarLeft":"react-chat-avatarRight")}),(0,t.jsxs)("div",{className:"react-chat-message ".concat(i?"react-chat-messageLeft":"react-chat-messageRight"),children:[(0,t.jsx)("div",{className:"react-chat-additional",children:o.username}),(0,t.jsxs)("div",{className:"react-chat-bubble ".concat(i?"react-chat-leftBubble":"react-chat-rightBubble"," ").concat(d?"react-chat-bubbleWithError":""),children:[e==="indicator"&&(0,t.jsxs)("div",{className:"react-chat-typing-indicator",children:[(0,t.jsx)("span",{}),(0,t.jsx)("span",{}),(0,t.jsx)("span",{})]}),e==="text"&&c,e==="markdown"&&c&&(0,t.jsx)(pn.D,{className:"message-markdown-viewer",rehypePlugins:p,remarkPlugins:[Xa.Z],children:c}),w.length>0&&(0,t.jsx)("div",{className:i?"react-chat-message-buttonGroupLeft":"react-chat-message-buttonGroupRight",children:w}),d&&(0,t.jsx)("img",{src:mo,className:"".concat(i?"react-chat-errorLeft":"react-chat-errorRight"," react-chat-error")})]}),(0,t.jsxs)("div",{className:"react-chat-additional",children:[h!==null&&h,(0,t.jsxs)("span",{className:"react-chat-message-like",children:[(0,t.jsx)("img",{src:Lo,className:"chatbox-icon",onClick:function(f){y&&y(l)}}),(0,t.jsx)("img",{src:No,className:"chatbox-icon",onClick:function(f){S&&S(l)}}),(0,t.jsx)("img",{src:ko,className:"chatbox-icon",onClick:function(f){M&&M(l)}})]})]})]})]})}else if(e==="notification")return(0,t.jsx)("div",{className:"text-center text-secondary react-chat-notification",children:c})}var fr=Po,Ia=function(l){eo()(n,l);var e=no()(n);function n(a){var r;return Vt()(this,n),r=e.call(this,a),r.scrollToBottom=r.scrollToBottom.bind(qa()(r)),r.handleOnSendMessage=r.handleOnSendMessage.bind(qa()(r)),r}return Wt()(n,[{key:"scrollToBottom",value:function(){this.messagesList&&(this.messagesList.scrollTop=this.messagesList.scrollHeight-this.messagesList.clientHeight)}},{key:"componentDidMount",value:function(){this.scrollToBottom()}},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"handleOnSendMessage",value:function(r){this.props.onSendMessage(r)}},{key:"render",value:function(){var r=this,i=this.props,o=i.messages,d=i.userId,c=i.timestampFormat,y=i.height,S=i.width,M=i.disableInput,N=i.disabledInputPlaceholder,h=i.placeholder,w=i.style,p=i.showTypingIndicator,u=i.activeAuthor,f=i.onSendKey,b=i.title,L=i.dislikeHandler,D=i.likeHandler,k=i.deleteHandler,U=o.map(function(F,T){return(0,t.jsx)(fr,m()({dislikeHandler:L,likeHandler:D,deleteHandler:k,left:F.author&&F.author.id!==d,timestampFormat:c},F),T)});return(0,t.jsx)("div",{style:w,className:"react-chat-container",children:(0,t.jsx)("div",{className:"react-chat-row",children:(0,t.jsxs)("div",{className:"react-chat-viewerBox",style:{height:y,width:S},children:[(0,t.jsxs)("div",{className:"react-chat-header",children:[(0,t.jsx)("div",{className:"react-chat-headerTitle",children:b||"ChatBot"}),(0,t.jsx)(q.ZP,{danger:!0,shape:"round",onClick:function(){r.props.clearHistory&&r.props.clearHistory()},children:"Clear"})]}),(0,t.jsx)("div",{className:"react-chat-messagesList",ref:function(T){return r.messagesList=T},children:(0,t.jsxs)("div",{className:"react-chat-messagesListContent",children:[U&&U.length>0?U:"No messages yet, please start a conversation.",p&&u!==null&&(0,t.jsx)(fr,{type:"indicator",author:u,text:"",left:!0})]})}),(0,t.jsx)(rr,{onSendMessage:this.handleOnSendMessage,disabled:M,placeholder:h,disabledInputPlaceholder:N,onSendKey:f})]})})})}}]),n}(s.Component);Ia.propTypes={messages:Te().array,userId:Te().oneOfType([Te().string,Te().number]).isRequired,onSendMessage:Te().func.isRequired,timestampFormat:Te().oneOf(ro),width:Te().string,height:Te().string,disableInput:Te().bool,disabledInputPlaceholder:Te().string,placeholder:Te().string,style:Te().object,showTypingIndicator:Te().bool,activeAuthor:Te().object,onSendKey:Te().oneOf(er)},Ia.defaultProps={messages:[],timestampFormat:"calendar",disableInput:!1,disabledInputPlaceholder:"",placeholder:"",showTypingIndicator:!1,activeAuthor:null};var zo=Ia,Zo=Object.defineProperty,gr=Object.getOwnPropertySymbols,Ro=Object.prototype.hasOwnProperty,_o=Object.prototype.propertyIsEnumerable,yr=(l,e,n)=>e in l?Zo(l,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[e]=n,Go=(l,e)=>{for(var n in e||(e={}))Ro.call(e,n)&&yr(l,n,e[n]);if(gr)for(var n of gr(e))_o.call(e,n)&&yr(l,n,e[n]);return l};const Iu=l=>React.createElement("svg",Go({xmlns:"http://www.w3.org/2000/svg",width:45,height:45,viewBox:"0 0 576 512"},l),React.createElement("path",{d:"M532 386.2c27.5-27.1 44-61.1 44-98.2 0-80-76.5-146.1-176.2-157.9C368.3 72.5 294.3 32 208 32 93.1 32 0 103.6 0 192c0 37 16.5 71 44 98.2-15.3 30.7-37.3 54.5-37.7 54.9-6.3 6.7-8.1 16.5-4.4 25 3.6 8.5 12 14 21.2 14 53.5 0 96.7-20.2 125.2-38.8 9.2 2.1 18.7 3.7 28.4 4.9C208.1 407.6 281.8 448 368 448c20.8 0 40.8-2.4 59.8-6.8C456.3 459.7 499.4 480 553 480c9.2 0 17.5-5.5 21.2-14 3.6-8.5 1.9-18.3-4.4-25-.4-.3-22.5-24.1-37.8-54.8zm-392.8-92.3L122.1 305c-14.1 9.1-28.5 16.3-43.1 21.4 2.7-4.7 5.4-9.7 8-14.8l15.5-31.1L77.7 256C64.2 242.6 48 220.7 48 192c0-60.7 73.3-112 160-112s160 51.3 160 112-73.3 112-160 112c-16.5 0-33-1.9-49-5.6l-19.8-4.5zM498.3 352l-24.7 24.4 15.5 31.1c2.6 5.1 5.3 10.1 8 14.8-14.6-5.1-29-12.3-43.1-21.4l-17.1-11.1-19.9 4.6c-16 3.7-32.5 5.6-49 5.6-54 0-102.2-20.1-131.3-49.7C338 339.5 416 272.9 416 192c0-3.4-.4-6.7-.7-10C479.7 196.5 528 238.8 528 288c0 28.7-16.2 50.6-29.7 64z"}));var Fo="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NSIgaGVpZ2h0PSI0NSIgdmlld0JveD0iMCAwIDU3NiA1MTIiPjxwYXRoIGQ9Ik01MzIgMzg2LjJjMjcuNS0yNy4xIDQ0LTYxLjEgNDQtOTguMiAwLTgwLTc2LjUtMTQ2LjEtMTc2LjItMTU3LjlDMzY4LjMgNzIuNSAyOTQuMyAzMiAyMDggMzIgOTMuMSAzMiAwIDEwMy42IDAgMTkyYzAgMzcgMTYuNSA3MSA0NCA5OC4yLTE1LjMgMzAuNy0zNy4zIDU0LjUtMzcuNyA1NC45LTYuMyA2LjctOC4xIDE2LjUtNC40IDI1IDMuNiA4LjUgMTIgMTQgMjEuMiAxNCA1My41IDAgOTYuNy0yMC4yIDEyNS4yLTM4LjggOS4yIDIuMSAxOC43IDMuNyAyOC40IDQuOUMyMDguMSA0MDcuNiAyODEuOCA0NDggMzY4IDQ0OGMyMC44IDAgNDAuOC0yLjQgNTkuOC02LjhDNDU2LjMgNDU5LjcgNDk5LjQgNDgwIDU1MyA0ODBjOS4yIDAgMTcuNS01LjUgMjEuMi0xNCAzLjYtOC41IDEuOS0xOC4zLTQuNC0yNS0uNC0uMy0yMi41LTI0LjEtMzcuOC01NC44em0tMzkyLjgtOTIuM0wxMjIuMSAzMDVjLTE0LjEgOS4xLTI4LjUgMTYuMy00My4xIDIxLjQgMi43LTQuNyA1LjQtOS43IDgtMTQuOGwxNS41LTMxLjFMNzcuNyAyNTZDNjQuMiAyNDIuNiA0OCAyMjAuNyA0OCAxOTJjMC02MC43IDczLjMtMTEyIDE2MC0xMTJzMTYwIDUxLjMgMTYwIDExMi03My4zIDExMi0xNjAgMTEyYy0xNi41IDAtMzMtMS45LTQ5LTUuNmwtMTkuOC00LjV6TTQ5OC4zIDM1MmwtMjQuNyAyNC40IDE1LjUgMzEuMWMyLjYgNS4xIDUuMyAxMC4xIDggMTQuOC0xNC42LTUuMS0yOS0xMi4zLTQzLjEtMjEuNGwtMTcuMS0xMS4xLTE5LjkgNC42Yy0xNiAzLjctMzIuNSA1LjYtNDkgNS42LTU0IDAtMTAyLjItMjAuMS0xMzEuMy00OS43QzMzOCAzMzkuNSA0MTYgMjcyLjkgNDE2IDE5MmMwLTMuNC0uNC02LjctLjctMTBDNDc5LjcgMTk2LjUgNTI4IDIzOC44IDUyOCAyODhjMCAyOC43LTE2LjIgNTAuNi0yOS43IDY0eiIvPjwvc3ZnPg==",Uo=Object.defineProperty,pr=Object.getOwnPropertySymbols,Yo=Object.prototype.hasOwnProperty,Bo=Object.prototype.propertyIsEnumerable,mr=(l,e,n)=>e in l?Uo(l,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[e]=n,Qo=(l,e)=>{for(var n in e||(e={}))Yo.call(e,n)&&mr(l,n,e[n]);if(pr)for(var n of pr(e))Bo.call(e,n)&&mr(l,n,e[n]);return l};const bu=l=>React.createElement("svg",Qo({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"},l),React.createElement("path",{d:"M4.686 427.314 104 328l-32.922-31.029C55.958 281.851 66.666 256 88.048 256h112C213.303 256 224 266.745 224 280v112c0 21.382-25.803 32.09-40.922 16.971L152 376l-99.314 99.314c-6.248 6.248-16.379 6.248-22.627 0L4.686 449.941c-6.248-6.248-6.248-16.379 0-22.627zM443.314 84.686 344 184l32.922 31.029c15.12 15.12 4.412 40.971-16.97 40.971h-112C234.697 256 224 245.255 224 232V120c0-21.382 25.803-32.09 40.922-16.971L296 136l99.314-99.314c6.248-6.248 16.379-6.248 22.627 0l25.373 25.373c6.248 6.248 6.248 16.379 0 22.627z"}));var Vo="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NDggNTEyIj48cGF0aCBkPSJNNC42ODYgNDI3LjMxNCAxMDQgMzI4bC0zMi45MjItMzEuMDI5QzU1Ljk1OCAyODEuODUxIDY2LjY2NiAyNTYgODguMDQ4IDI1NmgxMTJDMjEzLjMwMyAyNTYgMjI0IDI2Ni43NDUgMjI0IDI4MHYxMTJjMCAyMS4zODItMjUuODAzIDMyLjA5LTQwLjkyMiAxNi45NzFMMTUyIDM3NmwtOTkuMzE0IDk5LjMxNGMtNi4yNDggNi4yNDgtMTYuMzc5IDYuMjQ4LTIyLjYyNyAwTDQuNjg2IDQ0OS45NDFjLTYuMjQ4LTYuMjQ4LTYuMjQ4LTE2LjM3OSAwLTIyLjYyN3pNNDQzLjMxNCA4NC42ODYgMzQ0IDE4NGwzMi45MjIgMzEuMDI5YzE1LjEyIDE1LjEyIDQuNDEyIDQwLjk3MS0xNi45NyA0MC45NzFoLTExMkMyMzQuNjk3IDI1NiAyMjQgMjQ1LjI1NSAyMjQgMjMyVjEyMGMwLTIxLjM4MiAyNS44MDMtMzIuMDkgNDAuOTIyLTE2Ljk3MUwyOTYgMTM2bDk5LjMxNC05OS4zMTRjNi4yNDgtNi4yNDggMTYuMzc5LTYuMjQ4IDIyLjYyNyAwbDI1LjM3MyAyNS4zNzNjNi4yNDggNi4yNDggNi4yNDggMTYuMzc5IDAgMjIuNjI3eiIvPjwvc3ZnPg==";function Wo(l){var e=l.icon,n=l.chatbox,a=l.showChatbox,r=l.clickIcon,i=l.showIcon,o=l.iconStyle,d=l.children;return(0,t.jsx)("div",{className:"react-chat-frame",children:(0,t.jsxs)("div",{className:"react-chat-frame-wrapper",children:[a&&n!==void 0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"react-chat-close-icon",onClick:r,children:(0,t.jsx)(Vo,{})}),n]}),!a&&(0,t.jsx)("div",{className:"react-chat-frame-custom",children:d}),i&&(0,t.jsx)("div",{className:"react-chat-frame-icon-container",onClick:r,style:o,children:e!==void 0?e:(0,t.jsx)(Fo,{className:"react-chat-frame-icon"})})]})})}Wo.propTypes={icon:Te().element,chatbox:Te().element.isRequired,showChatbox:Te().bool,clickIcon:Te().func,showIcon:Te().bool,children:Te().element,iconStyle:Te().object};var wu=null,Ho=Object.defineProperty,vr=Object.getOwnPropertySymbols,Ko=Object.prototype.hasOwnProperty,Jo=Object.prototype.propertyIsEnumerable,Sr=(l,e,n)=>e in l?Ho(l,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[e]=n,$o=(l,e)=>{for(var n in e||(e={}))Ko.call(e,n)&&Sr(l,n,e[n]);if(vr)for(var n of vr(e))Jo.call(e,n)&&Sr(l,n,e[n]);return l};const Lu=l=>React.createElement("svg",$o({className:"ai_svg__icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:200,height:200},l),React.createElement("path",{d:"M98 512a414 414 0 1 0 828 0 414 414 0 1 0-828 0Z",fill:"#F0C48A"}),React.createElement("path",{d:"M36.2 357.4v309.2L218 916.8l294 95.4 294-95.4 181.8-250.2V357.4L806 107.2 512 11.8l-294 95.4z",fill:"#7BABF1"}),React.createElement("path",{d:"M90.6 375v274l161 221.6L512 955.2l260.4-84.6 161-221.6V375l-161-221.6L512 68.8l-260.4 84.6z",fill:"#A4CFF2"}),React.createElement("path",{d:"M627.6 156.4H396.4L209.6 292.2 138.2 512l71.4 219.8 186.8 135.8h231.2l186.8-135.8L885.8 512l-71.4-219.8z",fill:"#D3E6F8"}),React.createElement("path",{d:"M512 284.2 278.2 454l89.2 275h289.2l89.2-275z",fill:"#E8677D"}),React.createElement("path",{d:"M512 361 351.2 477.8l61.4 189h198.8l61.4-189z",fill:"#FD919E"}),React.createElement("path",{d:"M512 1024c-1.2 0-2.4-.2-3.6-.6l-294-95.6c-2.4-.8-4.4-2.2-5.8-4.2L26.8 673.4c-1.4-2-2.2-4.4-2.2-6.8V357.4c0-2.4.8-4.8 2.2-6.8l181.8-250.2c1.4-2 3.6-3.4 5.8-4.2L508.4.6c2.4-.8 4.8-.8 7.2 0l294 95.6c2.4.8 4.4 2.2 5.8 4.2l181.8 250.2c1.4 2 2.2 4.4 2.2 6.8v309.2c0 2.4-.8 4.8-2.2 6.8L815.4 923.6c-1.4 2-3.6 3.4-5.8 4.2l-294 95.6c-1.2.4-2.4.6-3.6.6zM225.2 906.8 512 1000l286.8-93.2 177.2-244V361.2l-177.2-244L512 24l-286.8 93.2L48 361.2v301.6l177.2 244z",fill:"#4C4372"}),React.createElement("path",{d:"M627.6 879.2H396.4c-2.4 0-4.8-.8-6.8-2.2l-187-135.8c-2-1.4-3.4-3.6-4.2-5.8L127 515.6c-.8-2.4-.8-4.8 0-7.2l71.4-219.8c.8-2.4 2.2-4.4 4.2-5.8l187-135.8c2-1.4 4.4-2.2 6.8-2.2h231c2.4 0 4.8.8 6.8 2.2l187 135.8c2 1.4 3.4 3.6 4.2 5.8l71.4 219.8c.8 2.4.8 4.8 0 7.2l-71.4 219.8c-.8 2.4-2.2 4.4-4.2 5.8L634.2 877c-1.8 1.6-4.2 2.2-6.6 2.2zm-227.4-23.4h223.4l180.8-131.4L873.6 512l-69-212.6L623.8 168H400.2L219.4 299.4l-69 212.6 69 212.6 180.8 131.2z",fill:"#4C4372"}),React.createElement("path",{d:"M656.6 740.6H367.4c-5 0-9.6-3.2-11.2-8.2l-89.4-274.8c-1.6-4.8.2-10.2 4.2-13.2l233.8-169.8c4.2-3 9.6-3 13.8 0l233.8 169.8c4.2 3 5.8 8.2 4.2 13.2l-89.4 274.8c-1 5-5.6 8.2-10.6 8.2zM376 717.2h272l84-258.6-220-159.8-220 159.8 84 258.6z",fill:"#4C4372"}),React.createElement("path",{d:"M512 1024c-3.6 0-7-1.6-9.2-4.4L392 881l-171 47c-3.4 1-7.2.2-10-1.8s-4.6-5.4-4.8-9l-8-177.2-166-62.4c-3.4-1.2-6-4-7-7.4-1.2-3.4-.6-7.2 1.4-10L124 512 26.4 363.8c-2-3-2.4-6.6-1.4-10 1.2-3.4 3.6-6 7-7.4L198 284l8-177.2c.2-3.6 2-6.8 4.8-9 2.8-2 6.6-2.8 10-1.8l171 47.2L502.6 4.6c2.2-2.8 5.6-4.4 9.2-4.4s7 1.6 9.2 4.4l110.8 138.6L803 96c3.4-1 7.2-.2 10 1.8s4.6 5.4 4.8 9l8 177.2 166 62.4c3.4 1.2 6 4 7 7.4 1.2 3.4.6 7-1.4 10L900 512l97.6 148.2c2 3 2.4 6.6 1.4 10-1.2 3.4-3.6 6-7 7.4L826 740l-8 177.2c-.2 3.6-2 6.8-4.8 9-2.8 2-6.6 2.8-10 1.8l-171-47.2-110.8 138.6c-2.4 3-5.8 4.6-9.4 4.6zM396.4 855.8c3.6 0 7 1.6 9.2 4.4L512 993.4l106.4-133.2c3-3.6 7.8-5.2 12.2-4L795 901.4l7.8-170.4c.2-4.6 3.2-8.8 7.6-10.4l159.6-60-94-142.2c-2.6-4-2.6-9 0-13L969.8 363l-159.6-60c-4.4-1.6-7.4-5.8-7.6-10.4l-7.8-170.4-164.4 45.2c-4.6 1.2-9.4-.4-12.2-4L512 30.6 405.6 163.8c-3 3.6-7.8 5.2-12.2 4L229 122.6 221.2 293c-.2 4.6-3.2 8.8-7.6 10.4L54 363.4l94 142.2c2.6 4 2.6 9 0 13L54 660.8l159.6 60c4.4 1.6 7.4 5.8 7.6 10.4l7.8 170.4 164.4-45.2c1-.4 2-.6 3-.6z",fill:"#4C4372"}),React.createElement("path",{d:"M512 295.8c-3.4 0-6.4-1.4-8.6-3.8L387.8 164.2c-4.4-4.8-4-12.2.8-16.6 4.8-4.4 12.2-4 16.6.8l106.8 118 106.8-118c4.4-4.8 11.8-5.2 16.6-.8 4.8 4.4 5.2 11.8.8 16.6L520.6 292c-2.2 2.4-5.2 3.8-8.6 3.8zm373.8 228c-1.4 0-3-.2-4.4-.8l-140-58c-2.8-1.2-5.2-3.4-6.4-6.4-1.2-2.8-1.2-6.2 0-9l68.6-161.8c2.6-6 9.4-8.8 15.4-6.2 6 2.6 8.8 9.4 6.2 15.4l-64 150.8 129 53.4c6 2.4 8.8 9.4 6.4 15.4-1.8 4.4-6.2 7.2-10.8 7.2zM627.6 879.2c-.8 0-1.6 0-2.4-.2-6.4-1.4-10.4-7.6-9-13.8l29-138.6c1.2-5.6 6-9.4 11.6-9.4l158 2.8c6.4.2 11.6 5.4 11.6 12-.2 6.4-5.4 11.6-12 11.6L666.2 741 639 870c-1.2 5.4-6 9.2-11.4 9.2zm-231.2 0c-5.4 0-10.4-3.8-11.4-9.4l-27-129-148.2 2.6c-6.6 0-11.8-5-12-11.6-.2-6.4 5-11.8 11.6-12l158-2.8c5.6 0 10.6 3.8 11.6 9.4L408 865c1.4 6.4-2.8 12.6-9 13.8-1 .4-1.8.4-2.6.4zM138.2 523.8c-4.6 0-9-2.8-10.8-7.2-2.4-6 .4-12.8 6.4-15.4l129-53.4-64-150.8c-2.6-6 .2-12.8 6.2-15.4 6-2.6 12.8.2 15.4 6.2L289 449.6c1.2 2.8 1.2 6.2 0 9s-3.4 5.2-6.4 6.4l-140 58c-1.4.4-3 .8-4.4.8z",fill:"#4C4372"}),React.createElement("path",{d:"M512 879.2c-3 0-5.8-1-8.2-3.2L360.4 738.4 167 628.8c-2.8-1.6-4.8-4.2-5.6-7.4-.8-3.2-.2-6.4 1.6-9.2L266.8 450l23.6-226.2c.4-3.4 2.2-6.6 5-8.4 2.8-2 6.4-2.6 9.8-1.6l207 58.2L730 221.4c3.4-.8 7 0 9.6 2 2.8 2 4.4 5.2 4.6 8.8L757 450.6l99.2 177.2c1.6 2.8 2 6.2 1 9.2-1 3-3 5.6-6 7L663 738.6 520.2 876c-2.4 2.2-5.2 3.2-8.2 3.2zM189.4 614.6l184 104.2c.8.4 1.6 1 2.4 1.8l136.4 130.8 136.4-130.8c.8-.8 1.8-1.4 2.8-2l178.8-89.8L735.6 460c-.8-1.6-1.4-3.2-1.4-5L722 247.4l-207.2 48c-2 .4-4 .4-5.8-.2L312.2 240l-22.4 215.2c-.2 1.8-.8 3.6-1.8 5.2l-98.6 154.2zM278.2 454z",fill:"#4C4372"}),React.createElement("path",{d:"M512 536.8c-1.2 0-2.2-.2-3.4-.6l-233.8-71c-6.2-1.8-9.6-8.4-7.8-14.6 1.8-6.2 8.4-9.6 14.6-7.8l218.8 66.4v-225c0-6.4 5.2-11.8 11.8-11.8 6.4 0 11.8 5.2 11.8 11.8V525c0 3.8-1.8 7.2-4.8 9.4-2.2 1.6-4.8 2.4-7.2 2.4z",fill:"#4C4372"}),React.createElement("path",{d:"M656.6 740.6c-3.6 0-7.2-1.8-9.6-5L512 545.4 377 735.8c-3.8 5.2-11 6.6-16.4 2.8-5.2-3.8-6.6-11-2.8-16.4l144.6-203.8c2.2-3.2 5.8-5 9.6-5s7.4 1.8 9.6 5L666 722.2c3.8 5.2 2.4 12.6-2.8 16.4-2 1.4-4.4 2-6.6 2z",fill:"#4C4372"}),React.createElement("path",{d:"M512 536.8c-5 0-9.6-3.2-11.2-8.4-1.8-6.2 1.6-12.8 7.8-14.6l233.8-71c6.2-1.8 12.8 1.6 14.6 7.8 1.8 6.2-1.6 12.8-7.8 14.6l-233.8 71c-1.2.4-2.2.6-3.4.6z",fill:"#4C4372"}));var Xo="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PHBhdGggZD0iTTk4IDUxMmE0MTQgNDE0IDAgMSAwIDgyOCAwIDQxNCA0MTQgMCAxIDAtODI4IDBaIiBmaWxsPSIjRjBDNDhBIi8+PHBhdGggZD0iTTM2LjIgMzU3LjR2MzA5LjJMMjE4IDkxNi44bDI5NCA5NS40IDI5NC05NS40IDE4MS44LTI1MC4yVjM1Ny40TDgwNiAxMDcuMiA1MTIgMTEuOGwtMjk0IDk1LjR6IiBmaWxsPSIjN0JBQkYxIi8+PHBhdGggZD0iTTkwLjYgMzc1djI3NGwxNjEgMjIxLjZMNTEyIDk1NS4ybDI2MC40LTg0LjYgMTYxLTIyMS42VjM3NWwtMTYxLTIyMS42TDUxMiA2OC44bC0yNjAuNCA4NC42eiIgZmlsbD0iI0E0Q0ZGMiIvPjxwYXRoIGQ9Ik02MjcuNiAxNTYuNEgzOTYuNEwyMDkuNiAyOTIuMiAxMzguMiA1MTJsNzEuNCAyMTkuOCAxODYuOCAxMzUuOGgyMzEuMmwxODYuOC0xMzUuOEw4ODUuOCA1MTJsLTcxLjQtMjE5Ljh6IiBmaWxsPSIjRDNFNkY4Ii8+PHBhdGggZD0iTTUxMiAyODQuMiAyNzguMiA0NTRsODkuMiAyNzVoMjg5LjJsODkuMi0yNzV6IiBmaWxsPSIjRTg2NzdEIi8+PHBhdGggZD0iTTUxMiAzNjEgMzUxLjIgNDc3LjhsNjEuNCAxODloMTk4LjhsNjEuNC0xODl6IiBmaWxsPSIjRkQ5MTlFIi8+PHBhdGggZD0iTTUxMiAxMDI0Yy0xLjIgMC0yLjQtLjItMy42LS42bC0yOTQtOTUuNmMtMi40LS44LTQuNC0yLjItNS44LTQuMkwyNi44IDY3My40Yy0xLjQtMi0yLjItNC40LTIuMi02LjhWMzU3LjRjMC0yLjQuOC00LjggMi4yLTYuOGwxODEuOC0yNTAuMmMxLjQtMiAzLjYtMy40IDUuOC00LjJMNTA4LjQuNmMyLjQtLjggNC44LS44IDcuMiAwbDI5NCA5NS42YzIuNC44IDQuNCAyLjIgNS44IDQuMmwxODEuOCAyNTAuMmMxLjQgMiAyLjIgNC40IDIuMiA2Ljh2MzA5LjJjMCAyLjQtLjggNC44LTIuMiA2LjhMODE1LjQgOTIzLjZjLTEuNCAyLTMuNiAzLjQtNS44IDQuMmwtMjk0IDk1LjZjLTEuMi40LTIuNC42LTMuNi42ek0yMjUuMiA5MDYuOCA1MTIgMTAwMGwyODYuOC05My4yIDE3Ny4yLTI0NFYzNjEuMmwtMTc3LjItMjQ0TDUxMiAyNGwtMjg2LjggOTMuMkw0OCAzNjEuMnYzMDEuNmwxNzcuMiAyNDR6IiBmaWxsPSIjNEM0MzcyIi8+PHBhdGggZD0iTTYyNy42IDg3OS4ySDM5Ni40Yy0yLjQgMC00LjgtLjgtNi44LTIuMmwtMTg3LTEzNS44Yy0yLTEuNC0zLjQtMy42LTQuMi01LjhMMTI3IDUxNS42Yy0uOC0yLjQtLjgtNC44IDAtNy4ybDcxLjQtMjE5LjhjLjgtMi40IDIuMi00LjQgNC4yLTUuOGwxODctMTM1LjhjMi0xLjQgNC40LTIuMiA2LjgtMi4yaDIzMWMyLjQgMCA0LjguOCA2LjggMi4ybDE4NyAxMzUuOGMyIDEuNCAzLjQgMy42IDQuMiA1LjhsNzEuNCAyMTkuOGMuOCAyLjQuOCA0LjggMCA3LjJsLTcxLjQgMjE5LjhjLS44IDIuNC0yLjIgNC40LTQuMiA1LjhMNjM0LjIgODc3Yy0xLjggMS42LTQuMiAyLjItNi42IDIuMnptLTIyNy40LTIzLjRoMjIzLjRsMTgwLjgtMTMxLjRMODczLjYgNTEybC02OS0yMTIuNkw2MjMuOCAxNjhINDAwLjJMMjE5LjQgMjk5LjRsLTY5IDIxMi42IDY5IDIxMi42IDE4MC44IDEzMS4yeiIgZmlsbD0iIzRDNDM3MiIvPjxwYXRoIGQ9Ik02NTYuNiA3NDAuNkgzNjcuNGMtNSAwLTkuNi0zLjItMTEuMi04LjJsLTg5LjQtMjc0LjhjLTEuNi00LjguMi0xMC4yIDQuMi0xMy4ybDIzMy44LTE2OS44YzQuMi0zIDkuNi0zIDEzLjggMGwyMzMuOCAxNjkuOGM0LjIgMyA1LjggOC4yIDQuMiAxMy4ybC04OS40IDI3NC44Yy0xIDUtNS42IDguMi0xMC42IDguMnpNMzc2IDcxNy4yaDI3Mmw4NC0yNTguNi0yMjAtMTU5LjgtMjIwIDE1OS44IDg0IDI1OC42eiIgZmlsbD0iIzRDNDM3MiIvPjxwYXRoIGQ9Ik01MTIgMTAyNGMtMy42IDAtNy0xLjYtOS4yLTQuNEwzOTIgODgxbC0xNzEgNDdjLTMuNCAxLTcuMi4yLTEwLTEuOHMtNC42LTUuNC00LjgtOWwtOC0xNzcuMi0xNjYtNjIuNGMtMy40LTEuMi02LTQtNy03LjQtMS4yLTMuNC0uNi03LjIgMS40LTEwTDEyNCA1MTIgMjYuNCAzNjMuOGMtMi0zLTIuNC02LjYtMS40LTEwIDEuMi0zLjQgMy42LTYgNy03LjRMMTk4IDI4NGw4LTE3Ny4yYy4yLTMuNiAyLTYuOCA0LjgtOSAyLjgtMiA2LjYtMi44IDEwLTEuOGwxNzEgNDcuMkw1MDIuNiA0LjZjMi4yLTIuOCA1LjYtNC40IDkuMi00LjRzNyAxLjYgOS4yIDQuNGwxMTAuOCAxMzguNkw4MDMgOTZjMy40LTEgNy4yLS4yIDEwIDEuOHM0LjYgNS40IDQuOCA5bDggMTc3LjIgMTY2IDYyLjRjMy40IDEuMiA2IDQgNyA3LjQgMS4yIDMuNC42IDctMS40IDEwTDkwMCA1MTJsOTcuNiAxNDguMmMyIDMgMi40IDYuNiAxLjQgMTAtMS4yIDMuNC0zLjYgNi03IDcuNEw4MjYgNzQwbC04IDE3Ny4yYy0uMiAzLjYtMiA2LjgtNC44IDktMi44IDItNi42IDIuOC0xMCAxLjhsLTE3MS00Ny4yLTExMC44IDEzOC42Yy0yLjQgMy01LjggNC42LTkuNCA0LjZ6TTM5Ni40IDg1NS44YzMuNiAwIDcgMS42IDkuMiA0LjRMNTEyIDk5My40bDEwNi40LTEzMy4yYzMtMy42IDcuOC01LjIgMTIuMi00TDc5NSA5MDEuNGw3LjgtMTcwLjRjLjItNC42IDMuMi04LjggNy42LTEwLjRsMTU5LjYtNjAtOTQtMTQyLjJjLTIuNi00LTIuNi05IDAtMTNMOTY5LjggMzYzbC0xNTkuNi02MGMtNC40LTEuNi03LjQtNS44LTcuNi0xMC40bC03LjgtMTcwLjQtMTY0LjQgNDUuMmMtNC42IDEuMi05LjQtLjQtMTIuMi00TDUxMiAzMC42IDQwNS42IDE2My44Yy0zIDMuNi03LjggNS4yLTEyLjIgNEwyMjkgMTIyLjYgMjIxLjIgMjkzYy0uMiA0LjYtMy4yIDguOC03LjYgMTAuNEw1NCAzNjMuNGw5NCAxNDIuMmMyLjYgNCAyLjYgOSAwIDEzTDU0IDY2MC44bDE1OS42IDYwYzQuNCAxLjYgNy40IDUuOCA3LjYgMTAuNGw3LjggMTcwLjQgMTY0LjQtNDUuMmMxLS40IDItLjYgMy0uNnoiIGZpbGw9IiM0QzQzNzIiLz48cGF0aCBkPSJNNTEyIDI5NS44Yy0zLjQgMC02LjQtMS40LTguNi0zLjhMMzg3LjggMTY0LjJjLTQuNC00LjgtNC0xMi4yLjgtMTYuNiA0LjgtNC40IDEyLjItNCAxNi42LjhsMTA2LjggMTE4IDEwNi44LTExOGM0LjQtNC44IDExLjgtNS4yIDE2LjYtLjggNC44IDQuNCA1LjIgMTEuOC44IDE2LjZMNTIwLjYgMjkyYy0yLjIgMi40LTUuMiAzLjgtOC42IDMuOHptMzczLjggMjI4Yy0xLjQgMC0zLS4yLTQuNC0uOGwtMTQwLTU4Yy0yLjgtMS4yLTUuMi0zLjQtNi40LTYuNC0xLjItMi44LTEuMi02LjIgMC05bDY4LjYtMTYxLjhjMi42LTYgOS40LTguOCAxNS40LTYuMiA2IDIuNiA4LjggOS40IDYuMiAxNS40bC02NCAxNTAuOCAxMjkgNTMuNGM2IDIuNCA4LjggOS40IDYuNCAxNS40LTEuOCA0LjQtNi4yIDcuMi0xMC44IDcuMnpNNjI3LjYgODc5LjJjLS44IDAtMS42IDAtMi40LS4yLTYuNC0xLjQtMTAuNC03LjYtOS0xMy44bDI5LTEzOC42YzEuMi01LjYgNi05LjQgMTEuNi05LjRsMTU4IDIuOGM2LjQuMiAxMS42IDUuNCAxMS42IDEyLS4yIDYuNC01LjQgMTEuNi0xMiAxMS42TDY2Ni4yIDc0MSA2MzkgODcwYy0xLjIgNS40LTYgOS4yLTExLjQgOS4yem0tMjMxLjIgMGMtNS40IDAtMTAuNC0zLjgtMTEuNC05LjRsLTI3LTEyOS0xNDguMiAyLjZjLTYuNiAwLTExLjgtNS0xMi0xMS42LS4yLTYuNCA1LTExLjggMTEuNi0xMmwxNTgtMi44YzUuNiAwIDEwLjYgMy44IDExLjYgOS40TDQwOCA4NjVjMS40IDYuNC0yLjggMTIuNi05IDEzLjgtMSAuNC0xLjguNC0yLjYuNHpNMTM4LjIgNTIzLjhjLTQuNiAwLTktMi44LTEwLjgtNy4yLTIuNC02IC40LTEyLjggNi40LTE1LjRsMTI5LTUzLjQtNjQtMTUwLjhjLTIuNi02IC4yLTEyLjggNi4yLTE1LjQgNi0yLjYgMTIuOC4yIDE1LjQgNi4yTDI4OSA0NDkuNmMxLjIgMi44IDEuMiA2LjIgMCA5cy0zLjQgNS4yLTYuNCA2LjRsLTE0MCA1OGMtMS40LjQtMyAuOC00LjQuOHoiIGZpbGw9IiM0QzQzNzIiLz48cGF0aCBkPSJNNTEyIDg3OS4yYy0zIDAtNS44LTEtOC4yLTMuMkwzNjAuNCA3MzguNCAxNjcgNjI4LjhjLTIuOC0xLjYtNC44LTQuMi01LjYtNy40LS44LTMuMi0uMi02LjQgMS42LTkuMkwyNjYuOCA0NTBsMjMuNi0yMjYuMmMuNC0zLjQgMi4yLTYuNiA1LTguNCAyLjgtMiA2LjQtMi42IDkuOC0xLjZsMjA3IDU4LjJMNzMwIDIyMS40YzMuNC0uOCA3IDAgOS42IDIgMi44IDIgNC40IDUuMiA0LjYgOC44TDc1NyA0NTAuNmw5OS4yIDE3Ny4yYzEuNiAyLjggMiA2LjIgMSA5LjItMSAzLTMgNS42LTYgN0w2NjMgNzM4LjYgNTIwLjIgODc2Yy0yLjQgMi4yLTUuMiAzLjItOC4yIDMuMnpNMTg5LjQgNjE0LjZsMTg0IDEwNC4yYy44LjQgMS42IDEgMi40IDEuOGwxMzYuNCAxMzAuOCAxMzYuNC0xMzAuOGMuOC0uOCAxLjgtMS40IDIuOC0ybDE3OC44LTg5LjhMNzM1LjYgNDYwYy0uOC0xLjYtMS40LTMuMi0xLjQtNUw3MjIgMjQ3LjRsLTIwNy4yIDQ4Yy0yIC40LTQgLjQtNS44LS4yTDMxMi4yIDI0MGwtMjIuNCAyMTUuMmMtLjIgMS44LS44IDMuNi0xLjggNS4ybC05OC42IDE1NC4yek0yNzguMiA0NTR6IiBmaWxsPSIjNEM0MzcyIi8+PHBhdGggZD0iTTUxMiA1MzYuOGMtMS4yIDAtMi4yLS4yLTMuNC0uNmwtMjMzLjgtNzFjLTYuMi0xLjgtOS42LTguNC03LjgtMTQuNiAxLjgtNi4yIDguNC05LjYgMTQuNi03LjhsMjE4LjggNjYuNHYtMjI1YzAtNi40IDUuMi0xMS44IDExLjgtMTEuOCA2LjQgMCAxMS44IDUuMiAxMS44IDExLjhWNTI1YzAgMy44LTEuOCA3LjItNC44IDkuNC0yLjIgMS42LTQuOCAyLjQtNy4yIDIuNHoiIGZpbGw9IiM0QzQzNzIiLz48cGF0aCBkPSJNNjU2LjYgNzQwLjZjLTMuNiAwLTcuMi0xLjgtOS42LTVMNTEyIDU0NS40IDM3NyA3MzUuOGMtMy44IDUuMi0xMSA2LjYtMTYuNCAyLjgtNS4yLTMuOC02LjYtMTEtMi44LTE2LjRsMTQ0LjYtMjAzLjhjMi4yLTMuMiA1LjgtNSA5LjYtNXM3LjQgMS44IDkuNiA1TDY2NiA3MjIuMmMzLjggNS4yIDIuNCAxMi42LTIuOCAxNi40LTIgMS40LTQuNCAyLTYuNiAyeiIgZmlsbD0iIzRDNDM3MiIvPjxwYXRoIGQ9Ik01MTIgNTM2LjhjLTUgMC05LjYtMy4yLTExLjItOC40LTEuOC02LjIgMS42LTEyLjggNy44LTE0LjZsMjMzLjgtNzFjNi4yLTEuOCAxMi44IDEuNiAxNC42IDcuOCAxLjggNi4yLTEuNiAxMi44LTcuOCAxNC42bC0yMzMuOCA3MWMtMS4yLjQtMi4yLjYtMy40LjZ6IiBmaWxsPSIjNEM0MzcyIi8+PC9zdmc+",qo=Object.defineProperty,Mr=Object.getOwnPropertySymbols,el=Object.prototype.hasOwnProperty,tl=Object.prototype.propertyIsEnumerable,jr=(l,e,n)=>e in l?qo(l,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[e]=n,nl=(l,e)=>{for(var n in e||(e={}))el.call(e,n)&&jr(l,n,e[n]);if(Mr)for(var n of Mr(e))tl.call(e,n)&&jr(l,n,e[n]);return l};const Tu=l=>React.createElement("svg",nl({className:"general_svg__icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:200,height:200},l),React.createElement("path",{d:"M0 512a512 512 0 1 0 1024 0A512 512 0 1 0 0 512Z",fill:"#DBDBDB"}),React.createElement("path",{d:"m863.884 488.727-62.837-10.938a289.513 289.513 0 0 0-21.41-78.196l49.338-41.193a24.67 24.67 0 0 0-23.273-42.356l-61.207 23.272a292.77 292.77 0 0 0-56.786-56.087l23.273-61.673a24.67 24.67 0 0 0-42.357-23.272l-42.123 50.501a289.745 289.745 0 0 0-76.8-20.247l-14.43-68.422a24.67 24.67 0 0 0-48.872 0l-11.404 65.164a289.745 289.745 0 0 0-76.8 20.247l-40.96-50.502a24.67 24.67 0 0 0-42.356 23.273l23.273 61.673a292.77 292.77 0 0 0-56.786 56.087l-61.207-23.273a24.67 24.67 0 0 0-23.273 42.357l49.338 41.193a289.513 289.513 0 0 0-21.41 78.196l-64.699 14.196a24.67 24.67 0 0 0 0 48.873l62.139 10.705a289.745 289.745 0 0 0 20.48 79.826l-47.71 38.633a24.67 24.67 0 0 0 23.273 42.356l58.182-21.41a292.77 292.77 0 0 0 58.415 59.112l-21.179 57.716a24.67 24.67 0 0 0 42.357 23.273l38.865-46.546a289.745 289.745 0 0 0 80.99 21.644l12.8 60.975a24.67 24.67 0 0 0 48.872 0l10.473-59.811a289.745 289.745 0 0 0 80.29-21.877l38.866 46.546a24.67 24.67 0 0 0 42.356-23.273l-21.178-57.716a292.77 292.77 0 0 0 58.415-59.113l58.182 21.41a24.67 24.67 0 0 0 23.272-42.355l-47.709-39.797a289.745 289.745 0 0 0 20.48-79.825l62.837-12.8a24.67 24.67 0 0 0 0-48.873zm-142.43 25.833a209.455 209.455 0 0 1-16.058 80.756l-170.123-98.443V306.502A209.455 209.455 0 0 1 721.455 514.56zM488.728 306.502v190.836l-169.425 97.746a209.455 209.455 0 0 1 169.425-288.582zM512 724.015a209.455 209.455 0 0 1-170.59-88.204L512 537.367l170.59 98.444A209.455 209.455 0 0 1 512 724.015z",fill:"#8E8E8E"}));var al="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PHBhdGggZD0iTTAgNTEyYTUxMiA1MTIgMCAxIDAgMTAyNCAwQTUxMiA1MTIgMCAxIDAgMCA1MTJaIiBmaWxsPSIjREJEQkRCIi8+PHBhdGggZD0ibTg2My44ODQgNDg4LjcyNy02Mi44MzctMTAuOTM4YTI4OS41MTMgMjg5LjUxMyAwIDAgMC0yMS40MS03OC4xOTZsNDkuMzM4LTQxLjE5M2EyNC42NyAyNC42NyAwIDAgMC0yMy4yNzMtNDIuMzU2bC02MS4yMDcgMjMuMjcyYTI5Mi43NyAyOTIuNzcgMCAwIDAtNTYuNzg2LTU2LjA4N2wyMy4yNzMtNjEuNjczYTI0LjY3IDI0LjY3IDAgMCAwLTQyLjM1Ny0yMy4yNzJsLTQyLjEyMyA1MC41MDFhMjg5Ljc0NSAyODkuNzQ1IDAgMCAwLTc2LjgtMjAuMjQ3bC0xNC40My02OC40MjJhMjQuNjcgMjQuNjcgMCAwIDAtNDguODcyIDBsLTExLjQwNCA2NS4xNjRhMjg5Ljc0NSAyODkuNzQ1IDAgMCAwLTc2LjggMjAuMjQ3bC00MC45Ni01MC41MDJhMjQuNjcgMjQuNjcgMCAwIDAtNDIuMzU2IDIzLjI3M2wyMy4yNzMgNjEuNjczYTI5Mi43NyAyOTIuNzcgMCAwIDAtNTYuNzg2IDU2LjA4N2wtNjEuMjA3LTIzLjI3M2EyNC42NyAyNC42NyAwIDAgMC0yMy4yNzMgNDIuMzU3bDQ5LjMzOCA0MS4xOTNhMjg5LjUxMyAyODkuNTEzIDAgMCAwLTIxLjQxIDc4LjE5NmwtNjQuNjk5IDE0LjE5NmEyNC42NyAyNC42NyAwIDAgMCAwIDQ4Ljg3M2w2Mi4xMzkgMTAuNzA1YTI4OS43NDUgMjg5Ljc0NSAwIDAgMCAyMC40OCA3OS44MjZsLTQ3LjcxIDM4LjYzM2EyNC42NyAyNC42NyAwIDAgMCAyMy4yNzMgNDIuMzU2bDU4LjE4Mi0yMS40MWEyOTIuNzcgMjkyLjc3IDAgMCAwIDU4LjQxNSA1OS4xMTJsLTIxLjE3OSA1Ny43MTZhMjQuNjcgMjQuNjcgMCAwIDAgNDIuMzU3IDIzLjI3M2wzOC44NjUtNDYuNTQ2YTI4OS43NDUgMjg5Ljc0NSAwIDAgMCA4MC45OSAyMS42NDRsMTIuOCA2MC45NzVhMjQuNjcgMjQuNjcgMCAwIDAgNDguODcyIDBsMTAuNDczLTU5LjgxMWEyODkuNzQ1IDI4OS43NDUgMCAwIDAgODAuMjktMjEuODc3bDM4Ljg2NiA0Ni41NDZhMjQuNjcgMjQuNjcgMCAwIDAgNDIuMzU2LTIzLjI3M2wtMjEuMTc4LTU3LjcxNmEyOTIuNzcgMjkyLjc3IDAgMCAwIDU4LjQxNS01OS4xMTNsNTguMTgyIDIxLjQxYTI0LjY3IDI0LjY3IDAgMCAwIDIzLjI3Mi00Mi4zNTVsLTQ3LjcwOS0zOS43OTdhMjg5Ljc0NSAyODkuNzQ1IDAgMCAwIDIwLjQ4LTc5LjgyNWw2Mi44MzctMTIuOGEyNC42NyAyNC42NyAwIDAgMCAwLTQ4Ljg3M3ptLTE0Mi40MyAyNS44MzNhMjA5LjQ1NSAyMDkuNDU1IDAgMCAxLTE2LjA1OCA4MC43NTZsLTE3MC4xMjMtOTguNDQzVjMwNi41MDJBMjA5LjQ1NSAyMDkuNDU1IDAgMCAxIDcyMS40NTUgNTE0LjU2ek00ODguNzI4IDMwNi41MDJ2MTkwLjgzNmwtMTY5LjQyNSA5Ny43NDZhMjA5LjQ1NSAyMDkuNDU1IDAgMCAxIDE2OS40MjUtMjg4LjU4MnpNNTEyIDcyNC4wMTVhMjA5LjQ1NSAyMDkuNDU1IDAgMCAxLTE3MC41OS04OC4yMDRMNTEyIDUzNy4zNjdsMTcwLjU5IDk4LjQ0NEEyMDkuNDU1IDIwOS40NTUgMCAwIDEgNTEyIDcyNC4wMTV6IiBmaWxsPSIjOEU4RThFIi8+PC9zdmc+",rl=zo,il=g(64599),Ht=g.n(il),xr=g(25478),ol=g(66979),ll=g.n(ol),sl=g(58660);function cl(){return navigator.languages!=null?navigator.languages[0]:navigator.language}var dl=g(75503),Du=g(85835),ul=function(e){var n=e.plotlyData,a=e.handleUpdate,r=e.mode,i=(0,s.useRef)(null),o=function(p,u,f){a&&a({data:p,layout:u,frames:f})},d=function(p,u,f){a&&a({data:p,layout:u,frames:f})},c=function(){console.log("PlotlyViewer handleResize: ",e.forceResize,i);var p=document.querySelector("#".concat(e.divId));e.divId&&e.forceResize&&p&&xr.relayout(e.divId,{autosize:!0})};(0,s.useEffect)(function(){if(e.divId&&e.forceResize){var w=document.querySelector("#".concat(e.divId)),p=new ResizeObserver(function(u){var f=Ht()(u),b;try{for(f.s();!(b=f.n()).done;){var L=b.value;console.log("Element size changed to ".concat(L.contentRect.width,"x").concat(L.contentRect.height)),L.target==w&&(console.log("Parent size changed"),c())}}catch(D){f.e(D)}finally{f.f()}});return w&&p.observe(w),function(){return p.disconnect()}}else return function(){}},[i]);var y={toImageButtonOptions:{format:"svg",filename:"custom_image",height:1e3,width:1e3,scale:1},editable:!0,scrollZoom:!1,displaylogo:!1,displayModeBar:!0,showTips:!0,responsive:!0,locales:{"zh-CN":dl},locale:cl()};console.log("PlotlyViewer updated: ",e);var S=n||{data:[],layout:{}},M=S.data,N=S.layout,h=S.frames;return N=m()(m()({},N),{},{margin:{t:50,r:50,b:50,l:50}}),r==="Plotly"?(0,t.jsx)(sl.Z,{ref:i,divId:e.divId,useResizeHandler:!0,className:"plotly-viewer",data:M,layout:m()(m()({},N),{},{autosize:!0}),config:y,onClick:e.onClick,frames:h}):(0,t.jsx)("div",{className:"plotly-editor",children:(0,t.jsx)(ll(),{ref:i,divId:e.divId,data:M,layout:m()(m()({},N),{},{autosize:!0}),config:y,frames:h,plotly:xr,onClick:e.onClick,onUpdate:o,onRender:d,useResizeHandler:!0,advancedTraceTypeSelector:!0})})},vn=(0,s.memo)(ul),_e=g(71230),Ze=g(15746),Sn=g(65950),hl=g(15009),We=g.n(hl),fl=g(99289),Kt=g.n(fl),J=g(22150),B=g(45360),on=g(85576),pe=g(34041),Jt=g(69677),$t=g(22725),Nr=g(14104),X=g(96486),gl=g(9783),Ee=g.n(gl),nt="::",yl=function(){function l(e,n){Vt()(this,l),Ee()(this,"data",void 0),Ee()(this,"merge_mode",void 0),this.data=e,this.merge_mode=n}return Wt()(l,[{key:"get_instance_id",value:function(){return"path-search-object"}},{key:"get_current_node_id",value:function(){return"".concat(this.data.source_entity_type).concat(nt).concat(this.data.source_entity_id)}},{key:"get_target_node_id",value:function(){return"".concat(this.data.target_entity_type).concat(nt).concat(this.data.target_entity_id)}},{key:"get_source_node_id",value:function(){return"".concat(this.data.source_entity_type).concat(nt).concat(this.data.source_entity_id)}},{key:"process",value:function(n){return this.data.source_entity_id&&this.data.target_entity_id?n.GetNStepsLinkedNodesFn({start_node_id:this.get_source_node_id(),end_node_id:this.get_target_node_id(),nhops:this.data.nsteps}):new Promise(function(a,r){r("The source_entity_id and target_entity_id must be set.")})}}]),l}(),Un=[{label:"Replace",value:"replace"},{label:"Append",value:"append"},{label:"Subtract",value:"subtract"}],pl=g(65936),ml=function(){var e=null;return document.cookie&&document.cookie.includes("jwt_access_token=")&&(e=document.cookie.split("; ").find(function(n){return n.startsWith("jwt_access_token=")}).split("=")[1]),e?(console.log("JWT access token found in the cookie."),e):(console.log("JWT access token not found in the cookie."),null)},Cr=function(){var l=Kt()(We()().mark(function e(){var n,a,r,i,o;return We()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(n=ml(),!n){c.next=5;break}return c.abrupt("return",null);case 5:if(a=localStorage.getItem("rapex-visitor-id"),a){c.next=15;break}return r=pl.ZP.load(),c.next=10,r;case 10:return i=c.sent,c.next=13,i.get();case 13:o=c.sent,a=o.visitorId;case 15:return c.abrupt("return",a);case 16:case"end":return c.stop()}},e)}));return function(){return l.apply(this,arguments)}}(),Ir=function(e,n){return"".concat(n).concat(nt).concat(e)},vl=function(e){var n=e.split(nt),a=v()(n,2),r=a[0],i=a[1];return{entityType:r,entityId:i}},Sl=function(e){for(var n=[],a=[],r=0;r<e.length;r++){var i=vl(e[r]),o=i.entityType,d=i.entityId;n.push(d),a.push(o)}return{entityIds:n,entityTypes:a}},br=function(e,n){for(var a=[],r=0;r<e.length;r++)a.push(Ir(e[r],n[r]));return a},wr=function(e,n,a){var r=br(e,n);return r.join(a||",")},Lr=function(e){var n=0;return e.forEach(function(a){var r=a.toString().length;r>n&&(n=r)}),n},Ml=function(){return"<>"},Tr=function(e,n,a,r){var i=Ml();return e.indexOf("::")>=0?e:[e,n,a,r].join(i)},Dr=function(e){if(!e||e.length===0)return[];var n=[],a=Lr(e.map(function(o){return o.relation_count})),r={};e.forEach(function(o){var d="".concat(o.relation_type,"-").concat(o.start_entity_type,"-").concat(o.end_entity_type);r[d]?(r[d].relation_count+=o.relation_count,r[d].resources.push(o.resource)):r[d]={id:o.id,description:o.description,relation_count:o.relation_count,resource:o.resource,resources:[o.resource],relation_type:o.relation_type,start_entity_type:o.start_entity_type,end_entity_type:o.end_entity_type}});var i=Object.values(r).map(function(o){return{id:o.id,description:o.description,relation_count:o.relation_count,resource:o.resources.join("|"),relation_type:o.relation_type,start_entity_type:o.start_entity_type,end_entity_type:o.end_entity_type}});return i.forEach(function(o){var d=o.relation_count.toString().padStart(a,"0"),c=Tr(o.relation_type,o.resource,o.start_entity_type,o.end_entity_type);n.push({order:o.relation_count,label:"[".concat(d,"] ").concat(c),value:c,description:o.description||"No description available."})}),console.log("makeRelationTypes",n,e,i),(0,X.uniqBy)(n,"value").sort(function(o,d){return d.order-o.order})};function Er(l,e){var n={},a={};l.label&&(a={operator:"=",field:"label",value:l.label});var r=(0,X.filter)(Object.keys(l),function(i){return i!=="label"});return r.length>1?(n={operator:"or",items:[]},e&&(r=e.filter(function(i){return r.includes(i)}))):n={operator:"and",items:[]},n.items=r.map(function(i){return{operator:"ilike",field:i,value:"%".concat(l[i],"%")}}),a.field&&(n.operator==="and"?n.items.push(a):n={operator:"and",items:[n,a]}),JSON.stringify(n)}var Yn,Bn=function(){var l=Kt()(We()().mark(function e(n,a,r,i){var o,d,c;return We()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!(r.length<3)){S.next=3;break}return i([]),S.abrupt("return");case 3:Yn&&(clearTimeout(Yn),Yn=null),o={},d=[],r&&!isNaN(Number(r))?(o={id:r,xrefs:r,label:a},d=["id","xrefs"]):(o={name:r,synonyms:r,xrefs:r,id:r,label:a},d=["name","synonyms","xrefs","id"]),c=function(){n({query_str:Er(o,d),page:1,page_size:50}).then(function(N){var h=N.records,w=h.map(function(p,u){return{order:u,value:p.id,label:"".concat(p.id," | ").concat(p.name),description:p.description,metadata:p}});console.log("getLabels results: ",w),i(w)}).catch(function(N){console.log("requestNodes Error: ",N),i([])})},Yn=setTimeout(c,300);case 9:case"end":return S.stop()}},e)}));return function(n,a,r,i){return l.apply(this,arguments)}}(),Ar=function(e){var n={nodes:e.getNodes().map(function(a){var r=a.getModel();return m()(m()({},r),{},{style:r._initialStyle,_initialStyle:r.style})}),edges:e.getEdges().map(function(a){var r=a.getModel();return m()(m()({},r),{},{style:r._initialStyle,_initialStyle:r.style})})};return{data:n,layout:{width:e.getWidth(),height:e.getHeight(),matrix:e.cfg.group.getMatrix()}}},Mn=function(e){if(!e)return"";var n="".concat(e);if(n.startsWith("ENTREZ"))return"https://www.genecards.org/cgi-bin/carddisp.pl?gene=".concat(n.split(":")[1]);if(n.startsWith("DrugBank"))return"https://go.drugbank.com/drugs/".concat(n.split(":")[1]);if(n.startsWith("KEGG"))return"https://www.genome.jp/entry/pathway+".concat(n.split(":")[1]);if(n.startsWith("WikiPathways"))return"https://www.wikipathways.org/pathways/".concat(n.split(":")[1],".html");if(n.startsWith("MESH"))return"https://bioportal.bioontology.org/ontologies/MESH?p=classes&conceptid=".concat(n.split(":")[1]);if(n.startsWith("Reactome"))return"https://reactome.org/content/detail/".concat(n.split(":")[1]);if(n.startsWith("MONDO"))return"https://bioportal.bioontology.org/ontologies/MONDO?p=classes&conceptid=".concat(n);if(n.startsWith("DOID"))return"https://bioportal.bioontology.org/ontologies/DOID?p=classes&conceptid=".concat(n);if(n.startsWith("HP"))return"https://bioportal.bioontology.org/ontologies/HP?p=classes&conceptid=".concat(n);if(n.startsWith("GO"))return"https://bioportal.bioontology.org/ontologies/GO?p=classes&conceptid=".concat(n);if(n.startsWith("SYMP"))return"https://bioportal.bioontology.org/ontologies/SYMP?p=classes&conceptid=".concat(n);if(n.startsWith("HMDB"))return"https://hmdb.ca/metabolites/".concat(n.split(":")[1]);if(n.startsWith("UBERON"))return"https://bioportal.bioontology.org/ontologies/UBERON?p=classes&conceptid=http://purl.obolibrary.org/obo/UBERON_".concat(n.split(":")[1])},jl=function(e){if(!e)return"";var n="".concat(e);typeof e=="number"&&(n=e.toFixed(0).toString());var a={9606:"Human",10090:"Mouse",10116:"Rat"};return a[n]||""},at=g(81209),kr={AdG:"Anatomy-downregulates-Gene",AeG:"Anatomy-expresses-Gene",AuG:"Anatomy-upregulates-Gene",CbG:"Compound-binds-Gene",CcSE:"Compound-causes-Side Effect",CdG:"Compound-downregulates-Gene",CpD:"Compound-palliates-Disease",CrC:"Compound-resembles-Compound",CtD:"Compound-treats-Disease",CuG:"Compound-upregulates-Gene",DaG:"Disease-associates-Gene",DdG:"Disease-downregulates-Gene",DlA:"Disease-localizes-Anatomy",DpS:"Disease-presents-Symptom",DrD:"Disease-resembles-Disease",DuG:"Disease-upregulates-Gene",GcG:"Gene-covaries-Gene",GiG:"Gene-interacts-Gene",GpBP:"Gene-participates-Biological Process",GpCC:"Gene-participates-Cellular Component",GpMF:"Gene-participates-Molecular Function",GpPW:"Gene-participates-Pathway","Gr>G":"Gene-regulates-Gene",PCiC:"Pharmacologic Class-includes-Compound",AGONIST:"Agonist","PARTIAL AGONIST":"Partial Agonist",INHIBITOR:"Inhibitor",ACTIVATOR:"Activator",ANTAGONIST:"Antagonist",BINDER:"Binder","CHANNEL BLOCKER":"Channel Blocker",BLOCKER:"Blocker","POSITIVE ALLOSTERIC MODULATOR":"Positive Allosteric Modulator","ALLOSTERIC MODULATOR":"Allosteric Modulator",MODULATOR:"Modulator",OTHER:"Other",ANTIBODY:"Antibody",enzyme:"enzyme",target:"target","x-atc":"x-atc",treats:"treats",carrier:"carrier","PROTEIN CLEAVAGE":"Protein Cleavage","PHYSICAL ASSOCIATION":"Physical Association",ASSOCIATION:"Association","DIRECT INTERACTION":"Direct Interaction",COLOCALIZATION:"Colocalization","DEPHOSPHORYLATION REACTION":"Dephosphorylation Reaction","CLEAVAGE REACTION":"Cleavage Reaction","PHOSPHORYLATION REACTION":"Phosphorylation Reaction","ADP RIBOSYLATION REACTION":"Adp Ribosylation Reaction","UBIQUITINATION REACTION":"Ubiquitination Reaction",PTMOD:"Ptmod",BINDING:"Binding",ACTIVATION:"Activation",REACTION:"Reaction",CATALYSIS:"Catalysis",INHIBITION:"Inhibition",EXPRESSION:"Expression",DrugVirGen:"DrugVirGen",HumGenHumGen:"HumGenHumGen",Coronavirus_ass_host_gene:"Coronavirus_ass_host_gene",VirGenHumGen:"VirGenHumGen",Covid2_acc_host_gene:"Covid2_acc_host_gene",DrugHumGen:"DrugHumGen","A+":"agonism, activation","A-":"antagonism, blocking",B:"binding, ligand (esp. receptors)","E+":"increases expression/production","E-":"decreases expression/production",E:"affects expression/production (neutral)",N:"inhibits",O:"transport, channels",K:"metabolism, pharmacokinetics",Z:"enzyme activity",T:"treatment/therapy (including investigatory)",C:"inhibits cell growth (esp. cancers)",Sa:"side effect/adverse event",Pr:"prevents, suppresses",Pa:"alleviates, reduces",J:"role in disease pathogenesis",Mp:"biomarkers (of disease progression)",U:"causal mutations",Ud:"mutations affecting disease course",D:"drug targets",Te:"possible therapeutic effect",Y:"polymorphisms alter risk",G:"promotes progression",Md:"biomarkers (diagnostic)",X:"overexpression in disease",L:"improper regulation linked to disease",W:"enhances response","V+":"activates, stimulates",I:"signaling pathway",H:"same protein or complex",Rg:"regulation",Q:"production by cell population"},Qn,xl=function(){return(0,t.jsxs)("span",{children:["The knowledge graph editor is a tool to help curate knowledges from the literatures. It use the triplet format to represent the knowledge. Each triplet is a directed edge with a source node, a target node and a relation type. The source and target node can be any biological entities, such as gene, disease, drug, etc."," ",(0,t.jsxs)("b",{children:["Please read the help doc carefully before you start. If you have any questions, please"," ",(0,t.jsx)("a",{href:"mailto:jyang85@mgh.harvard.edu",children:"contact us"}),"."]})]})},Or=function(){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:"Please enter your interested node. Such as TP53, Fatigue, etc."}),(0,t.jsx)("br",{}),(0,t.jsx)("span",{children:"In case of duplicate ID:"}),(0,t.jsx)("br",{}),(0,t.jsx)("span",{children:"- For disease, use the MESH ID"}),(0,t.jsx)("br",{}),(0,t.jsx)("span",{children:"- For gene, use the correct ID corresponding to the source species"})]})},Nl=function(e){var n=J.Z.useForm(),a=v()(n,1),r=a[0],i=J.Z.useWatch("source_type",r),o=J.Z.useWatch("target_type",r),d=(0,s.useState)({}),c=v()(d,2),y=c[0],S=c[1],M=(0,s.useState)([]),N=v()(M,2),h=N[0],w=N[1],p=(0,s.useState)(!1),u=v()(p,2),f=u[0],b=u[1],L=(0,s.useState)(!1),D=v()(L,2),k=D[0],U=D[1],F=(0,s.useState)("Search nodes ..."),T=v()(F,2),z=T[0],C=T[1],j=(0,s.useState)(void 0),I=v()(j,2),R=I[0],Q=I[1],se=(0,s.useState)([]),O=v()(se,2),_=O[0],Ie=O[1],me=(0,s.useState)(!1),Ae=v()(me,2),ge=Ae[0],it=Ae[1],ut=(0,s.useState)("help"),ht=v()(ut,2),Ge=ht[0],ft=ht[1],St=function(A){var Z=[],$=new Set(A.map(function(ye){return ye.entity_type}));$?($.forEach(function(ye){Z.push({order:0,label:ye,value:ye})}),w((0,X.sortBy)(Z,"label"))):w([])},Mt=function(A,Z,$){var ye=A.filter(function(ce){return ce.start_entity_type==Z&&ce.end_entity_type==$||ce.start_entity_type==$&&ce.end_entity_type==Z}),le=ye.map(function(ce){return{fullRelationType:ce.relation_type,source:ce.relation_type.split("::")[0],relationType:ce.relation_type.replace(/^[a-zA-Z0-9]+::/g,"").replace("::".concat(ce.start_entity_type,":").concat(ce.end_entity_type),""),description:ce.description?ce.description:""}}),re=function(Ce){var ot=kr[Ce.relationType]?kr[Ce.relationType]:Ce.relationType;return at.Z.titleCase("".concat(ot))+" [".concat(Ce.source,"]")},we=(0,X.sortBy)(le.map(function(ce){return{order:0,label:re(ce),value:ce.fullRelationType,description:ce.description}}),["label"]);Ie(we)},$e=function(){e.curator?r.setFieldsValue({curator:e.curator}):Cr().then(function(A){localStorage.setItem("rapex-visitor-id",A),r.setFieldsValue({curator:A})})};(0,s.useEffect)(function(){e.getStatistics().then(function(P){S(P)}).catch(function(P){console.log(P),B.ZP.error("Failed to get statistics, please check the network connection.")}),$e()},[]),(0,s.useEffect)(function(){y.entity_stat&&St(y.entity_stat),y.relation_stat&&i&&o&&Mt(y.relation_stat,i,o),$e()},[y,i,o]),(0,s.useEffect)(function(){e.formData&&r.setFieldsValue(e.formData)},[e.formData]);var gt=function(){var P=Kt()(We()().mark(function A(Z,$,ye){var le;return We()().wrap(function(we){for(;;)switch(we.prev=we.next){case 0:Qn&&(clearTimeout(Qn),Qn=null),le=function(){b(!0),e.getEntities({query_str:Er({id:$,name:$,label:Z}),page:1,page_size:100}).then(function(Ce){var ot=Ce.records,xt=ot.map(function(Fe){return{value:"".concat(Fe.id),text:ne(Fe)}});console.log("Get Entities: ",xt,ot);var lt=xt.map(function(Fe){return{label:Fe.text,value:Fe.value}});b(!1),ye((0,X.sortBy)(lt,["label"]))}).catch(function(Ce){console.log("requestNodes Error: ",Ce),ye([]),b(!1)})},Qn=setTimeout(le,300);case 3:case"end":return we.stop()}},A)}));return function(Z,$,ye){return P.apply(this,arguments)}}(),yt=function(A){Q(void 0),C("Search ".concat(A," nodes ..."))},jt=function(A,Z){Z?gt(A,Z,Q):Q(void 0)},ae=function(A){it(!0),ft(A)},ne=function(A){return A.label=="Gene"?A.taxid?"".concat(A.name," | ").concat(A.id," | ").concat(A.taxid," | ").concat(A.resource):"".concat(A.name," | ").concat(A.id," | Homo sapiens | ").concat(A.resource):"".concat(A.name," | ").concat(A.id," | ").concat(A.resource)},be=function(A,Z,$){console.log("handleSelectEntity: ",Z,$);var ye=Z,le=$.label.split(" | ")[0];console.log("handleSelectEntityType: ",A,Z,$),A=="source"?(r.setFieldsValue({source_id:ye}),r.setFieldsValue({source_name:le})):A=="target"&&(r.setFieldsValue({target_id:ye}),r.setFieldsValue({target_name:le}))},Ye=function(){r.resetFields(),e.onClose&&e.onClose()},Be=function(){it(!1)},Xe=function(A){return console.log("getFile params: ",A),fetch(A.filelink).then(function(Z){return Z.text()}).then(function(Z){return Z})},ue=function(){U(!0),r.validateFields().then(function(A){if(console.log("onConfirm form values: ",A),e.onSubmit){var Z=m()({},A);e.formData&&(Z=m()(m()({},Z),{},{id:e.formData.id})),e.onSubmit(Z).then(function(){r.resetFields(),U(!1)}).catch(function($){console.log("onConfirm error: ",$),B.ZP.error("Submit error, please try later!"),U(!1)})}}).catch(function(A){B.ZP.error("Unknow error, please try later!"),console.log("errorInfo: ",A),U(!1)})};return(0,t.jsxs)(_e.Z,{className:"graph-form-container",children:[(0,t.jsxs)("h3",{className:"title",children:[(0,t.jsx)("span",{style:{marginRight:"5px"},children:"Graph Form"}),(0,t.jsx)(q.ZP,{className:"help-button",type:"primary",size:"small",onClick:function(){return ae("help")},children:"Help"}),(0,t.jsx)(q.ZP,{className:"help-button",type:"primary",size:"small",onClick:function(){return ae("manual")},children:"Manual"})]}),(0,t.jsx)("p",{className:"graph-help",children:xl()}),(0,t.jsx)(on.Z,{className:"help-container",title:at.Z.titleCase(Ge),onCancel:Be,open:ge,destroyOnClose:!0,footer:null,width:"60%",children:(0,t.jsx)(mn,{url:"".concat(window.publicPath,"README/knowledge_editor_").concat(Ge,".md"),getFile:void 0})}),(0,t.jsxs)(J.Z,{name:"basic",labelCol:{span:8},wrapperCol:{span:16},form:r,className:"graph-form",autoComplete:"on",labelAlign:"left",children:[(0,t.jsx)(J.Z.Item,{label:"Source Node Type",name:"source_type",tooltip:"Please select a node type.",rules:[{required:!0,message:"Please select a node type."}],children:(0,t.jsx)(pe.default,{allowClear:!0,getPopupContainer:function(A){return A.parentNode},defaultActiveFirstOption:!1,placeholder:"Please select a node type.",options:h,filterOption:!0,onSelect:yt})}),(0,t.jsx)(J.Z.Item,{label:"Source Node ID",name:"source_id",tooltip:Or(),rules:[{required:!0,message:"Please enter your expected node."}],children:(0,t.jsx)(pe.default,{showSearch:!0,allowClear:!0,getPopupContainer:function(A){return A.parentNode},loading:f,defaultActiveFirstOption:!1,placeholder:z,onSearch:function(A){return jt(i,A)},options:R,filterOption:!1,onSelect:function(A,Z){return be("source",A,Z)},notFoundContent:(0,t.jsx)(Oe.Z,{description:f?"Searching...":R!==void 0?"Not Found or Too Short Input":i?"Enter your interested ".concat(i," ..."):"Select source node type first."})})}),(0,t.jsx)(J.Z.Item,{label:"Source Node Name",name:"source_name",hidden:!0,rules:[{required:!0,message:"Please enter your expected node."}],children:(0,t.jsx)(Jt.Z,{placeholder:"Please enter the source node name",disabled:!0})}),(0,t.jsx)(J.Z.Item,{label:"Target Node Type",name:"target_type",tooltip:"Please select a node type.",rules:[{required:!0,message:"Please select a node type."}],children:(0,t.jsx)(pe.default,{allowClear:!0,getPopupContainer:function(A){return A.parentNode},defaultActiveFirstOption:!1,placeholder:"Please select a node type.",options:h,filterOption:!0,onSelect:yt})}),(0,t.jsx)(J.Z.Item,{label:"Target Node ID",name:"target_id",tooltip:Or(),rules:[{required:!0,message:"Please enter your expected node."}],children:(0,t.jsx)(pe.default,{showSearch:!0,allowClear:!0,loading:f,getPopupContainer:function(A){return A.parentNode},defaultActiveFirstOption:!1,placeholder:z,onSearch:function(A){return jt(o,A)},options:R,filterOption:!1,onSelect:function(A,Z){return be("target",A,Z)},notFoundContent:(0,t.jsx)(Oe.Z,{description:f?"Searching...":R!==void 0?"Not Found or Too Short Input":o?"Enter your interested ".concat(o," ..."):"Select source node type first."})})}),(0,t.jsx)(J.Z.Item,{label:"Target Node Name",name:"target_name",hidden:!0,rules:[{required:!0,message:"Please enter your expected node."}],children:(0,t.jsx)(Jt.Z,{placeholder:"Please enter the target node name",disabled:!0})}),(0,t.jsx)(J.Z.Item,{label:"Relation Type",name:"relation_type",tooltip:"Please enter relationship type.",rules:[{required:!0,message:"Please enter relationship type."}],children:(0,t.jsx)(pe.default,{showSearch:!0,allowClear:!0,loading:f,getPopupContainer:function(A){return A.parentNode},defaultActiveFirstOption:!1,placeholder:"Please select a relationship type.",filterOption:!1,notFoundContent:(0,t.jsx)(Oe.Z,{description:_?"Select source node and target node first.":"Not Found"}),children:_.map(function(P){return(0,t.jsx)(pe.default.Option,{value:P.value,children:(0,t.jsxs)("div",{className:"option-container",children:[(0,t.jsx)("div",{className:"option-label",children:P.label}),(0,t.jsx)("div",{className:"option-description",children:P.description})]})},P.value)})})}),(0,t.jsx)(J.Z.Item,{label:"PMID",name:"pmid",tooltip:"Please enter pmid which is related with your curated knowledge.",rules:[{required:!0,message:"Please enter pmid which is related with your curated knowledge."}],children:(0,t.jsx)($t.Z,{placeholder:"Please enter the pmid",min:1,max:1e8,style:{width:"100%"}})}),(0,t.jsx)(J.Z.Item,{label:"Curator",name:"curator",rules:[{required:!1,message:"Please enter your name."}],children:(0,t.jsx)(Jt.Z,{placeholder:"Please enter your name",disabled:!0})}),(0,t.jsx)(J.Z.Item,{label:"Key Sentence",name:"key_sentence",tooltip:"Please choose the key sentence which can describe the relationship between the source node and the target node best from the paper.If necessary, please improve it for human readable.",rules:[{required:!0,message:"Please input key sentence!"}],children:(0,t.jsx)(Nr.Z,{rows:8,placeholder:"Please input key sentence!"})}),(0,t.jsxs)(J.Z.Item,{wrapperCol:{offset:14},children:[(0,t.jsx)(q.ZP,{style:{marginRight:"10px"},onClick:Ye,children:"Cancel"}),(0,t.jsx)(q.ZP,{type:"primary",onClick:ue,loading:k,children:"Submit"})]})]})]})},Cl=Nl,jn=g(42075),zt=g(55241),Vn=g(18374),vt=g(66309),Eu=[{source_name:"John Brown",source_id:"32",source_type:"New York No. 1 Lake Park",target_name:"John Brown",target_id:"32",target_type:"New York No. 1 Lake Park",relation_type:"relation_type",key_sentence:"key_sentence",pmid:123456}],Il=function(e){var n=(0,s.useState)({}),a=v()(n,2),r=a[0],i=a[1],o=(0,s.useState)(!1),d=v()(o,2),c=d[0],y=d[1],S=(0,s.useState)(e.page||1),M=v()(S,2),N=M[0],h=M[1],w=(0,s.useState)(e.pageSize||30),p=v()(w,2),u=p[0],f=p[1],b=(0,s.useState)(0),L=v()(b,2),D=L[0],k=L[1],U=[{title:"Actions",key:"actions",align:"center",fixed:"left",width:120,render:function(C,j){return(0,t.jsxs)(jn.Z,{children:[(0,t.jsx)("div",{children:(0,t.jsx)(q.ZP,{size:"small",disabled:!e.editKnowledge,onClick:function(){F(j)},children:"Edit"})}),(0,t.jsx)("div",{children:(0,t.jsx)(zt.Z,{content:(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{style:{marginBottom:"5px"},children:"Are you sure to delete this knowledge?"}),(0,t.jsx)("p",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"0"},children:(0,t.jsx)(q.ZP,{danger:!0,size:"small",onClick:function(){j.id!==void 0&&j.id>=0&&e.deleteKnowledgeById?e.deleteKnowledgeById(j.id).then(function(R){B.ZP.success("Delete knowledge successfully!"),k(D+1)}).catch(function(R){console.log("Delete knowledge error: ",R),B.ZP.error("Delete knowledge failed!")}):(B.ZP.error("Delete knowledge failed!"),console.log("Delete knowledge error: ",j,e.deleteKnowledgeById))},children:"Confirm"})})]}),title:"Comfirm",children:(0,t.jsx)(q.ZP,{danger:!0,size:"small",disabled:!e.deleteKnowledgeById,children:"Delete"})})})]})}},{title:"Relation Type",key:"relation_type",align:"center",dataIndex:"relation_type",fixed:"left",width:240},{title:"PMID",dataIndex:"pmid",align:"center",key:"pmid",render:function(C){return(0,t.jsx)("a",{target:"_blank",href:"https://pubmed.ncbi.nlm.nih.gov/?term=".concat(C),children:C})},fixed:"left",width:100},{title:"Source Name",dataIndex:"source_name",key:"source_name",align:"center",width:200},{title:"Source ID",dataIndex:"source_id",align:"center",key:"source_id",width:150},{title:"Source Type",dataIndex:"source_type",align:"center",key:"source_type",width:100},{title:"Target Name",dataIndex:"target_name",align:"center",key:"target_name",width:200},{title:"Target ID",dataIndex:"target_id",align:"center",key:"target_id",width:150},{title:"Target Type",dataIndex:"target_type",align:"center",key:"target_type",width:100},{title:"Created Time",key:"created_at",align:"center",dataIndex:"created_at",render:function(C){return new Date(C).toLocaleString()},width:200}],F=function(C){e.editKnowledge&&e.editKnowledge(C)};(0,s.useEffect)(function(){y(!0),e.getTableData(N,u).then(function(z){i(z),y(!1)}).catch(function(z){console.log("Get knowledges error: ",z),i({}),y(!1)})},[N,u,D]);var T=function(C){return C.id||"".concat(JSON.stringify(C))};return(0,t.jsx)(_e.Z,{className:"graph-table-container",children:(0,t.jsx)(Vn.Z,{className:e.className+" graph-table",style:e.style,size:"small",columns:U,loading:c,scroll:{x:e.xScroll||1e3,y:e.yScroll||"calc(100vh - 240px)"},dataSource:r.data,rowKey:function(C){return T(C)},expandable:{expandedRowRender:function(C){return(0,t.jsxs)("p",{style:{margin:0},children:[(0,t.jsx)(vt.Z,{children:"Key Sentence"})," ",C.key_sentence||"No Key Sentence",(0,t.jsx)("br",{}),(0,t.jsx)(vt.Z,{children:"Curator"})," ",C.curator||"Unknown"]})}},pagination:{showSizeChanger:!0,showQuickJumper:!0,pageSizeOptions:e.pageSizeOptions||["10","20","50","100","300","500","1000"],current:N,pageSize:u,total:r.total||0,position:["bottomRight"],showTotal:function(C){return"Total ".concat(C," items")}},onChange:function(C){h(C.current||1),f(C.pageSize||10)}})})},bl=Il,Pr=g(65408),wl=g(57232),ln=8,Ll=function(e){var n=s.useState(0),a=v()(n,2),r=a[0],i=a[1],o=s.useState({}),d=v()(o,2),c=d[0],y=d[1],S=function(p){return console.log("Submit knowledge: ",p),new Promise(function(u,f){if(p.id!==void 0&&p.id>=0){var b=p.id;delete p.id,e.putKnowledgeById&&e.putKnowledgeById(b,p).then(function(L){console.log("Put knowledge: ",L),i(r+1),u(L)}).catch(function(L){console.log("Put knowledge error: ",L),i(r+1),f(L)})}else e.postKnowledge&&e.postKnowledge(p).then(function(L){console.log("Post knowledge: ",L),i(r+1),u(L)}).catch(function(L){console.log("Post knowledge error: ",L),i(r+1),f(L)})})},M=function(p,u){return new Promise(function(f,b){e.getKnowledges({page:p,page_size:u}).then(function(L){console.log("Get knowledges: ",L),f({data:L.records,total:L.total,page:p,pageSize:u})}).catch(function(L){console.log("Get knowledges error: ",L),b(L)})})},N=function(p){console.log("Edit knowledge: ",p),y(p)},h=[{key:"table-viewer",label:(0,t.jsxs)("span",{children:[(0,t.jsx)(Pr.Z,{}),"Table Viewer"]}),children:(0,t.jsx)(bl,{getTableData:M,editKnowledge:N,deleteKnowledgeById:e.deleteKnowledgeById},r)},{key:"graph-viewer",label:(0,t.jsxs)("span",{children:[(0,t.jsx)(wl.Z,{}),"Graph Viewer"]}),children:(0,t.jsx)(Oe.Z,{}),disabled:!0}];return(0,t.jsxs)(_e.Z,{gutter:8,className:"knowledge-graph-editor",children:[(0,t.jsx)(Ze.Z,{xxl:ln,xl:ln,lg:ln,md:24,sm:24,xs:24,className:"form",children:(0,t.jsx)(Cl,{onSubmit:S,formData:c,onClose:function(){y({})},getEntities:e.getEntities,getStatistics:e.getStatistics})}),(0,t.jsxs)(Ze.Z,{xxl:24-ln,xl:24-ln,lg:24-ln,md:24,sm:24,xs:24,className:"table",children:[(0,t.jsx)("h3",{className:"title",children:"History Table"}),(0,t.jsx)(Sn.Z,{size:"small",defaultActiveKey:"table-viewer",items:h})]})]})},Tl=Ll,zr=g(2801),Wn=g(57953),Tt=g(47221),Zt=g(47897),Dl=g(23482),El=g(58778),Al=g(65371),kl=g(20750),Zr=g(259),Ol=g(33229),Rr=g(68902),ba=g(60403),_r=g(79218),Pl=g(45843),wa=g(59594),xn=g(69702),zl=g(79410),Zl=function(e){var n=e.position,a=e.onClick,r=(0,s.useState)(!1),i=v()(r,2),o=i[0],d=i[1],c=(0,s.useState)(e.container=="body"?document.body:!1),y=v()(c,2),S=y[0],M=y[1];(0,s.useEffect)(function(){e.visible&&d(e.visible)},[e.visible]);var N=function(){e.onClose&&e.onClose(),d(!o)},h={right:{right:"0px",top:"45%",height:"80px",width:"0px",borderColor:"transparent #ddd transparent transparent"},top:{top:"0px",left:"45%",width:"80px",height:"0px",borderColor:"#ddd transparent transparent transparent"},left:{left:"0px",top:"45%",height:"80px",width:"0px",borderColor:"transparent transparent transparent #ddd"},bottom:{left:"45%",bottom:"0px",width:"80px",height:"0px",borderColor:"transparent transparent #ddd transparent"}},w={right:{left:"5px",top:"8px"},top:{top:"-20px",left:"40%"},bottom:{left:"15px",top:"0px"},left:{left:"-15px",top:"8px"}},p=n||"right",u=h[p]?h[p]:h.right,f=w[p]?w[p]:w.right;return(0,t.jsxs)("div",{className:"toolbar",children:[(0,t.jsx)("div",{style:m()({zIndex:10,position:"absolute",cursor:"pointer",borderStyle:"solid",borderWidth:"20px",boxSizing:"border-box"},u),onClick:function(){console.log("Show Drawer: ",p),N(),a&&a(p)},children:(0,t.jsx)("span",{style:m()({position:"absolute"},f),children:p==="top"||p==="bottom"?"=":"||"})}),(0,t.jsx)(zl.Z,{width:e.width?e.width:"300px",height:e.height?e.height:"300px",title:e.title?e.title:!1,getContainer:S,rootStyle:{position:"absolute"},closable:e.closable?e.closable:!1,mask:e.maskVisible?e.maskVisible:!1,placement:n,onClose:N,open:o,children:o?e.children:null})]})},Nn=Zl,rt=g(10791),Rl=g(52677),Rt=g.n(Rl),Hn=g(3586),Dt=g(12882),He=g(36950),_l=g(37320),La=(0,s.createContext)({}),Kn=g(74769),Gl=g(49346),Ta=g(2691),Jn=g(18437),$n=g(64639),Fl=g(18975),Da=g(83865),Xn=g(49588),Ea=g(84068),Ul=g(42191),Yl=g(12320),Bl=g(51291),qn=g(61951),Ql=g(4357),Vl=g(47584),Wl=g(82921),Gr=g(82855),Hl=g(46668),Kl=g(50522),Jl=g(46414),Fr=g(91373),$l=g(11707),ea=g(26412),Xl=function(e){var n=e.data,a=e.style,r=n.map(function(i,o){return(0,t.jsx)(ea.Z.Item,{label:i[0],children:i[1]},o)});return r.length>0?(0,t.jsx)(ea.Z,{size:"small",column:2,title:null,labelStyle:{backgroundColor:"transparent"},bordered:!0,style:m()({},a),children:r}):(0,t.jsx)("span",{style:a,children:"No Properties"})},Ur=Xl,ql=function(e){var n=(0,s.useState)([]),a=v()(n,2),r=a[0],i=a[1],o=function(y,S){return(0,t.jsxs)("span",{children:[y?(0,t.jsx)(vt.Z,{color:"#f50",children:"dirty"}):(0,t.jsx)(vt.Z,{color:"#87d068",children:"cleaned"}),"\xA0",S]})},d=function(y){return y.toLocaleString()};return(0,s.useEffect)(function(){i([[(0,t.jsxs)("span",{children:["Nodes ",(0,t.jsx)(vt.Z,{color:"#2db7f5",children:"Canvas"})]}),d(e.data.numNodes||0)],[(0,t.jsxs)("span",{children:["Edges ",(0,t.jsx)(vt.Z,{color:"#2db7f5",children:"Canvas"})]}),d(e.data.numEdges||0)],[(0,t.jsxs)("span",{children:["Nodes ",(0,t.jsx)(vt.Z,{color:"#108ee9",children:"KGraph"})]}),d(e.data.numAllNodes||0)],[(0,t.jsxs)("span",{children:["Edges ",(0,t.jsx)(vt.Z,{color:"#108ee9",children:"KGraph"})]}),d(e.data.numAllEdges||0)],[(0,t.jsxs)("span",{children:["Status ",(0,t.jsx)(vt.Z,{color:"#2db7f5",children:"Canvas"})]}),o(e.data.isDirty,e.data.currentParentUUID||"")]])},[e]),r?(0,t.jsx)(Ur,{data:r,style:e.style}):null},Yr=ql,es=g(28007),Br=g(41325),ts=function(e){var n=(0,s.useRef)(null),a=(0,s.useRef)(null),r=(0,s.useRef)(null);return(0,s.useEffect)(function(){if(a.current){var i=a.current;i.addEventListener("click",function(){console.log("Focus the explanation panel"),i.style.zIndex="3";for(var o=document.getElementsByClassName("explanation-panel"),d=0;d<o.length;d++){var c=o[d];c!==i&&(c.style.zIndex="2")}})}},[a.current]),(0,t.jsxs)("div",{className:"explanation-panel"+(e.className?" ".concat(e.className):""),ref:a,style:{top:e.top||"200px",right:e.right||e.width||"unset",left:e.left||e.width||"unset"},children:[(0,t.jsxs)("div",{ref:n,style:{position:"absolute",width:e.width||"400px",height:e.height||"auto",minWidth:e.minWidth||"200px",minHeight:e.minHeight||"200px",maxWidth:e.maxWidth||"auto",maxHeight:e.maxHeight||"auto"},className:"explanation-content",children:[(0,t.jsxs)("div",{className:"explanation-title",ref:r,children:[(0,t.jsx)("h3",{children:e.title||"Explanation"}),(0,t.jsxs)("span",{children:[e.help?(0,t.jsx)(zt.Z,{content:e.help,title:"Help",placement:"topRight",children:(0,t.jsx)(wa.Z,{})}):null,e.onClose?(0,t.jsx)(Br.Z,{className:"explanation-close",onClick:function(){var o;(o=e.onClose)===null||o===void 0||o.call(e)}}):null]})]}),(0,t.jsx)("div",{className:"explanation-info",onDrag:function(o){o.preventDefault(),o.stopPropagation()},children:e.children})]}),(0,t.jsx)(es.ZP,{target:n,dragTarget:r,draggable:e.draggable!==void 0?e.draggable:!0,throttleDrag:1,edgeDraggable:!0,startDragRotate:0,throttleDragRotate:0,onDrag:function(o){o.target.style.transform=o.transform},resizable:e.resizable!==void 0?e.resizable:!0,keepRatio:e.keepRatio!==void 0?e.keepRatio:!1,throttleResize:1,renderDirections:["nw","n","ne","w","e","sw","s","se"],onResize:function(o){o.target.style.width="".concat(o.width,"px"),o.target.style.height="".concat(o.height,"px"),o.target.style.transform=o.drag.transform}})]})},_t=ts,Cn=g(68508),ns=g(13769),Qr=g.n(ns),as=["source","target"],rs=null,Au=function(e,n){return{position:"RT",type:"text",value:n||"",size:[15,15],fill:e,color:"#fff"}},ku=function(e){return"".concat(e.label).concat(COMPOSED_ENTITY_DELIMITER).concat(e.id)},is=function(e){return"".concat(e.entity_type).concat(nt).concat(e.entity_id)},os=function(e){return"".concat(e.data.label).concat(nt).concat(e.data.id)},Vr=function(e){return e.data.label},Wr=function(e){return e.data.id},Aa=function(e){return(0,X.uniq)(e.map(function(n){return n.split("|")}).flat().filter(function(n){return n&&n.length>0}))},ls=function(e,n){var a=new Map;e.forEach(function(i){var o=i.source,d=i.target,c=[o,d].sort(),y=c.join("-");if(a.has(y)){var S=a.get(y);S&&a.set(y,[].concat(Ne()(S),[i]))}else a.set(y,[i])});var r=[];return a.forEach(function(i,o){i.forEach(function(d,c){var y=d.source,S=d.target,M=Qr()(d,as),N=Aa(i.map(function(h){return h.reltype}));N.length>1?r.push(m()(m()({source:y,target:S},M),{},{style:m()(m()({},M.style),{},{label:{value:"MultipleLabels"}}),multiple:!0})):r.push(d)})}),r},Ou=function(e,n){var a=new Map;e.forEach(function(i){var o=i.source,d=i.target,c=[o,d].sort(),y=c.join("-");if(a.has(y)){var S=a.get(y);S&&a.set(y,[].concat(_toConsumableArray(S),[i]))}else a.set(y,[i])});var r=[];return a.forEach(function(i,o){console.log("processEdges: ",i,o);var d=uniqBy(i,"reltype");if(d.length>1){var c=_slicedToArray(i,1),y=c[0],S=y.source,M=y.target,N=_objectWithoutProperties(y,rs),h=Aa(i.map(function(p){return p.reltype})),w=Aa(i.map(function(p){return p.description||""}));console.log("Multiple edges: ",h,w),r.push(_objectSpread(_objectSpread({source:S,target:M},N),{},{reltype:h.join("|"),description:w.length>1?w.join("|"):w[0],relid:"MultipleLabels-".concat(S,"-").concat(M),style:_objectSpread(_objectSpread({},N.style),{},{label:{value:"MultipleLabels"}}),data:_objectSpread(_objectSpread({},N.data),{},{identity:"MultipleLabels-".concat(S,"-").concat(M),reltypes:h,relation_type:h.join("|")})}))}else r.push(i[0])}),r},Pu=function(e,n){var a=[];e.map(function(d){a=a.concat(Object.keys(d))});var r=[],i=uniq(a),o=filter(i,function(d){return n.indexOf(d)<0});return o.map(function(d){r.push({title:voca.titleCase(d),key:d,dataIndex:d,align:"center",ellipsis:!0})}),r},Hr=function(e){return e.map(function(n){return Kr(n)})},ka=function(e,n){var a={},r=Object.keys(e),i=(0,X.filter)(r,function(o){return n?n.indexOf(o)<0:!0});return i.forEach(function(o){["string","number","boolean"].indexOf(Rt()(e[o]))>=0&&(a[o]=e[o])}),a},Kr=function(e,n){var a=n!=null&&n.includes("metadata")?{}:{metadata:e};return e.data?m()(m()(m()({},ka(e.data,n)),ka(e,n)),a):m()(m()({},ka(e)),a)},ss=function(){return"<>"},zu=function(e,n,a,r){var i=ss();return e.indexOf(COMPOSED_ENTITY_DELIMITER)>=0?e:[e,n,a,r].join(i)},cs=function(e){var n=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;return n.test(e)},ta=function(e){if(!e)return[];var n=e.getNodes().filter(function(a){return a.hasState("selected")});return n.map(function(a){return a.getModel()})},ds=function(e){if(!e)return[];var n=e.getNodes();return n.map(function(a){return a.getModel()})},Jr={nodes:[],edges:[],isDirty:!1,currentUUID:"New Graph",layout:{}},$r=function(){var e=localStorage.getItem("presetGraphData");if(e)try{return JSON.parse(e)||{}}catch(n){return console.log("Error when parsing preset graph data: ",n),Jr}else return Jr},Zu=function(e){var n=$r(),a={nodes:uniqBy([].concat(_toConsumableArray(n.nodes),_toConsumableArray(e.nodes)),"id"),edges:uniqBy([].concat(_toConsumableArray(n.edges),_toConsumableArray(e.edges)),"relid")};Xr(a,!0,n.currentUUID,{})},us=function(e){localStorage.setItem("llmResponses",JSON.stringify(e))},hs=function(){var e=localStorage.getItem("llmResponses");if(e)try{return JSON.parse(e)||{}}catch(n){return console.log("Error when parsing llm responses: ",n),{}}else return{}},fs=function(){localStorage.removeItem("llmResponses")},Xr=function(e,n,a,r){if(!(!e||!e.nodes||e.nodes.length==0)){var i={nodes:e.nodes,edges:e.edges,isDirty:n,currentUUID:a,layout:r};localStorage.setItem("presetGraphData",JSON.stringify(i))}},qr=function(e,n,a,r){if(console.log("saveToLocalStorage: ",e,n,a,r),e.nodes.length>0){console.log("Graph Data Changed: ",e);var i=e.edges,o=e.nodes,d={data:{nodes:o,edges:i.map(function(c){return m()(m()({},c),{},{targetNode:void 0,sourceNode:void 0})})},isDirty:!1,currentUUID:"New Graph",layout:{width:n,height:a,matrix:r}};console.log("Graph Data Payload: ",d),Xr(d.data,d.isDirty,d.currentUUID,d.layout)}},gs=function(){localStorage.removeItem("presetGraphData")},na={type:"preset",options:void 0},aa=function(e){return e?e.cfg.group.getMatrix():{}},Oa=function(e,n){!e||!n||e.cfg.group.setMatrix(n)},ei={type:"force2",options:{animate:!0,preset:"random",linkDistance:100,nodeStrength:1e3,edgeStrength:10,preventOverlap:!0,nodeSize:30,nodeSpacing:10,minMovement:.5,maxIteration:1e3,clustering:!0,nodeClusterBy:"cluster",workerEnabled:!1,center:[1e3,1e3]}},Pa=function(e){return{nodes:e.nodes.map(function(n){return{id:n.id,name:n.data.name,label:n.data.label,description:n.data.description,xrefs:n.data.xrefs||"",synonyms:n.data.synonyms||""}}),edges:e.edges.map(function(n){return{source:n.source,target:n.target,reltype:n.reltype,reltype_desc:n.description||"",key_sentence:n.data.key_sentence||"",score:n.data.score||0,resource:n.data.resource||""}})}},ys=function(e,n){var a=[];return e.forEach(function(r){var i=r.source,o=r.target,d=n.find(function(y){return y.id===i}),c=n.find(function(y){return y.id===o});!d||!c||a.push(m()(m()({},r),{},{source_name:d.name,target_name:c.name,source_resource:d.resource,target_resource:c.resource,source_description:d.description,target_description:c.description}))}),a},za=g(26855),ps=g(37763),ms=g.n(ps),ti=g(89688),vs=g(75649);function Ss(l,e,n,a,r){for(var i=[],o=[{nodeId:l,path:[l]}],d=new Set([l]),c=new Set,y=function(){var M=o.shift(),N=M.nodeId,h=M.path;if(N===e){for(var w=h.map(function(F){var T=n.find(function(z){return z.id===F});return T?T.id:n[0].id}),p=[],u=function(T){var z=n.find(function(I){return I.id===h[T-1]}),C=n.find(function(I){return I.id===h[T]});if(z&&C){var j=a.find(function(I){return I.source===z.id&&I.target===C.id||I.source===C.id&&I.target===z.id});j?p.push(j.relid):p.push("")}},f=1;f<h.length;f++)u(f);var b=w.join(",")+":"+p.join(",");c.has(b)||(i.push({nodes:w,edges:p}),c.add(b))}else{var L=r.get(N)||[],D=Ht()(L),k;try{for(D.s();!(k=D.n()).done;){var U=k.value;d.has(U)||(d.add(U),o.push({nodeId:U,path:[].concat(Ne()(h),[U])}))}}catch(F){D.e(F)}finally{D.f()}}};o.length>0;)y();return i}function Ms(l,e,n,a,r){var i=[],o=[];function d(c){if(i.push(c),c===e)o.push({nodes:i.map(function(h){var w=n.find(function(p){return p.id===h});return w?w.id:n[0].id}),edges:i.slice(1).map(function(h,w){var p=n.find(function(b){return b.id===i[w]}),u=n.find(function(b){return b.id===h});if(p&&u){var f=a.find(function(b){return b.source===p.id&&b.target===u.id||b.source===u.id&&b.target===p.id});return f?f.relid:""}else return""})});else{var y=r.get(c)||[],S=Ht()(y),M;try{for(S.s();!(M=S.n()).done;){var N=M.value;!i.includes(N)&&i.length<=3&&d(N)}}catch(h){S.e(h)}finally{S.f()}}i.pop()}return d(l),o}var js=function(e){var n=(0,s.useState)(""),a=v()(n,2),r=a[0],i=a[1],o=(0,s.useState)(""),d=v()(o,2),c=d[0],y=d[1],S=s.useRef(null),M=s.useRef(null),N=(0,s.useContext)(He.Z),h=N.graph,w=(0,s.useState)({}),p=v()(w,2),u=p[0],f=p[1],b=(0,s.useState)({}),L=v()(b,2),D=L[0],k=L[1],U=(0,s.useState)(null),F=v()(U,2),T=F[0],z=F[1],C=(0,s.useState)(!1),j=v()(C,2),I=j[0],R=j[1],Q=(0,s.useState)([]),se=v()(Q,2),O=se[0],_=se[1],Ie=(0,s.useState)({}),me=v()(Ie,2),Ae=me[0],ge=me[1],it=(0,s.useState)(!1),ut=v()(it,2),ht=ut[0],Ge=ut[1],ft=function(P,A){var Z=m()({},Ae);Z[P]=A,ge(Z),localStorage.setItem("pathExplainingData",JSON.stringify(Z))},St=function(){var P=localStorage.getItem("pathExplainingData");if(P)try{ge(JSON.parse(P))}catch(A){ge({}),console.error("Failed to parse path explaining data from local storage",A)}};(0,s.useEffect)(function(){St()},[]),(0,s.useEffect)(function(){if(!(e.selectedNodes.length<=1)){var ue=e.selectedNodes[0].id,P=Ht()(e.selectedNodes),A;try{var Z=function(){var ye=A.value,le=ue+"_"+ye.id;if(!u[le]){var re=e.algorithm=="bfs"?Ss:Ms,we=re(e.selectedNodes[0].id,ye.id,e.nodes,e.edges,e.adjacencyList);f(function(ce){return m()(m()({},ce),{},Ee()({},le,we))}),k(function(ce){return m()(m()({},ce),{},Ee()({},le,e.algorithm))})}};for(P.s();!(A=P.n()).done;)Z()}catch($){P.e($)}finally{P.f()}}},[e.selectedNodes]),(0,s.useEffect)(function(){for(var ue=[],P=0,A=Object.keys(u);P<A.length;P++)for(var Z=A[P],$=0;$<u[Z].length;$++)ue.push({key:Z,index:$,path:u[Z][$].nodes.map(function(ye){var le=e.nodes.find(function(re){return re.id===ye});return le?le.data.name:"Unknown"}).join(" -> "),nsteps:u[Z][$].edges.length});_((0,X.uniqBy)((0,X.sortBy)(ue,["nsteps"]),"path"))},[u]);var Mt=function(P){var A=e.nodes.filter(function($){return P.nodes.includes($.id)}),Z=e.edges.filter(function($){return P.edges.includes($.relid)});return{nodes:A,edges:Z}},$e=function(P){gt();var A=P.some(function(re){return re.nodes.length>0});(P.length===0||!A)&&B.ZP.warning("No path found");var Z=Ne()(new Set(P.flatMap(function(re){return re.nodes}))),$=Ne()(new Set(P.flatMap(function(re){return re.edges}))),ye=h.getNodes();ye.forEach(function(re){var we=re.getModel();we.id&&!Z.includes(we.id)?h.setItemState(re,"inactive",!0):h.setItemState(re,"active",!0)});var le=h.getEdges();le.forEach(function(re){var we=re.getModel();we.relid&&!$.includes(we.relid)?h.setItemState(re,"inactive",!0):h.setItemState(re,"active",!0)})},gt=function(){var P=h.getNodes();P.forEach(function(Z){h.setItemState(Z,"inactive",!1)});var A=h.getEdges();A.forEach(function(Z){h.setItemState(Z,"inactive",!1)})},yt=function(P){var A=Ne()(new Set(P.flatMap(function(le){return le.nodes}))),Z=Ne()(new Set(P.flatMap(function(le){return le.edges}))),$=h.getNodes();$.forEach(function(le){var re=le.getModel();re.id&&!A.includes(re.id)?h.setItemState(le,"inactive",!1):h.setItemState(le,"active",!1)});var ye=h.getEdges();ye.forEach(function(le){var re=le.getModel();re.relid&&!Z.includes(re.relid)?h.setItemState(le,"inactive",!1):h.setItemState(le,"active",!1)})},jt=function(){f({}),e.onClosePathsFinder()},ae=function(P){R(!P)},ne=function(){if(e.selectedNodes.length<=1)return null;var P=e.selectedNodes[0].id;return e.selectedNodes.map(function(A){var Z=P+"_"+A.id;return(0,t.jsxs)("li",{className:D[Z],onMouseEnter:function(){$e(u[Z])},onMouseLeave:function(){yt(u[Z])},children:[(0,t.jsx)("span",{children:A.data.name}),"\xA0",(0,t.jsx)("span",{children:D[Z]==="bfs"?"BFS":"DFS"})]},Z)})},be=function(P,A,Z){A(),i(P[0]),y(Z)},Ye=function(P){P(),i("")},Be=function(P){return{filterDropdown:function(Z){var $=Z.setSelectedKeys,ye=Z.selectedKeys,le=Z.confirm,re=Z.clearFilters,we=Z.close;return(0,t.jsxs)("div",{style:{padding:8},onKeyDown:function(Ce){return Ce.stopPropagation()},children:[(0,t.jsx)(Jt.Z,{ref:S,placeholder:"Search ".concat(P),value:ye[0],onChange:function(Ce){return $(Ce.target.value?[Ce.target.value]:[])},onPressEnter:function(){return be(ye,le,P)},style:{marginBottom:8,display:"block"}}),(0,t.jsxs)(jn.Z,{children:[(0,t.jsx)(q.ZP,{type:"primary",onClick:function(){return be(ye,le,P)},icon:(0,t.jsx)(ti.Z,{}),size:"small",style:{width:90},children:"Search"}),(0,t.jsx)(q.ZP,{onClick:function(){return re&&Ye(re)},size:"small",style:{width:90},children:"Reset"}),(0,t.jsx)(q.ZP,{type:"link",size:"small",onClick:function(){le({closeDropdown:!1}),i(ye[0]),y(P)},children:"Filter"}),(0,t.jsx)(q.ZP,{type:"link",size:"small",onClick:function(){we()},children:"close"})]})]})},filterIcon:function(Z){return(0,t.jsx)(ti.Z,{style:{color:Z?"#1890ff":void 0}})},onFilter:function(Z,$){return $&&$[P]?$[P].toString().toLowerCase().includes(Z.toString().toLowerCase()):!1},onFilterDropdownOpenChange:function(Z){Z&&setTimeout(function(){var $;return($=S.current)===null||$===void 0?void 0:$.select()},100)},render:function(Z){return c===P?(0,t.jsx)(ms(),{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[r],autoEscape:!0,textToHighlight:Z?Z.toString():""}):Z}}},Xe=[m()({title:"Path",key:"path",align:"center",dataIndex:"path",width:300},Be("path")),{title:"Num of Steps",dataIndex:"nsteps",key:"nsteps",align:"center",width:150,sorter:function(P,A){return P.nsteps-A.nsteps},sortDirections:["descend","ascend"]},{title:"Action",key:"action",align:"center",fixed:"right",width:150,render:function(P,A,Z){return(0,t.jsxs)(jn.Z,{children:[(0,t.jsx)(q.ZP,{size:"small",type:"link",disabled:A.path===T,onClick:function(ye){var le=A.key,re=A.index,we=[u[le][re]];$e(we),z(A.path)},children:"Show"}),(0,t.jsx)(q.ZP,{size:"small",type:"link",onClick:function(ye){var le=A.key,re=A.index,we=Mt(u[le][re]);if(e.explainPath){var ce=Ae[A.path];if(ce){var Ce=Ne()(O);Ce[Z].description=ce,_(Ce)}else Ge(!0),console.log("Explain the path",A.path,we),e.explainPath({prompt_template_id:"explain_path_within_subgraph"},{subgraph_with_ctx:{context_str:A.path,subgraph:JSON.stringify(Pa(we))}}).then(function(ot){var xt=Ne()(O);xt[Z].description=ot.response,_(xt),ft(A.path,ce),Ge(!1),B.ZP.success("Explain the path successfully, you can click the `+` button before the path to see the explanation.",3)}).catch(function(ot){console.error("Failed to explain the path",ot),B.ZP.error("Failed to explain the path, please try again later."),Ge(!1)})}else za.ZP.open({type:"info",message:"Explain the Current Path",description:"Not opened yet (This function is using a LLM with knowledge graph to explain why the path would be believable)",duration:10})},children:"Explain"})]})}}];return(0,t.jsxs)("div",{className:"show-paths-panel",children:[(0,t.jsxs)("div",{className:"title",children:[(0,t.jsx)("h3",{children:"Paths Finder"}),(0,t.jsxs)("span",{children:[(0,t.jsx)(Pr.Z,{onClick:function(){return ae(I)}}),(0,t.jsx)(vs.Z,{onClick:jt})]})]}),(0,t.jsx)("ul",{className:"status-ul body",children:ne()}),I?(0,t.jsx)(_t,{title:"Path Table",onClose:function(){z(null),R(!1)},width:"600px",children:(0,t.jsx)(Vn.Z,{loading:ht,className:"path-table",rowKey:function(P){return"".concat(P.index,"-").concat(P.path)},columns:Xe,dataSource:O,ref:M,scroll:{y:200},size:"small",pagination:{simple:!0,defaultPageSize:1e3,position:["topLeft"],showTotal:function(P){return"Total ".concat(P," items")}},expandable:{expandedRowRender:function(P){return(0,t.jsx)(mn,{markdown:P.description||"Please click the `Explain` button to generate an explainable description for this path."})},rowExpandable:function(P){return P.description!==void 0},expandedRowKeys:O.filter(function(ue){return ue.description!==void 0}).map(function(ue){return"".concat(ue.index,"-").concat(ue.path)})}})}):null]})},xs=js,Et=g(83062),Ns=g(95658),Cs=g(89856),Is=g(43512),bs=g(98343),ws=g(83423),Ls=g(39224),Ts=g(61769),Ds=g(81510),Es=function(e){var n=(0,s.useContext)(He.Z),a=n.graph,r=n.apis,i=(0,s.useState)(!1),o=v()(i,2),d=o[0],c=o[1],y=(0,s.useState)([]),S=v()(y,2),M=S[0],N=S[1],h=function(u){console.log("handleNodeSelectorChange: ",u),u&&r.focusNodeById(u)},w=function(u){if(console.log("handleNodeSearch: ",u),c(!0),u){var f=[];a.getNodes().forEach(function(b){var L=b.getModel();console.log("handleNodeSearch: ",L),(L.label&&L.label.toLowerCase().includes(u.toLowerCase())||L.data.name&&L.data.name.toLowerCase().includes(u.toLowerCase()))&&f.push({label:"".concat(L.id," | ").concat(L.data.name),value:L.id})}),N(f),c(!1)}else N([]),c(!1)};return(0,t.jsxs)(_e.Z,{className:"node-searcher",children:[(0,t.jsxs)(Ns.Z,{children:[(0,t.jsx)(Et.Z,{title:"Undo",children:(0,t.jsx)(q.ZP,{shape:"circle",icon:(0,t.jsx)(Cs.Z,{}),onClick:function(){var u=a.getCustomUndoStack(),f=u.pop();console.log("NodeSearcherPanel- undoStack: ",u,f);var b=f==null?void 0:f.data,L=f==null?void 0:f.matrix;b&&(Oa(a,L),a.updateLayout({type:"preset"}),a.changeData(b,!1)),u.length===0&&(B.ZP.info("No more undo"),e.saveGraphDataFn&&e.saveGraphDataFn({nodes:[],edges:[]},a.getWidth(),a.getHeight(),aa(a)))}})}),(0,t.jsx)(Et.Z,{title:"Save to Local Storage",children:(0,t.jsx)(q.ZP,{shape:"circle",icon:(0,t.jsx)(Is.Z,{}),onClick:function(){qr(a.save(),a.getWidth(),a.getHeight(),aa(a)),B.ZP.success((0,t.jsx)("span",{children:"Your graph data has been saved to the local storage temporarily."}),5)}})}),(0,t.jsx)(Et.Z,{title:"Auto Zoom",children:(0,t.jsx)(q.ZP,{shape:"circle",icon:(0,t.jsx)(bs.Z,{}),onClick:function(){a&&a.pushCustomStack(),r&&r.handleAutoZoom()}})}),(0,t.jsx)(Et.Z,{title:"Zoom In",children:(0,t.jsx)(q.ZP,{shape:"circle",icon:(0,t.jsx)(ws.Z,{}),onClick:function(){a&&a.pushCustomStack(),r&&r.handleZoomOut()}})}),(0,t.jsx)(Et.Z,{title:"Zoom Out",children:(0,t.jsx)(q.ZP,{shape:"circle",icon:(0,t.jsx)(Ls.Z,{}),onClick:function(){a&&a.pushCustomStack(),r&&r.handleZoomIn()}})}),(0,t.jsx)(Et.Z,{title:"Fit Center",children:(0,t.jsx)(q.ZP,{shape:"circle",icon:(0,t.jsx)(Ts.Z,{}),onClick:function(){a&&a.pushCustomStack(),a&&a.fitCenter(!0)}})}),(0,t.jsx)(Et.Z,{title:"Download Graph As Image",children:(0,t.jsx)(q.ZP,{shape:"circle",icon:(0,t.jsx)(Ds.Z,{}),onClick:function(){var u=new Date().toISOString().replace(/:/g,"-");a&&a.downloadFullImage("knowledge-graph-".concat(u),"image/png",{backgroundColor:"#fff",padding:20})}})})]}),(0,t.jsx)(pe.default,{showSearch:!0,allowClear:!0,loading:d,defaultActiveFirstOption:!1,placement:"topRight",placeholder:"Search nodes",getPopupContainer:function(u){return u.parentNode},onSearch:w,onChange:h,options:M,filterOption:!1,notFoundContent:(0,t.jsx)(Oe.Z,{description:d?"Searching...":M!==void 0?"Not Found or Too Short Input":"Enter your interested node ..."})})]})},As=(0,s.memo)(Es),Ru=function(e,n,a){var r=n.getEdges();r.forEach(function(i){var o=i.getModel();o.source==e.id||o.target==e.id?n.showItem(i,!1):a&&n.hideItem(i,!1)})},_u=function(e,n,a){var r=n.getEdges();r.forEach(function(i){var o=i.getModel();o.source==e.id||o.target==e.id?n.hideItem(i,!1):a&&n.showItem(i,!1)})},Gu=function(e,n,a){if(e.length!=0){var r=n.getNodes();r.forEach(function(i){var o=i.getModel();e.includes(o.id)?n.hideItem(i,!1):a&&n.showItem(i,!1)})}},ks=function(e,n,a){if(e.length!=0){var r=n.getNodes();console.log("Show Selected Nodes: ",e,r),r.forEach(function(i){var o=i.getModel();e.includes(o.id)?n.showItem(i,!1):a&&n.hideItem(i,!1)})}},Os=function(e){var n=e.getNodes();n.forEach(function(a){e.showItem(a,!1)})},Ps=function(e){var n=e.getEdges();n.forEach(function(a){e.showItem(a,!1)})},Fu=function(e,n,a){if(e.length!=0){var r=n.getEdges();r.forEach(function(i){var o=i.getModel();e.includes(o.relid)?n.hideItem(i,!1):a&&n.showItem(i,!1)})}},zs=function(e,n,a){if(e.length!=0){var r=n.getEdges();r.forEach(function(i){var o=i.getModel();e.includes(o.relid)?n.showItem(i,!1):a&&n.hideItem(i,!1)})}},Zs=function(e){console.log("HighlightNodeEdge: ",e.selectedNodes);var n=(0,s.useContext)(He.Z),a=n.graph;if(e.selectedNodes.length>0?ks(e.selectedNodes,a,!0):Os(a),e.selectedEdges.length>0){var r=e.selectedEdges;zs(r,a,!0)}return e.selectedNodes.length==0&&e.selectedEdges.length==0&&Ps(a),null},Rs=(0,s.memo)(Zs),_s=Hn.Z.MiniMap,Gs=Hn.Z.SnapLine,ni=Hn.Z.Tooltip,ai=Hn.Z.Legend,Uu=Tt.Z.Panel,Fs=Dt.Z.ZoomCanvas,Us=Dt.Z.ActivateRelations,Ys=Dt.Z.ClickSelect,Bs=Dt.Z.Hoverable,Yu=Dt.Z.FitView,Bu=Dt.Z.DragNodeWithForce,Qu=Dt.Z.DragNode,Qs=Dt.Z.LassoSelect,Vs=Dt.Z.BrushSelect,Vu=Kn.Z.Menu,Ws={line:{stroke:"lightgreen",lineWidth:1}},Hs=function(e){var n,a,r=(0,s.useContext)(He.Z),i=r.graph,o=r.apis,d=e.item,c=e.chatbotVisible,y=e.onExplainRelationship,S=(0,s.useState)(!1),M=v()(S,2),N=M[0],h=M[1],w=(0,s.useState)(void 0),p=v()(w,2),u=p[0],f=p[1],b=(0,s.useState)(void 0),L=v()(b,2),D=L[0],k=L[1],U=(0,s.useState)(void 0),F=v()(U,2),T=F[0],z=F[1];(0,s.useEffect)(function(){if(d){var I=d.getModel(),R=i.findById(I.source).getModel(),Q=i.findById(I.target).getModel();R&&Q&&I&&(f(R),k(Q),z(I),h(!0))}else h(!1),f(void 0),k(void 0),z(void 0)},[]);var C=[{key:"show-edge-details",icon:(0,t.jsx)(Ta.Z,{}),title:"Show the details of the edge in different data sources. such as clinical data, omics data, and literatures. It will help us to understand the relationship between the two nodes.",label:"Show Edge Details"},{key:"hide-edges",icon:(0,t.jsx)(Jn.Z,{}),label:"Hide Edge(s)",children:[{key:"hide-current-edge",icon:(0,t.jsx)(Jn.Z,{}),title:"Hide the edge you selected.",label:"Hide Current Edge"},{key:"hide-edges-with-same-type",icon:(0,t.jsx)(Jn.Z,{}),title:"Hide the edges which have the same type with the edge you selected. It will help us to focus on the specific type of the edges.",label:"Hide Edges with the Same Type"}]},{key:"explain-relationship",icon:(0,t.jsx)($n.Z,{}),title:"Using ChatGPT & Literatures to explain the relationship between the two nodes.",disabled:((n=e.prompts)===null||n===void 0?void 0:n.length)==0,label:"Explain Relationship (Experimental)",children:(a=e.prompts)===null||a===void 0?void 0:a.map(function(I){return{key:I.key,icon:(0,t.jsx)($n.Z,{}),label:I.label}})},{key:"analyze-with-clinical-data",icon:(0,t.jsx)(Fl.Z,{}),disabled:!0,label:"Analyze with Clinical Data",title:"Analyze the relationship between the two nodes with clinical data. It will help us to understand the relationship between the two nodes in the context of clinical data."},{key:"analyze-with-omics-data",icon:(0,t.jsx)(Da.Z,{}),disabled:!0,label:"Analyze with Omics Data",title:"Analyze the relationship between the two nodes with omics data. It will help us to understand the relationship between the two nodes in the context of omics data."}];c&&C.push({key:"ask-question",icon:(0,t.jsx)(Xn.Z,{}),label:"Ask Chatbot",hidden:!1,children:[{key:"what-is-the-relationship",icon:(0,t.jsx)(Ea.Z,{}),label:"What is the relationship between the two nodes?"}]});var j=function(R){var Q=C.filter(function(_){return _.children}).map(function(_){return _.children}).flat(),se=C.filter(function(_){return!_.children}),O=se.find(function(_){return _.key===R})||Q.find(function(_){return _?_.key===R:!1});console.log("EdgeMenu: ",R,O),O?O.handler&&T?O.handler(T):e.onChange&&u&&D&&T&&i&&o&&(["hide-current-edge","hide-edges-with-same-type"].includes(R)&&i.pushCustomStack(),e.onChange(O,u,D,T,i,o)):B.ZP.warning("Cannot catch the changes.")};return N?(0,t.jsx)("div",{children:(0,t.jsx)(Cn.Z,{items:C.filter(function(I){return!I.hidden}),onClick:function(R){j(R.key),h(!1)},getPopupContainer:function(R){return R.parentNode||document.body}})}):null},Ks=function(e){var n,a,r,i,o=(0,s.useContext)(He.Z),d=o.graph,c=o.apis,y=e.item,S=e.chatbotVisible,M=(0,s.useState)(!1),N=v()(M,2),h=N[0],w=N[1];console.log("NodeMenu",e.item);var p=(0,s.useState)(void 0),u=v()(p,2),f=u[0],b=u[1],L=function(){return d.getNodes().filter(function(T){return T.hasState("selected")}).length};(0,s.useEffect)(function(){if(y&&y._cfg){var F=y.getModel();b(F),w(!0)}else w(!1),b(void 0)},[]);var D=[{key:"show-node-details",icon:(0,t.jsx)(Ta.Z,{}),label:"Show Node Details",title:"Show the node in different data sources. such as clinical data, omics data, and literature."},{key:"find-related-nodes",icon:(0,t.jsx)(Ul.Z,{}),label:"Find Key Nodes",children:[{key:"find-similar-nodes",icon:(0,t.jsx)(Da.Z,{}),hidden:!0,label:"Find Similar Nodes"},{key:"expand-selected-nodes",hidden:!0,icon:(0,t.jsx)(Rr.Z,{}),label:"Expand Selected Nodes"},{key:"predict-relationships",hidden:!0,icon:(0,t.jsx)(Yl.Z,{}),label:"Predict Relationships"},{key:"expand-one-step",icon:(0,t.jsx)(Bl.Z,{}),label:"Expand One Step",disabled:L()!==1&&!h},{key:"find-shared-nodes",icon:(0,t.jsx)(Ea.Z,{}),label:"Find Shared Nodes",disabled:L()<=1},{key:"expand-all-paths",hidden:!1,icon:(0,t.jsx)(qn.Z,{}),disabled:L()!==2,label:"Find Paths (Within 2 Steps)",children:[{key:"expand-all-paths-1",icon:(0,t.jsx)(qn.Z,{}),label:"Within 1 Step"},{key:"expand-all-paths-2",icon:(0,t.jsx)(qn.Z,{}),label:"Within 2 Steps"}]}]},{key:"select-nodes",icon:(0,t.jsx)(Ql.Z,{}),label:"(Un)Select / Delete Node(s)",title:"Select, Reverse Select, or delete the node(s) in the graph.",children:[{key:"hide-selected-nodes",icon:(0,t.jsx)(Jn.Z,{}),label:"Hide Selected Node(s)"},{key:"reverse-selected-nodes",icon:(0,t.jsx)(Vl.Z,{}),label:"Reverse Selected Nodes",handler:function(T){d.getNodes().forEach(function(z){z.hasState("selected")?d.setItemState(z,"selected",!1):d.setItemState(z,"selected",!0)}),T&&d.setItemState(T.id,"selected",!1),w(!1)}},{key:"delete-nodes",icon:(0,t.jsx)(Wl.Z,{}),label:"Delete Selected Node(s)",danger:!0}]},{key:"visulize-similarities",icon:(0,t.jsx)(Zr.Z,{}),title:"Visualize the similarities between the nodes. It will help us to understand the importance of the nodes for a given node.",disabled:!0,label:"Visualize Similarities"},{key:"explain-node",icon:(0,t.jsx)(Gr.Z,{}),title:"Using ChatGPT to explain the node.",disabled:((n=e.nodePrompts)===null||n===void 0?void 0:n.length)==0,label:"Explain Node (Experimental)",children:(a=e.nodePrompts)===null||a===void 0?void 0:a.map(function(F){return{key:F.key,icon:(0,t.jsx)(Gr.Z,{}),label:F.label}})},{key:"explain-subgraph",icon:(0,t.jsx)($n.Z,{}),title:"Using ChatGPT to explain the subgraph in the context of the selected node.",label:"Explain Subgraph (Experimental)",disabled:((r=e.subgraphPrompts)===null||r===void 0?void 0:r.length)==0,children:(i=e.subgraphPrompts)===null||i===void 0?void 0:i.map(function(F){return{key:F.key,icon:(0,t.jsx)($n.Z,{}),label:F.label}})}];S&&D.push({key:"ask-question",icon:(0,t.jsx)(Xn.Z,{}),label:"Ask Chatbot",children:[{key:"what-is-the-node",icon:(0,t.jsx)(Ta.Z,{}),label:"What is the node?"}]});var k=function(T){var z=D.filter(function(R){return R.children}).map(function(R){return R.children}).flat(),C=z.filter(function(R){return R.children}).map(function(R){return R.children}).flat(),j=D.filter(function(R){return!R.children});console.log("NodeMenu: ",z,C,j);var I=j.find(function(R){return R.key===T})||z.find(function(R){return R?R.key===T:!1})||C.find(function(R){return R?R.key===T:!1});console.log("NodeMenu: ",T,I),I?I.handler&&f?I.handler(f):e.onChange&&f&&d&&c?e.onChange(I,f,d,c):B.ZP.warning("Cannot catch the changes."):(console.log("Cannot find the menu item: ",T,D),B.ZP.warning("Cannot catch the changes."))},U=D.map(function(F){if(F.children){var T=m()(m()({},F),{},{children:F.children.filter(function(z){return!z.hidden})});return T.children.length==0?m()(m()({},T),{},{hidden:!0}):T}else return F.hidden?m()(m()({},F),{},{hidden:!0}):F});return h?(0,t.jsx)(Cn.Z,{items:U.filter(function(F){return!F.hidden}),onClick:function(T){console.log("NodeMenu onClick: ",T,f),k(T.key),w(!1)},getPopupContainer:function(T){return T.parentNode||document.body}}):null},Js=function(e){var n=(0,s.useContext)(He.Z),a=n.graph,r=n.contextmenu,i=n.apis,o=r.canvas,d=function(f){if(a.getNodes().length==0){B.ZP.warning("No data to download");return}a.downloadFullImage("canvas","image/png",{backgroundColor:"#fff",padding:10})},c=function(f){var b=Ar(a);if(b.data.nodes.length==0){B.ZP.warning("No data to download");return}var L={payload:b,name:"shared-graph",description:"Shared graph"},D=new Blob([JSON.stringify(L)],{type:"application/json"}),k=document.createElement("a");k.href=URL.createObjectURL(D),k.download="graph.json",k.click()},y=function(f){e.onCanvasClick&&e.onCanvasClick(f,a,i)},S=function(f){a.clear(),e.onClearGraph?(e.onClearGraph(),B.ZP.info("Clear canvas successfully")):B.ZP.warning("Cannot clear canvas")},M=function(f){B.ZP.info("Stop animatition successfully"),a.stopAnimate();var b=a.getEdges();b.forEach(function(L){var D;a.updateItem(L,{style:m()(m()({},(D=L.getModel())===null||D===void 0?void 0:D.style),{},{animate:!1})},!1)})},N=function(f){e.handleOpenFishEye&&e.handleOpenFishEye()},h=function(f){var b=a.getNodes();b.forEach(function(D){a.setItemState(D,"inactive",!1),a.setItemState(D,"active",!1),a.showItem(D,!0)});var L=a.getEdges();L.forEach(function(D){a.setItemState(D,"inactive",!1),a.setItemState(D,"active",!1),a.showItem(D,!0)}),B.ZP.success("Clear node/edge status successfully"),e.onCanvasClick&&e.onCanvasClick(f,a,i)},w=[{key:"auto-connect",icon:(0,t.jsx)(xn.Z,{}),label:"Auto Connect Graph",title:"Auto connect the graph based on the current graph data. It will help us to find the potential relationships between the nodes. [NOTE] It may mess up the current graph layout.",handler:y},{key:"stop-animate",icon:(0,t.jsx)(xn.Z,{}),label:"Stop & Clear Animatition",title:"Stop and clear the animation of the graph.",handler:M},{key:"refresh-graph",icon:(0,t.jsx)(Hl.Z,{}),label:"Refresh Graph",handler:function(f){a.layout(),a.refreshPositions(),h(f),B.ZP.success("Refresh graph successfully")}},{key:"enable-fish-eye",icon:(0,t.jsx)(Kl.Z,{}),label:"Enable FishEye",handler:N},{key:"download-data",icon:(0,t.jsx)(Jl.Z,{}),label:"Download Graph Data",title:"Download the graph data as a JSON file. It will help us to share the graph data with others.",handler:c},{key:"download-canvas",icon:(0,t.jsx)(_r.Z,{}),label:"Save As Image",handler:d},{key:"clear-node-edge-status",icon:(0,t.jsx)(Fr.Z,{}),danger:!0,title:"Clear the status of the nodes and edges. It will help us to reset the status of the nodes and edges. If you found some nodes or edges are not shown, you can try this function.",label:"Clear Node/Edge Status",handler:h},{key:"clear-canvas",icon:(0,t.jsx)(Fr.Z,{}),label:"Clear Current Subgraph",danger:!0,handler:S}],p=function(f){var b=w.find(function(L){return L.key===f});b?b.handler?b.handler(b):console.log("Cannot find the handler function for the menu item: ",b):(console.log("Cannot find the menu item: ",f,w),B.ZP.warning("Cannot catch the changes."))};return(0,t.jsx)(Cn.Z,{items:w.filter(function(u){return!u.hidden}),onClick:function(f){p(f.key),o.handleClose()},getPopupContainer:function(f){return f.parentNode||document.body}})},ri=function(e){var n=e.bindType,a=e.disabled,r=(0,s.useContext)(He.Z),i=r.graph,o=(0,s.useState)(!1),d=v()(o,2),c=d[0],y=d[1];return(0,t.jsx)(Bs,{bindType:n,disabled:c||a})},$s=function(e){var n=e.visible,a=(0,s.useContext)(He.Z).graph;return(0,s.useEffect)(function(){a.getNodes().forEach(function(r){var i;a.updateItem(r,{style:{label:m()(m()({},(i=r.getModel())===null||i===void 0||(i=i.style)===null||i===void 0?void 0:i.label),{},{visible:n})}},!1)})},[n]),null},Xs=function(e){var n=e.visible,a=(0,s.useContext)(He.Z).graph;return(0,s.useEffect)(function(){a.getEdges().forEach(function(r){var i;a.update(r,{style:{label:m()(m()({},(i=r.getModel())===null||i===void 0||(i=i.style)===null||i===void 0?void 0:i.label),{},{opacity:n?1:0,visible:n})}},!1)})},[n]),null},ii=function(e){var n=(0,s.useContext)(He.Z),a=n.graph,r=n.apis;return(0,s.useEffect)(function(){e.queriedId&&e.mode=="focus"&&r.focusNodeById(e.queriedId);var i=function(d){var c=d.item,y=c.getModel();e.mode=="focus"&&r.focusNodeById(y.id),e.onClickNode&&e.onClickNode(c.getModel())};return a.on("node:click",i),function(){a.off("node:click",i)}},[]),null},qs=function(e){var n=(0,s.useContext)(He.Z),a=n.graph,r=n.apis;return(0,s.useEffect)(function(){var i=function(d){if(e.onClick){var c=d.item,y=c.getModel();e.onClick(y.id,y)}};return a.on("node:click",i),function(){a.off("node:click",i)}},[]),null},ec=function(e){var n=(0,s.useContext)(He.Z),a=n.graph,r=n.apis;return(0,s.useEffect)(function(){var i=function(d){if(e.onClick){var c=d.item,y=c.getModel(),S=a.findById(y.source).getModel(),M=a.findById(y.target).getModel();e.onClick(y.relid,S,M,y)}};return a.on("edge:click",i),function(){a.off("edge:click",i)}},[]),null},oi={autoPin:!1,nodeLabelVisible:!0,edgeLabelVisible:!0,nodeTooltipEnabled:!0,edgeTooltipEnabled:!1,interactiveMode:"select-nodes",selectionMode:"brush-select",miniMapEnabled:!0,snapLineEnabled:!0,infoPanelEnabled:!0},tc=function(e){var n,a,r=e.data,i=e.style,o=e.onNodeMenuClick,d=e.onEdgeMenuClick,c=e.selectedNodes,y=e.onCanvasMenuClick,S=e.selectedEdges,M=e.settings,N=(0,s.useState)(!1),h=v()(N,2),w=h[0],p=h[1],u=(0,s.useState)(!1),f=v()(u,2),b=f[0],L=f[1],D=s.useState(na),k=v()(D,2),U=k[0],F=k[1],T=(0,s.useState)(null),z=v()(T,2),C=z[0],j=z[1],I=(0,s.useState)(null),R=v()(I,2),Q=R[0],se=R[1],O=(0,s.useState)([]),_=v()(O,2),Ie=_[0],me=_[1],Ae=(0,s.useState)({}),ge=v()(Ae,2),it=ge[0],ut=ge[1],ht=(0,s.useState)([]),Ge=v()(ht,2),ft=Ge[0],St=Ge[1],Mt=(0,s.useState)([]),$e=v()(Mt,2),gt=$e[0],yt=$e[1],jt=(0,s.useState)([]),ae=v()(jt,2),ne=ae[0],be=ae[1],Ye=(0,s.useState)(new $l.Stack(50)),Be=v()(Ye,2),Xe=Be[0],ue=Be[1],P=(0,s.useState)(null),A=v()(P,2),Z=A[0],$=A[1],ye=(0,s.useState)(0),le=v()(ye,2),re=le[0],we=le[1],ce=(0,s.useState)(0),Ce=v()(ce,2),ot=Ce[0],xt=Ce[1],lt=(0,s.useState)(r),Fe=v()(lt,2),Ga=Fe[0],oa=Fe[1],Se=s.useRef(null),Ln=function(E){return E!=null&&Rt()(E)==="object"},Zi=function de(E,V){var W=Object.keys(E),te=Object.keys(V);if(W.length!==te.length)return console.log("The data are different: ",W,te),!1;for(var Me=0,De=W;Me<De.length;Me++){var fe=De[Me],ie=E[fe],je=V[fe];if(fe==="x"||fe==="y"){if(Math.abs(ie-je)>2)return console.log("The data are different: ",W,te,ie,je),!1}else{var ke=Ln(ie)&&Ln(je);if(ke&&!de(ie,je)||!ke&&ie!==je)return console.log("The data are different: ",W,te,fe,ie,je),!1}}return!0},la=function(E,V){var W=new Map(E.nodes.map(function(Le){return[Le.id,Le]})),te=new Map(E.edges.map(function(Le){return[Le.relid,Le]})),Me=new Set(V.nodes.map(function(Le){return Le.id})),De=new Set(V.edges.map(function(Le){return Le.relid})),fe=V.nodes.filter(function(Le){return!W.has(Le.id)}),ie=V.edges.filter(function(Le){return!te.has(Le.relid)}),je=E.nodes.filter(function(Le){return!Me.has(Le.id)}),ke=E.edges.filter(function(Le){return!De.has(Le.relid)}),st=E.nodes.filter(function(Le){return!je.some(function(ct){return ct.id===Le.id})}).concat(fe),Ct=E.edges.filter(function(Le){return!ke.some(function(ct){return ct.relid===Le.relid})}).concat(ie);return{data:{nodes:st,edges:Ct},addedData:{nodes:fe,edges:ie},subtractedData:{nodes:je,edges:ke}}},Re=function(E){var V=E.item.get("model");V.fx=E.x,V.fy=E.y},Nt=function(E){},sa=function(E){var V,W=(V=Se.current)===null||V===void 0?void 0:V.graph;W&&$(aa(W))},Xt=function(E){E.preventDefault(),E.stopPropagation(),E.delegateTarget&&en(E)},sn=function(E){(E.ctrlKey||E.metaKey)&&E.key==="s"&&(E.preventDefault(),B.ZP.success("Your graph data has been saved successfully."),Ut())},ca=function(){if(Se&&Se.current&&Se.current.graph){var E=Se.current.graph,V=function(ie){j(ie.item)},W=function(ie){se(ie.item)};if(E.on("edge:contextmenu",V),E.on("node:contextmenu",W),E.on("node:drag",Re),E.on("canvas:drag",function(fe){return Nt}),E.on("canvas:dragend",sa),E.on("node:dragstart",Xt),E.on("canvas:dragstart",Xt),typeof window!="undefined"){var te,Me=Se==null||(te=Se.current)===null||te===void 0?void 0:te.graphDOM;window.onresize=function(){!E||E.get("destroyed")||!Me||!Me.scrollWidth||!Me.scrollHeight||(console.log("window.onresize: ",Me.scrollWidth,Me.scrollHeight),(0,X.debounce)(function(){E.changeSize(Me.scrollWidth,Me.scrollHeight)},500))}}var De=function(ie){ie.preventDefault(),ie.returnValue="",console.log("handleBeforeUnload: ",ie),Ut()};return window.addEventListener("keydown",sn),function(){E.off("edge:contextmenu",V),E.off("node:contextmenu",W),E.off("node:drag",Re),E.off("canvas:drag",function(){}),E.off("canvas:dragend",sa),E.off("node:dragstart",Xt),E.off("canvas:dragstart",Xt),window.removeEventListener("keydown",sn),window.onresize=null}}},Ft=function(E){var V=E.nodes.filter(function(W){return W.x&&W.y});return V.length/E.nodes.length>.8},Fa=(0,X.debounce)(function(){console.log("Save the graph data to the local storage: ",new Date),Ut()},2e3),Ut=function(){if(console.log("saveGraphData: ",e.onDataChanged),e.onDataChanged){var E,V,W,te;e.onDataChanged((E=Se.current)===null||E===void 0?void 0:E.graph.save(),(V=Se.current)===null||V===void 0?void 0:V.graphDOM.clientWidth,(W=Se.current)===null||W===void 0?void 0:W.graphDOM.clientHeight,(te=Se.current)===null||te===void 0?void 0:te.graph.cfg.group.getMatrix())}},cn=function(E){var V=E.map(function(fe){return[fe.source,fe.target]}),W=V.flat(),te=W.reduce(function(fe,ie){return fe[ie]=(fe[ie]||0)+1,fe},{}),Me=Math.max.apply(Math,Ne()(Object.values(te))),De=Object.keys(te).find(function(fe){return te[fe]===Me});return De},Ua=function(E,V){var W,te=(W=Se.current)===null||W===void 0?void 0:W.graph,Me={};V.nodes.forEach(function(qe){Me[qe.id]=qe});var De=0,fe=0,ie=cn(E.edges);if(ie){var je=Me[ie];console.log("refreshAddedNodePosition: find the most frequent node: ",je,ie,E),je&&(De=je.x||0,fe=je.y||0)}if(!De||!fe){var ke=te==null?void 0:te.getGraphCenterPoint();console.log("refreshAddedNodePosition: ",ke,E.nodes),De=ke==null?void 0:ke.x,fe=ke==null?void 0:ke.y}var st=180,Ct=st/(E.nodes.length-1),Le=0,ct=200;De&&fe&&(E.nodes.forEach(function(qe,tn){if(!qe.x||!qe.y){var Yt=(Le+Ct*tn)*(Math.PI/180),Bt={x:De+ct*Math.cos(Yt),y:fe+ct*Math.sin(Yt)};te==null||te.updateItem(qe.id,{x:Bt.x,y:Bt.y},!1)}}),E.edges.forEach(function(qe){te==null||te.updateItem(qe.id,{style:m()(m()({},i),{},{animate:{type:"circle-running",color:"green",repeat:!0,duration:2e3}})},!1)}))},Ya=function(){if(Se.current&&Se.current.graph&&Se.current.graphDOM){var E=Se.current.graphDOM,V=Se.current.graph,W=E.clientWidth,te=E.clientHeight;console.log("changeGraphSize: ",W,te,V,E),V.changeSize(W,te)}},dn=function(){p(!0)},qt=function(){p(!1)},da=function(E){me(function(V){return[].concat(Ne()(V),[E])})},en=function(E){var V,W=(V=Se.current)===null||V===void 0?void 0:V.graph,te=W==null?void 0:W.getCustomUndoStack(),Me=W==null?void 0:W.save(),De=W==null?void 0:W.getWidth(),fe=W==null?void 0:W.getHeight(),ie=aa(W),je=(0,X.cloneDeep)({data:Me,matrix:ie,width:De,height:fe});console.log("pushUndoStack: ",je,E,Rt()(E)),te&&je.data&&te.push(je),we(De),xt(fe),$(ie),oa(Me)},Ba=function(){me([])},ua=function(E){var V=E.data,W=E.style,te=(0,s.useContext)(He.Z),Me=te.graph,De=te.apis,fe=m()({width:"300px"},W),ie=(0,s.useState)(["0"]),je=v()(ie,2),ke=je[0],st=je[1],Ct=(0,s.useState)([]),Le=v()(Ct,2),ct=Le[0],qe=Le[1],tn=function(et){console.log("HoverText: ",et,ke),typeof et=="string"&&(et=[et]),st(et)},Yt=function(et){var Ue=function(Ve){return["source_id","target_id","id","label"].includes(Ve)},It=function(Ve,dt){var Tn=Mn(dt);if(Ue(Ve)&&Tn)return(0,t.jsx)("a",{href:Tn,target:"_blank",children:dt});if(Ve=="pmids"){if(dt){var Dn="".concat(dt).split("|");return Dn.map(function(bt){return(0,t.jsx)("a",{href:"https://pubmed.ncbi.nlm.nih.gov/".concat(bt),target:"_blank",children:bt})})}}else if(Ve=="taxid"){if(dt)return jl(dt)}else return Ve=="score"&&typeof dt=="number"?dt.toFixed(2):dt};console.log("HoverText: ",et);var Qe=Kr(et,["comboId","degree","depth","layoutOrder","x","fx","y","fy","type","category","nlabel","identity","mass","metadata","multiple","relid","reltype","source","target","id"]),nn=Object.keys(Qe).sort().map(function(pt){var Ve=Qe[pt];return Ve?(0,t.jsx)(ea.Z.Item,{label:at.Z.titleCase(pt.replace(/_/g," ")),style:{height:"50px",overflowY:"scroll"},children:It(pt,Ve)},Math.random()):null});return nn.length>0?(0,t.jsx)(ea.Z,{size:"small",column:1,title:null,bordered:!0,style:fe,children:nn},Math.random()):(0,t.jsx)("span",{style:W,children:"No Properties"})};return(0,s.useEffect)(function(){if(V.multiple){var Bt=Me.getEdges(),et=Bt.filter(function(Qe){return Qe.getModel().source==V.source&&Qe.getModel().target==V.target||Qe.getModel().source==V.target&&Qe.getModel().target==V.source}),Ue=(0,X.sortBy)(et,function(Qe){return Qe.getModel().reltype}),It=Ue.map(function(Qe,nn){var pt,Ve;return{key:nn.toString(),label:(0,t.jsxs)("span",{children:[Qe.getModel().reltype,(0,t.jsx)("br",{}),"[",(pt=Qe.getModel().data)===null||pt===void 0?void 0:pt.source_id," -> ",(Ve=Qe.getModel().data)===null||Ve===void 0?void 0:Ve.target_id,"]"]}),children:Yt(Qe.getModel())}});qe(It)}},[V]),V.multiple?ct.length>0?(console.log("HoverText - multiple: ",V,ct),(0,t.jsx)(Tt.Z,{defaultActiveKey:["0"],items:ct,accordion:!0,onChange:tn,activeKey:ke})):(0,t.jsx)("span",{style:W,children:"No Properties"}):Yt(V)},Qa=function(E,V){console.log(E,V)},un=function(E){if(F(m()(m()({},U),E)),Se.current){var V=Se.current.graph;V.updateLayout(m()(m()({type:E.type},E.options),{},{center:[0,0]})),console.log("changeLayout: ",E),V.layout()}};return(0,s.useEffect)(function(){var de;ca();var E=(de=Se.current)===null||de===void 0?void 0:de.graph;E&&(E.getCustomUndoStack=function(){return Xe},E.pushCustomStack=en)},[]),(0,s.useEffect)(function(){e.layout&&(un(e.layout),en("layoutChanged"))},[e.layout]),(0,s.useEffect)(function(){if(e.prompts){var de=e.prompts.filter(function(W){return W.type=="node"}),E=e.prompts.filter(function(W){return W.type=="edge"}),V=e.prompts.filter(function(W){return W.type=="subgraph"});St(de),yt(E),be(V)}},[e.prompts]),(0,s.useEffect)(function(){me([])},[M.interactiveMode]),(0,s.useEffect)(function(){if(r.nodes.length>0){var de=new Map,E=Ht()(r.nodes),V;try{for(E.s();!(V=E.n()).done;){var W=V.value;de.set(W.id,[])}}catch(st){E.e(st)}finally{E.f()}var te=Ht()(r.edges),Me;try{for(te.s();!(Me=te.n()).done;){var De=Me.value;de.get(De.source).push(De.target),de.get(De.target).push(De.source)}}catch(st){te.e(st)}finally{te.f()}if(ut(de),Se.current){var fe,ie=Se.current.graph,je=ie.save();console.log("GraphinWrapper: ",je,r,Ft(je),Ft(r),ie.getGraphCenterPoint(),ie.getDefaultCfg(),ie.getMinZoom(),ie.getMaxZoom());var ke=la(je,r);(ke.addedData.nodes.length>0||ke.subtractedData.edges.length>0)&&en("dataChanged"),!Ft(je)&&!Ft(r)?un(ei):(console.log("Use the preset layout: ",na,e.layout,U),un(na)),ie.data(ke.data),ie.render(),!Ft(je)&&!Ft(r)&&(console.log("This is default layout, so we need to move the graph to the center."),ie.refreshPositions(),ie.fitCenter()),(fe=e.layout)!==null&&fe!==void 0&&fe.matrix&&(console.log("Set the matrix for the layout: ",e.layout.matrix),Oa(ie,e.layout.matrix)),Z&&(console.log("Set the internal matrix for the layout: ",Z),Oa(ie,Z)),console.log("GraphinWrapper addData: ",ke,r,je,ie.getNodes(),ie.getEdges()),ke.addedData.nodes.length>0&&je.nodes.length>0&&Ua(ke.addedData,r)}}},[r]),(0,t.jsxs)(_l.ZP,{ref:Se,layoutCache:!1,enabledStack:!1,animate:!0,data:{},layout:{},style:i,maxStep:50,willUnmount:function(){var E;(e.data.nodes.length>0||((E=Se.current)===null||E===void 0||(E=E.graph)===null||E===void 0?void 0:E.getNodes().length)>0)&&(console.log("GraphinWrapper will unmount, so we need to save the graph data."),qr(Ga,re,ot,Z))},children:[(0,t.jsx)(Fs,{}),M.selectionMode=="lasso-select"?(0,t.jsx)(Qs,{}):null,M.selectionMode=="brush-select"?(0,t.jsx)(Vs,{}):null,(0,t.jsx)($s,{visible:M.nodeLabelVisible}),(0,t.jsx)(Xs,{visible:M.edgeLabelVisible}),(0,t.jsx)(Gl.Z,{options:{},visible:w,handleEscListener:qt}),(0,t.jsx)(Rs,{selectedNodes:c||[],selectedEdges:S||[]}),M.interactiveMode=="show-paths"?(0,t.jsx)(ri,{bindType:"node"}):null,M.interactiveMode=="show-paths"?(0,t.jsx)(ri,{bindType:"edge"}):null,M.interactiveMode=="show-paths"?(0,t.jsx)(Us,{}):null,(0,t.jsx)(Kn.Z,{style:{width:"160px"},bindType:"node",children:(0,t.jsx)(Ks,{nodePrompts:ft,subgraphPrompts:ne,chatbotVisible:e.chatbotVisible,item:Q,onChange:function(E,V,W,te){se(null),o&&o(E,V,W,te)}})}),(0,t.jsx)(Kn.Z,{style:{width:"160px"},bindType:"canvas",children:(0,t.jsx)(Js,{handleOpenFishEye:dn,onCanvasClick:function(E,V,W){se(null),j(null),y&&y(E,V,W)},onClearGraph:e.onClearGraph})}),(0,t.jsx)(Kn.Z,{style:{width:"160px"},bindType:"edge",children:(0,t.jsx)(Hs,{prompts:gt,item:C,chatbotVisible:e.chatbotVisible,onChange:function(E,V,W,te,Me,De){j(null),E.key=="explain-relationship"&&(j(te),L(!0)),d&&d(E,V,W,te,Me,De)}})}),(0,t.jsx)(ai,{bindType:"node",sortKey:"nlabel",children:function(E){return console.log("renderProps",E),(0,t.jsx)(ai.Node,m()(m()({},E),{},{onChange:Qa}))}}),(0,t.jsx)(As,{saveGraphDataFn:e.onDataChanged,changeSelectedEdges:e.changeSelectedEdges,changeSelectedNodes:e.changeSelectedNodes}),M.interactiveMode=="show-paths"?(0,t.jsx)(ii,{queriedId:e.queriedId,onClickNode:da,mode:"focus"}):null,M.interactiveMode=="select-nodes"?(0,t.jsx)(ii,{queriedId:e.queriedId,onClickNode:da,mode:"select"}):null,M.interactiveMode=="show-paths"?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(xs,{selectedNodes:Ie,nodes:r.nodes,edges:r.edges,onClosePathsFinder:Ba,adjacencyList:it,algorithm:r.edges.length>1e3?"bfs":"dfs",explainPath:e.askLlmFn})}):null,C&&b?(0,t.jsx)(_t,{onClose:function(){L(!1)},children:(0,t.jsxs)("p",{children:["TODO: generate explanations for the current edge",(0,t.jsx)("br",{}),"1. Get the current edge, the source node and target node",(0,t.jsx)("br",{}),"2. Send the source node and target node to the backend and get the prompt (markdown format) which contains the prompt and api codes for retrieving context information",(0,t.jsx)("br",{}),"3. Send the markdown to the backend and get the filled markdown",(0,t.jsx)("br",{}),"4. Send the filled markdown to LLM and generate explanations by using `rethinking with retrieval` method",(0,t.jsx)("br",{}),"5. Show the filled markdown in the explanation panel",(0,t.jsx)("br",{})]})}):null,M.interactiveMode=="select-nodes"?(0,t.jsx)(Ys,{multiple:!0,trigger:"shift"}):null,M.interactiveMode=="show-details"?(0,t.jsx)(qs,{onClick:e.onClickNode}):null,M.interactiveMode=="show-details"?(0,t.jsx)(ec,{onClick:e.onClickEdge}):null,M.nodeTooltipEnabled?(0,t.jsx)(ni,{bindType:"node",placement:"bottom",style:{opacity:.9},children:function(E){if(E.model){var V=E.model;return(0,t.jsx)(ua,{data:V,style:{padding:"10px",width:"fit-content",maxWidth:"400px"}})}return null}}):null,M.edgeTooltipEnabled?(0,t.jsx)(ni,{bindType:"edge",placement:"bottom",style:{opacity:.9},children:function(E){if(E.model){var V=E.model;return(0,t.jsx)(ua,{data:V,style:{padding:"10px",width:"fit-content",maxWidth:"400px",minWidth:"fit-content"}})}return null}}):null,M.miniMapEnabled?(0,t.jsx)(_s,{}):null,M.snapLineEnabled?(0,t.jsx)(Gs,{options:Ws,visible:!0}):null,M.infoPanelEnabled?(0,t.jsx)(Yr,{data:e.statistics,style:{position:"absolute",top:"0px",left:"0px",zIndex:1}}):null,(0,t.jsx)(La.Provider,{value:{graph:(n=Se.current)===null||n===void 0?void 0:n.graph,apis:(a=Se.current)===null||a===void 0?void 0:a.apis,selectedNodes:Ie},children:e.children?e.children:null})]})},nc=tc,ac=`
- **Explain Subgraph with ChatGPT**: Right-click on a disease node to see more actions, such as "Explain Subgraph in Context (Experimental)". This will use ChatGPT to explain the subgraph in the context of the selected disease. It might take a little bit longer to get the response.
- **Drag**: Hold the left mouse button and drag to move the graph.
- **Zoom**: Use the mouse wheel to zoom in or out or use the buttons on the bottom right corner.
- **Select**: Click on a node to select it. Hold the Shift key and click on another node to select multiple nodes. Click on the background to deselect all nodes.
- **Multi-Select**: Hold the Shift key and drag the mouse to select multiple nodes.
- **Search**: Use the search box to search for nodes by their names/ids.
- **Advanced Search**: Use the "Upload / Query" button to perform more complex queries. If you have your own data, such as DEGs, you can use "Batch Query" to upload your data and search for them in the graph.
- **Layout**: Use the buttons on the left to change the layout of the graph.
- **Toolbar**: Use the buttons on the left to change many other settings about the graph. such as Hide/Show Labels, Hide/Show Tooltips, Highlight Connections, etc.
- **Save/Load**: Use the buttons on the left to save or load your graph. You can also save the graph as an image or a JSON file. You can also load a graph from a JSON file which you have saved before or get from others.
- **Actions on Nodes**: Right-click on a node to see more actions, such as "Expand Node", "Find Shared Nodes", "Find Shortest Path", etc.
- **Actions on Edges**: Right-click on an edge to see more actions, such as "Hide/Show Edge" etc.
`,rc=function(e){var n=(0,s.useState)([]),a=v()(n,2),r=a[0],i=a[1],o=(0,s.useState)(!1),d=v()(o,2),c=d[0],y=d[1],S=(0,s.useState)("Search Disease & Related Entities ..."),M=v()(S,2),N=M[0],h=M[1],w=(0,s.useState)(void 0),p=v()(w,2),u=p[0],f=p[1],b=(0,s.useState)("Disease"),L=v()(b,2),D=L[0],k=L[1],U=(0,s.useState)(!1),F=v()(U,2),T=F[0],z=F[1],C=function(Q){k(Q),f(void 0),h("Search ".concat(Q," & Related Entities ..."))},j=function(Q){Q?(y(!0),Bn(e.getEntities,D,Q,function(se){f(se),y(!1)})):f(void 0)},I=function(Q){if(console.log("Handle Change: ",Q),Q){var se;(se=e.onChange)===null||se===void 0||se.call(e,D,Q)}else{var O;(O=e.onChange)===null||O===void 0||O.call(e,D,void 0)}};return(0,s.useEffect)(function(){if(e.entityTypes){var R=[];(0,X.uniq)(e.entityTypes).sort().forEach(function(Q){R.push({order:0,label:Q,value:Q})}),i(R)}},[e.entityTypes]),(0,t.jsxs)(_e.Z,{className:"query-builder",children:[(0,t.jsx)(pe.default,{className:"entity-type-select",value:D,getPopupContainer:function(Q){return Q.parentNode},options:r,onSelect:C}),(0,t.jsx)(pe.default,{className:"entity-select",showSearch:!0,allowClear:!0,loading:c,getPopupContainer:function(Q){return Q.parentNode},defaultActiveFirstOption:!1,placeholder:N,onSearch:j,onChange:I,options:u,filterOption:!1,notFoundContent:(0,t.jsx)(Oe.Z,{description:c?"Searching...":u!==void 0?"Not Found or Too Short Input":D===void 0?"Please select a node type ...":"Enter your interested ".concat(D," ...")})}),(0,t.jsx)(q.ZP,{onClick:e.onAdvancedSearch,className:"advanced-search-button",type:"primary",children:"Upload / Query"}),(0,t.jsx)(q.ZP,{icon:(0,t.jsx)(Xn.Z,{}),className:"help-button",danger:!0,type:"primary",onClick:function(){z(!0)}}),(0,t.jsx)("span",{className:"note",children:"Hold Shift and Drag Mouse to Multi-Select Nodes"}),(0,t.jsx)(on.Z,{title:"Help - Common Operations",width:"50%",getContainer:function(){return document.getElementById("knowledge-graph-container")||document.body},open:T,onCancel:function(){z(!1)},footer:null,children:(0,t.jsx)(mn,{markdown:ac})})]})},ic=rc,oc=g(40784),lc=g(91966),li=g.n(lc),sc=g(63105),cc=g.n(sc),dc=g(40378),uc=function(){function l(e,n){Vt()(this,l),Ee()(this,"data",void 0),Ee()(this,"merge_mode",void 0),this.data=e,this.merge_mode=n}return Wt()(l,[{key:"get_current_node_id",value:function(){}},{key:"get_instance_id",value:function(){return"nodes-search-object"}},{key:"process",value:function(n){return!this.data.enableAutoConnection&&this.data.entity_ids.length==this.data.entity_types.length?n.GetConnectedNodesFn({node_ids:wr(this.data.entity_ids,this.data.entity_types)}):this.data.enableAutoConnection?new Promise(function(a,r){console.log("NodeSearchObjectClass: Not implemented yet."),a({nodes:[],edges:[]})}):new Promise(function(a,r){r("The length of entity_ids and entity_types must be equal.")})}}]),l}(),hc=["leftColumns","rightColumns"],fc=(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{children:"The example CSV file contains two columns: node_id and node_type, representing the node's ID and type, respectively. Entries are comma-separated."}),(0,t.jsx)("br",{}),(0,t.jsx)("br",{}),(0,t.jsx)("span",{children:"node_id: Unique identifier for the node, prefixed to indicate its database source(e.g., MESH, ENTREZ)."}),(0,t.jsx)("br",{}),(0,t.jsx)("span",{children:"node_type: Category of the node, such as Disease, Gene, Compound, Symptom, Cellular Process, Molecular Function, Biological Process, Pathway, or Anatomy."}),(0,t.jsx)("br",{}),(0,t.jsx)("br",{}),(0,t.jsx)("span",{children:"Prefix and Node Type Association:"}),(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:"Disease: Prefixed by MESH or MONDO, such as MESH:D002289, MESH:D015673, MONDO:0007256."}),(0,t.jsx)("li",{children:"Gene: Prefixed by ENTREZ, such as ENTREZ:1, ENTREZ:2."}),(0,t.jsx)("li",{children:"Pathway: Prefixed by KEGG, Reactome, or WikiPathways, such as KEGG:hsa04110, Reactome:R-HSA-109581, WikiPathways:WP254."}),(0,t.jsx)("li",{children:"Symptom: Prefixed by MESH or SYMP, such as MESH:D001523, SYMP:0000001."}),(0,t.jsx)("li",{children:"MolecularFunction, BiologicalProcess, CellularProcess: Prefixed by GO, such as GO:0003700, GO:0008150, GO:0009987."}),(0,t.jsx)("li",{children:"Compound: Prefixed by DrugBank or MESH, such as DrugBank:DB00001, MESH:C0006142."})]}),(0,t.jsx)("span",{children:"Each node_id must have a prefix that matches its node_type for clear categorization."})]}),gc=[{node_id:"MESH:D002289",node_type:"Disease"},{node_id:"MESH:D015673",node_type:"Disease"},{node_id:"ENTREZ:1",node_type:"Gene"},{node_id:"DrugBank:DB00001",node_type:"Compound"},{node_id:"MESH:C0006142",node_type:"Compound"},{node_id:"KEGG:hsa04110",node_type:"Pathway"}],yc=function(){var e="node_id,node_type",n=gc.map(function(o){return"".concat(o.node_id,",").concat(o.node_type)});n.unshift(e);var a="data:text/csv;charset=utf-8,"+n.join(`
`),r=encodeURI(a),i=document.createElement("a");i.setAttribute("href",r),i.setAttribute("download","example.csv"),document.body.appendChild(i),i.click(),document.body.removeChild(i)},pc=[{dataIndex:"node_id",title:"ID",align:"center"},{dataIndex:"node_type",title:"Type",align:"center"},{dataIndex:"matched_id",title:"Matched ID",align:"center"},{dataIndex:"matched_name",title:"Matched Name",align:"center"},{dataIndex:"disabled",title:"Status",align:"center",render:function(e){return(0,t.jsx)(vt.Z,{children:e?"Not Matched":"Matched"})}}],mc=[{dataIndex:"node_id",title:"Raw ID",align:"center"},{dataIndex:"matched_id",title:"Matched ID",align:"center"}],vc=function(e){var n=e.leftColumns,a=e.rightColumns,r=Qr()(e,hc);return(0,t.jsx)(oc.Z,m()(m()({},r),{},{children:function(o){var d=o.direction,c=o.filteredItems,y=o.onItemSelectAll,S=o.onItemSelect,M=o.selectedKeys,N=o.disabled,h=d==="left"?n:a,w={getCheckboxProps:function(u){return{disabled:N||u.disabled}},onSelectAll:function(u,f){var b=f.filter(function(D){return!D.disabled}).map(function(D){var k=D.key;return k}),L=u?li()(b,M):li()(M,b);y(L,u)},onSelect:function(u,f){var b=u.key;S(b,f)},selectedRowKeys:M};return(0,t.jsx)(Vn.Z,{rowSelection:w,columns:h,dataSource:c,size:"small",locale:dc.Z.Table,style:{pointerEvents:N?"none":void 0},onRow:function(u){var f=u.key,b=u.disabled;return{onClick:function(){b||N||S(f,!M.includes(f))}}}})}}))},Sc=function(e){var n=(0,s.useState)([]),a=v()(n,2),r=a[0],i=a[1],o=function(){if(r.length===0){B.ZP.warning("Please select at least one node from the left table.");return}else{var y,S=r.map(function(N){var h=cc()(e.dataSource,function(w){return w.node_id===N});return h[0].node_type}),M=new uc({entity_ids:r,entity_types:S,enableAutoConnection:!1},"append");(y=e.onOk)===null||y===void 0||y.call(e,M)}},d=function(y){i(y),console.log("targetKeys: ",y)};return(0,t.jsxs)(_e.Z,{className:"transfer-table",children:[(0,t.jsxs)("span",{style:{background:"#d9d9d9",padding:"5px",border:"1px solid #d9d9d9",borderRadius:"5px",marginBottom:"5px"},children:["NOTE: Please follow the example file and help message to upload your data. You might get them from DEGs, Publications, or other sources.",(0,t.jsx)(Et.Z,{title:fc,overlayClassName:"transfer-table-help",getPopupContainer:function(y){return y.parentElement||document.body},children:(0,t.jsxs)("a",{children:[(0,t.jsx)(Xn.Z,{style:{marginLeft:"5px"}})," Help"]})})]}),(0,t.jsx)(vc,{dataSource:e.dataSource,targetKeys:r,showSearch:!0,onChange:d,filterOption:function(y,S){return S.node_id.indexOf(y)!==-1||S.node_type.indexOf(y)!==-1},leftColumns:pc,rightColumns:mc}),(0,t.jsxs)(_e.Z,{className:"button-group",children:[(0,t.jsx)(q.ZP,{type:"link",onClick:function(){yc()},children:"Download Example File"}),(0,t.jsx)(q.ZP,{onClick:e.onCancel,children:"Cancel"}),(0,t.jsx)(q.ZP,{type:"primary",onClick:o,children:"Search"})]})]})},si=Sc,ci=g(64542),di=g(63366),Mc=g(57460),jc=g.n(Mc),xc=function(e){var n=(0,s.useState)([]),a=v()(n,2),r=a[0],i=a[1],o=function(y){var S=y.reduce(function(h,w){var p=w.node_type,u=w.node_id;return h[p]?h[p].push(u):h[p]=[u],h},{}),M=Object.keys(S);console.log("UploadNode fetch: ",S,M);var N=M.map(function(h){var w=S[h],p={operator:"and",items:[{operator:"in",field:"id",value:w},{operator:"=",field:"label",value:h}]};return e.getEntities({query_str:JSON.stringify(p),page:1,page_size:100})});return Promise.all(N)};(0,s.useEffect)(function(){e.onUpload&&e.onUpload(r)},[r]);var d={name:"file",action:"/api/upload",showUploadList:!1,beforeUpload:function(y){var S=new FileReader;return S.readAsText(y),S.onload=function(){jc().parse(S.result,{complete:function(N){var h=[];N.data.length>=100?(B.ZP.warning("The number of nodes should be less than 100, we will only use the first 100 nodes."),h=N.data.slice(0,100)):h=N.data;var w=h.map(function(k,U){return U===0?k.map(function(F){return Ee()({},F,null)}):k.reduce(function(F,T,z){return F[h[0][z]]=T,F},{})});B.ZP.success("Successfully parsed CSV data");var p=w.filter(function(k){return k.node_id&&k.node_type});console.log("Parsed CSV data:",w,p);var u=[],f=Ht()(p),b;try{for(f.s();!(b=f.n()).done;){var L=b.value;u.push({key:L.node_id,node_id:L.node_id,node_type:L.node_type})}}catch(k){f.e(k)}finally{f.f()}var D=(0,X.uniqBy)(u,function(k){return"".concat(k.node_id,"-").concat(k.node_type)});za.ZP.info({message:"Found duplicated nodes",description:"The number of nodes is ".concat(u.length,", the number of unique nodes is ").concat(D.length)}),console.log("selectedData: ",u,D),u=D,u.length>0?o(u).then(function(k){var U=(0,X.flatten)(k.map(function(T,z){return T.records})),F=u.map(function(T,z){var C=U.find(function(j){return"".concat(j.id)===T.node_id});return C?{key:T.node_id,node_id:T.node_id,node_type:T.node_type,matched_id:C.id,matched_name:C.name,disabled:!1}:{key:T.node_id,node_id:T.node_id,node_type:T.node_type,matched_id:"",matched_name:"",disabled:!0}});i(F)}).catch(function(k){console.log(k),B.ZP.error("Failed to match any nodes with our database.")}):B.ZP.error("No satisfied data in the uploaded file")},error:function(N){B.ZP.error("Failed to parse CSV data")}})},S.onerror=function(M){B.ZP.error("Failed to read file")},!1}};return(0,t.jsx)(ci.Z,m()(m()({},d),{},{children:(0,t.jsx)(q.ZP,{icon:(0,t.jsx)(di.Z,{}),children:"Upload"})}))},ui=xc,hi=function(){function l(e,n){Vt()(this,l),Ee()(this,"data",void 0),Ee()(this,"merge_mode",void 0),this.data=e,this.merge_mode=n}return Wt()(l,[{key:"get_instance_id",value:function(){return"linked-nodes-search-object"}},{key:"get_current_node_id",value:function(){return"".concat(this.data.entity_type).concat(nt).concat(this.data.entity_id)}},{key:"process",value:function(){var e=Kt()(We()().mark(function a(r){var i,o,d,c;return We()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!(!this.data.nsteps||this.data.nsteps===1)){S.next=8;break}return i={operator:"and",items:[{field:"source_type",operator:"=",value:this.data.entity_type},{field:"source_id",operator:"=",value:this.data.entity_id}]},o={operator:"and",items:[{field:"target_type",operator:"=",value:this.data.entity_type},{field:"target_id",operator:"=",value:this.data.entity_id}]},this.data.relation_types&&this.data.relation_types.length>0&&(d={field:"relation_type",operator:"in",value:this.data.relation_types},i.items.push(d),o.items.push(d)),c={operator:"or",items:[i,o]},S.abrupt("return",r.GetOneStepLinkedNodesFn({query_str:JSON.stringify(c),page:1,page_size:this.data.limit||10}));case 8:return S.abrupt("return",new Promise(function(M,N){console.log("LinkedNodesSearchObjectClass: Not implemented yet."),M({nodes:[],edges:[]})}));case 9:case"end":return S.stop()}},a,this)}));function n(a){return e.apply(this,arguments)}return n}()}]),l}(),In=g(23242),Nc=function(e){return e?(0,t.jsxs)("div",{style:{overflowWrap:"break-word",width:"500px"},children:[(0,t.jsxs)("p",{style:{marginBottom:"5px"},children:[(0,t.jsx)("span",{style:{fontWeight:"bold"},children:"Synonyms: "}),e.synonyms||"No synonyms found!"]}),(0,t.jsxs)("p",{style:{marginBottom:"5px"},children:[(0,t.jsx)("span",{style:{fontWeight:"bold"},children:"Xrefs: "}),e.xrefs||"No xrefs found!"]}),(0,t.jsxs)("p",{style:{marginBottom:"5px"},children:[(0,t.jsx)("span",{style:{fontWeight:"bold"},children:"Description: "}),e.description||"No description found!"]}),(0,t.jsxs)("p",{style:{marginBottom:"5px"},children:[(0,t.jsx)("span",{style:{fontWeight:"bold"},children:"ID: "}),e.id]}),(0,t.jsxs)("p",{style:{marginBottom:"5px"},children:[(0,t.jsx)("span",{style:{fontWeight:"bold"},children:"Name: "}),e.name]}),(0,t.jsxs)("p",{style:{marginBottom:"5px"},children:[(0,t.jsx)("span",{style:{fontWeight:"bold"},children:"Label: "}),e.label]})]}):(0,t.jsx)("div",{children:"No metadata found!"})},ra=Nc,Cc=[{label:"1 Step",value:1},{label:"2 Steps",value:2},{label:"3 Steps",value:3},{label:"4 Steps",value:4},{label:"5 Steps",value:5}],Ic=function(e){var n=J.Z.useForm(),a=v()(n,1),r=a[0],i=J.Z.useWatch("entity_type",r),o=J.Z.useWatch("entity_id",r),d=J.Z.useWatch("limit",r),c=J.Z.useWatch("nsteps",r),y=J.Z.useWatch("relation_types",r),S=Dr(e.relationStat),M=(0,s.useState)([]),N=v()(M,2),h=N[0],w=N[1],p=(0,s.useState)(0),u=v()(p,2),f=u[0],b=u[1],L=(0,s.useState)(!1),D=v()(L,2),k=D[0],U=D[1],F=(0,s.useState)([]),T=v()(F,2),z=T[0],C=T[1],j=(0,s.useState)(!1),I=v()(j,2),R=I[0],Q=I[1],se=(0,s.useState)(""),O=v()(se,2),_=O[0],Ie=O[1],me=(0,s.useState)("Search nodes ..."),Ae=v()(me,2),ge=Ae[0],it=Ae[1],ut=(0,s.useState)(void 0),ht=v()(ut,2),Ge=ht[0],ft=ht[1],St=function(ne){ft(void 0),it("Search ".concat(ne," nodes ..."))},Mt=function(ne,be){be?(U(!0),Bn(e.getEntities,ne,be,function(Ye){ft(Ye),U(!1)})):ft(void 0)},$e=function(){var ae=Kt()(We()().mark(function ne(be,Ye,Be,Xe){var ue;return We()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:ue={operator:"or",items:[{operator:"and",items:[{field:"source_id",operator:"=",value:be},{field:"source_type",operator:"=",value:Ye}]},{operator:"and",items:[{field:"target_id",operator:"=",value:be},{field:"target_type",operator:"=",value:Ye}]}]},Xe&&Xe.length>0&&(ue={operator:"and",items:[ue,{field:"relation_type",operator:"in",value:Xe}]}),e.getRelationCounts({query_str:JSON.stringify(ue)}).then(function(Z){console.log("Get relation counts: ",Z);var $=[];if(Z.length>0){var ye=Lr(Z.map(function(re){return re.ncount}));Z.forEach(function(re,we){var ce=Tr(re.relation_type,re.resource,re.source_type,re.target_type);$.push({order:we,label:"[".concat(re.ncount.toString().padStart(ye,"0"),"] ").concat(ce),value:ce})});var le=Z.reduce(function(re,we){return re+we.ncount},0);b(le),Be($)}else b(0),Be([])}).catch(function(Z){B.ZP.error("Get relations error, please refresh the page and try again."),console.log("Get relations error: ",Z),Be([])});case 3:case"end":return A.stop()}},ne)}));return function(be,Ye,Be,Xe){return ae.apply(this,arguments)}}();(0,s.useEffect)(function(){var ae=e.entityTypes.map(function(ne){return{order:0,label:ne,value:ne}});w((0,X.sortBy)((0,X.uniqBy)(ae,"label"),"label"))},[e.entityTypes]),(0,s.useEffect)(function(){e.searchObject&&e.searchObject.get_instance_id()==="linked-nodes-search-object"&&r.setFieldsValue({entity_type:e.searchObject.data.entity_type,entity_id:e.searchObject.data.entity_id,relation_types:e.searchObject.data.relation_types,nsteps:e.searchObject.data.nsteps,limit:e.searchObject.data.limit,merge_mode:e.searchObject.merge_mode})},[e.searchObject]);var gt=function(){C(S),b((0,In.stat_total_relation_count)(e.relationStat))};(0,s.useEffect)(function(){gt()},[e.relationStat]),(0,s.useEffect)(function(){r.setFieldsValue({relation_types:void 0}),o&&i&&(Q(!0),$e(o,i,function(ae){if(console.log("fetchRelationshipTypes within node mode: ",ae),ae.length>0){var ne=Ne()(S),be=ne==null?void 0:ne.map(function(P){var A=ae.find(function(Z){var $=Z.label.split(" ")[1],ye=P.label.split(" ")[1];return ye===$});return A||null});if(console.log("mergedRelationTypeOptions: ",be),be){var Ye=be.filter(function(P){return P!==null});console.log("Update the number of relationships: ",be);var Be=Ye.sort(function(P,A){var Z=parseInt(P.label.split(" ")[0].replace("[","").replace("]","")),$=parseInt(A.label.split(" ")[0].replace("[","").replace("]",""));return $-Z}),Xe=(0,X.uniqBy)(Be,"value"),ue=Xe.map(function(P){var A=S.find(function(Z){return Z.value===P.value});return A?m()(m()({},P),{},{description:A.description}):P});C(ue),Q(!1)}else C([]),Q(!1)}else C([]),Q(!1)},y))},[o,i]),(0,s.useEffect)(function(){gt()},[i]);var yt=function(){Ie("")},jt=function(){r.validateFields().then(function(ne){if(e.onOk){var be={entity_type:ne.entity_type,entity_id:ne.entity_id,relation_types:ne.relation_types?ne.relation_types:[],nsteps:ne.nsteps?ne.nsteps:1,limit:ne.limit?ne.limit:10};e.onOk(new hi(be,ne.merge_mode))}}).catch(function(ne){console.log("onConfirm Error: ",ne)})};return(0,t.jsxs)(J.Z,{className:"linked-nodes-searcher",layout:"horizontal",form:r,labelCol:{span:7},wrapperCol:{span:17},children:[(0,t.jsx)("p",{style:{marginTop:"0"},children:"NOTE: You can use it to query linked nodes which existing in our database. If you would like to predict new relations between nodes, please use the `Predict Drug/Target` module, pick up the predicted results and then explain the predicted results."}),(0,t.jsx)(J.Z.Item,{label:"Node Type",name:"entity_type",tooltip:"The type of the node you are interested in. Such as Disease, Gene, Compound, etc. You need to select a node type first, then you can search the node by its name or id.",rules:[{required:!0,message:"Please select a node type."}],children:(0,t.jsx)(pe.default,{allowClear:!0,getPopupContainer:function(ne){return ne.parentNode},defaultActiveFirstOption:!1,placeholder:"Please select a node type",options:h,filterOption:!0,onSelect:St})}),(0,t.jsx)(J.Z.Item,{label:"Which Node",tooltip:"The node you are interested in. You can search the node by its name or id. You need to select a node type first.",name:"entity_id",rules:[{required:!0,message:"Please enter your expected node."}],children:(0,t.jsx)(pe.default,{showSearch:!0,allowClear:!0,loading:k,defaultActiveFirstOption:!1,getPopupContainer:function(ne){return ne.parentNode},placeholder:ge,onSearch:function(ne){return Mt(i,ne)},filterOption:!1,notFoundContent:(0,t.jsx)(Oe.Z,{description:k?"Searching...":Ge!==void 0?"Not Found or Too Short Input":i===void 0?"Please select a node type first.":"Enter your interested ".concat(i," ...")}),children:Ge&&Ge.map(function(ae){return(0,t.jsx)(pe.default.Option,{value:ae.value,disabled:ae.disabled,children:ae.metadata?(0,t.jsx)(zt.Z,{placement:"rightBottom",title:ae.label,content:ra(ae.metadata),trigger:"hover",getPopupContainer:function(be){return document.body},overlayClassName:"entity-id-popover",autoAdjustOverflow:!1,destroyTooltipOnHide:!0,zIndex:1500,children:ae.label}):ae.label},ae.label)})})}),(0,t.jsx)(J.Z.Item,{label:"Total Linked Nodes",name:"total_linked_nodes",tooltip:"This means the total number of nodes that are linked to the selected node. If you didn't select any relation types, we will return all the linked nodes.",children:(0,t.jsx)(Wn.Z,{size:"small",spinning:R,children:(0,t.jsx)("span",{children:f.toLocaleString()})})}),(0,t.jsx)(J.Z.Item,{name:"relation_types",label:"Relation Types",tooltip:"The relation types between the selected node and other nodes. The number in the prefix of the relation type is the number of the existing relations in our database. you can follow the number to decide the maximum number of edges. In addition, We will rank the relations according to our model's score. So the top relations are more likely to be the most important ones.",validateStatus:_?"warning":"",help:_,rules:[{required:!1,message:"Please select your expected relation types!",type:"array"}],children:(0,t.jsx)(pe.default,{mode:"multiple",loading:R,onChange:yt,filterOption:function(ne,be){return(be==null?void 0:be.key.toLowerCase().indexOf(ne.toLowerCase()))>=0},getPopupContainer:function(ne){return ne.parentNode},allowClear:!0,autoClearSearchValue:!1,placeholder:"Please select relation types",children:z.map(function(ae){return(0,t.jsx)(pe.default.Option,{value:ae.value,children:(0,t.jsxs)("div",{className:"option-container",children:[(0,t.jsx)("div",{className:"option-label",children:ae.label}),(0,t.jsx)("div",{className:"option-description",children:ae.description})]})},ae.value)})})}),(0,t.jsx)(J.Z.Item,{name:"nsteps",label:"Num of Steps",initialValue:1,hidden:!0,rules:[{required:!1,message:"Please select your expected nsteps",type:"number"},{type:"number",min:1,max:2,message:"The value should be between 1 and 2"}],children:(0,t.jsx)(pe.default,{disabled:!0,placeholder:"Please select nsteps",getPopupContainer:function(ne){return ne.parentNode},options:Cc})}),(0,t.jsx)(J.Z.Item,{name:"limit",label:"Max Num of Edges",tooltip:"The maximum number of edges to return. You might get several edges between two nodes and our platform will merge them into one edge. so the number of edges and nodes might be less than the expected value.",initialValue:10,rules:[{required:!1,message:"Please input your expected value",type:"number"},{type:"number",min:1,max:50,message:"The value should be between 1 and 50"}],children:(0,t.jsx)($t.Z,{})}),(0,t.jsx)(J.Z.Item,{label:"Merging Mode",name:"merge_mode",initialValue:"append",tooltip:"The mode for merging nodes and relationships. If append, we will append the new nodes and relationships to the existing graph. If replace, we will replace the existing graph with the new nodes and relationships...",children:(0,t.jsx)(pe.default,{placeholder:"Please select mode for merging nodes & relationships",options:Un,getPopupContainer:function(ne){return ne.parentNode}})}),(0,t.jsxs)(J.Z.Item,{wrapperCol:{offset:18,span:6},children:[(0,t.jsx)(q.ZP,{style:{marginRight:"10px"},onClick:function(){r.resetFields(),gt()},children:"Reset"}),(0,t.jsx)(q.ZP,{type:"primary",onClick:jt,disabled:f==0,children:"Search"})]})]})},fi=Ic,gi=function(){function l(e,n){Vt()(this,l),Ee()(this,"data",void 0),Ee()(this,"merge_mode",void 0),this.data=e,this.merge_mode=n}return Wt()(l,[{key:"get_instance_id",value:function(){return"similarity-nodes-search-object"}},{key:"get_current_node_id",value:function(){return"".concat(this.data.entity_type).concat(nt).concat(this.data.entity_id)}},{key:"process",value:function(n){var a=void 0,r={node_id:"".concat(this.data.entity_type).concat(nt).concat(this.data.entity_id),relation_type:"".concat(this.data.relation_type),topk:this.data.topk||10};return a&&(r.query_str=JSON.stringify(a)),n.GetPredictedNodesFn(r)}}]),l}(),bc=function(e){var n=J.Z.useForm(),a=v()(n,1),r=a[0],i=J.Z.useWatch("entity_type",r),o=Dr(e.relationStat),d=(0,s.useState)([]),c=v()(d,2),y=c[0],S=c[1],M=(0,s.useState)(!1),N=v()(M,2),h=N[0],w=N[1],p=(0,s.useState)("Search nodes ..."),u=v()(p,2),f=u[0],b=u[1],L=(0,s.useState)(void 0),D=v()(L,2),k=D[0],U=D[1],F=function(j){U(void 0),b("Search ".concat(j," nodes ..."))},T=function(j,I){I?(w(!0),Bn(e.getEntities,j,I,function(R){U(R),w(!1)})):U(void 0)};(0,s.useEffect)(function(){var C=e.entityTypes.map(function(j){return{order:0,label:j,value:j}});S((0,X.sortBy)((0,X.uniqBy)(C,"label"),"label"))},[e.entityTypes]),(0,s.useEffect)(function(){e.searchObject&&e.searchObject.get_instance_id()==="similarity-nodes-search-object"&&r.setFieldsValue({entity_type:e.searchObject.data.entity_type,entity_id:e.searchObject.data.entity_id,relation_type:e.searchObject.data.relation_type,topk:e.searchObject.data.topk,merge_mode:e.searchObject.merge_mode})},[e.searchObject]);var z=function(){r.validateFields().then(function(j){if(e.onOk){var I={entity_type:j.entity_type,entity_id:j.entity_id,relation_type:j.relation_type,topk:j.topk?j.topk:50};e.onOk(new gi(I,j.merge_mode))}}).catch(function(j){console.log("onConfirm Error: ",j)})};return(0,t.jsxs)(J.Z,{className:"similarity-nodes-searcher",layout:"horizontal",form:r,labelCol:{span:7},wrapperCol:{span:17},children:[(0,t.jsx)("p",{style:{marginTop:"0"},children:"NOTE: This is a similarity search for nodes according to our model, such as finding similar drugs with a specific drug. If you are interested in finding similar nodes to a specific node, please select the node type and node id, and then select the relation type and top k similar nodes."}),(0,t.jsx)(J.Z.Item,{label:"Node Type",name:"entity_type",tooltip:"The type of the node you are interested in. Such as Disease, Gene, Compound, etc. You need to select a node type first, then you can search the node by its name or id.",rules:[{required:!0,message:"Please select a node type."}],children:(0,t.jsx)(pe.default,{allowClear:!0,defaultActiveFirstOption:!1,getPopupContainer:function(j){return j.parentNode},placeholder:"Please select a node type",options:y,filterOption:!0,onSelect:F})}),(0,t.jsx)(J.Z.Item,{label:"Which Node",name:"entity_id",tooltip:"The node you are interested in. You can search the node by its name or id. You need to select a node type first.",rules:[{required:!0,message:"Please enter your expected node."}],children:(0,t.jsx)(pe.default,{showSearch:!0,allowClear:!0,getPopupContainer:function(j){return j.parentNode},loading:h,defaultActiveFirstOption:!1,placeholder:f,onSearch:function(j){return T(i,j)},filterOption:!1,notFoundContent:(0,t.jsx)(Oe.Z,{description:h?"Searching...":k!==void 0?"Not Found or Too Short Input":i===void 0?"Please select a node type first.":"Enter your interested ".concat(i," ...")}),children:k&&k.map(function(C){return(0,t.jsx)(pe.default.Option,{value:C.value,disabled:C.disabled,children:C.metadata?(0,t.jsx)(zt.Z,{placement:"rightBottom",title:C.label,content:ra(C.metadata),trigger:"hover",getPopupContainer:function(I){return document.body},overlayClassName:"entity-id-popover",autoAdjustOverflow:!1,destroyTooltipOnHide:!0,zIndex:1500,children:C.label}):C.label},C.label)})})}),(0,t.jsx)(J.Z.Item,{label:"Relation Type",name:"relation_type",tooltip:"The relation types between the selected node and other nodes. We will rank the relations according to our model's score. so the top relations are more likely to be the most similar ones.",rules:[{required:!0,message:"Please select a relation type"}],children:(0,t.jsx)(pe.default,{filterOption:function(j,I){return(I==null?void 0:I.key.toLowerCase().indexOf(j.toLowerCase()))>=0},getPopupContainer:function(j){return j.parentNode},allowClear:!0,autoClearSearchValue:!1,placeholder:"Please select relation types",children:o.map(function(C){return(0,t.jsx)(pe.default.Option,{value:C.value,children:(0,t.jsxs)("div",{className:"option-container",children:[(0,t.jsx)("div",{className:"option-label",children:C.label}),(0,t.jsx)("div",{className:"option-description",children:C.description})]})},C.value)})})}),(0,t.jsx)(J.Z.Item,{name:"topk",label:"Top K",tooltip:"The number of similar nodes you want to get. The default value is 50.",initialValue:50,rules:[{required:!1,message:"Please input your expected value",type:"number"},{type:"number",min:1,max:50,message:"The value should be between 1 and 50"}],children:(0,t.jsx)($t.Z,{})}),(0,t.jsx)(J.Z.Item,{label:"Merging Mode",name:"merge_mode",initialValue:"append",tooltip:"The mode for merging nodes and relationships. If append, we will append the new nodes and relationships to the existing graph. If replace, we will replace the existing graph with the new nodes and relationships...",children:(0,t.jsx)(pe.default,{getPopupContainer:function(j){return j.parentNode},placeholder:"Please select mode for merging nodes & relationships",options:Un})}),(0,t.jsxs)(J.Z.Item,{wrapperCol:{offset:18,span:6},children:[(0,t.jsx)(q.ZP,{style:{marginRight:"10px"},onClick:function(){r.resetFields()},children:"Reset"}),(0,t.jsx)(q.ZP,{type:"primary",onClick:z,children:"Search"})]})]})},yi=bc,wc=function(){function l(e,n){Vt()(this,l),Ee()(this,"data",void 0),Ee()(this,"merge_mode",void 0),this.data=e,this.merge_mode=n}return Wt()(l,[{key:"get_instance_id",value:function(){return"batch-nodes-search-object"}},{key:"get_current_node_id",value:function(){}},{key:"process",value:function(n){return this.data.entity_ids.length==this.data.entity_types.length?n.GetNodesFn({node_ids:wr(this.data.entity_ids,this.data.entity_types)}):new Promise(function(a,r){r("The length of entity_ids and entity_types must be equal.")})}}]),l}(),Lc=function(e){var n=J.Z.useForm(),a=v()(n,1),r=a[0],i=J.Z.useWatch("entity_type",r),o=(0,s.useState)([]),d=v()(o,2),c=d[0],y=d[1],S=(0,s.useState)(!1),M=v()(S,2),N=M[0],h=M[1],w=(0,s.useState)("Search nodes ..."),p=v()(w,2),u=p[0],f=p[1],b=(0,s.useState)(void 0),L=v()(b,2),D=L[0],k=L[1],U=(0,s.useState)(void 0),F=v()(U,2),T=F[0],z=F[1],C=function(_){k(void 0),f("Search ".concat(_," nodes ..."))};(0,s.useEffect)(function(){i&&(r.setFieldsValue({entity_id:void 0}),k(void 0))},[i]);var j=(0,X.debounce)(function(O,_){B.ZP.warning(O,_)},600),I=function(_,Ie){Ie&&_?(h(!0),Bn(e.getEntities,_,Ie,function(me){k(me),h(!1)})):(j("Please select a node type first.",3),k(void 0))},R=function(_,Ie){console.log("addToNodeIdsOptions",_,Ie),_&&z(function(me){var Ae=me?Ne()(me):[],ge=Ir(_,i),it=Ie.key;return Ae.push({label:it||ge,value:ge,order:0}),(0,X.uniqBy)(Ae,"label")})};(0,s.useEffect)(function(){var O=e.entityTypes.map(function(_){return{order:0,label:_,value:_}});y((0,X.sortBy)((0,X.uniqBy)(O,"label"),"label"))},[e.entityTypes]),(0,s.useEffect)(function(){e.searchObject&&e.searchObject.get_instance_id()==="similarity-nodes-search-object"&&r.setFieldsValue({nodeIds:br(e.searchObject.data.entity_ids,e.searchObject.data.entity_types)})},[e.searchObject]);var Q=function(_){r.setFieldsValue({entity_type:void 0}),k(void 0),r.setFieldsValue({entity_id:void 0}),f("Search nodes ...")},se=function(){r.validateFields().then(function(_){if(e.onOk){var Ie=Sl(_.nodeIds),me=Ie.entityIds,Ae=Ie.entityTypes,ge={entity_types:Ae,entity_ids:me};e.onOk(new wc(ge,_.merge_mode))}}).catch(function(_){console.log("onConfirm Error: ",_)})};return(0,t.jsxs)(J.Z,{className:"batch-nodes-searcher",layout:"horizontal",form:r,labelCol:{span:7},wrapperCol:{span:17},children:[(0,t.jsx)("p",{style:{marginTop:"0"},children:"NOTE: If you want to select several nodes, you need to query and select them one by one. After you select a node, then you can see it at `Node Ids` field and select it."}),(0,t.jsx)(J.Z.Item,{label:"Node Type",name:"entity_type",tooltip:"The type of the node you are interested in. Such as Disease, Gene, Compound, etc. You need to select a node type first, then you can search the node by its name or id.",rules:[{required:!1,message:"Please select a node type."}],children:(0,t.jsx)(pe.default,{allowClear:!0,getPopupContainer:function(_){return _.parentNode},defaultActiveFirstOption:!1,placeholder:"Please select a node type",options:c,filterOption:!0,onSelect:C})}),(0,t.jsx)(J.Z.Item,{label:"Which Node",name:"entity_id",tooltip:"The name or id of the node you are interested in. You need to select a node type first, then you can search the node by its name or id.",rules:[{required:!1,message:"Please enter your expected node."}],children:(0,t.jsx)(pe.default,{showSearch:!0,allowClear:!0,loading:N,defaultActiveFirstOption:!1,placeholder:u,onSearch:function(_){return I(i,_)},getPopupContainer:function(_){return _.parentNode},filterOption:!1,onSelect:R,notFoundContent:(0,t.jsx)(Oe.Z,{description:N?"Searching...":D!==void 0?"Not Found or Too Short Input":i===void 0?"Please select a node type first.":"Enter your interested ".concat(i," ...")}),children:D&&D.map(function(O){return(0,t.jsx)(pe.default.Option,{value:O.value,disabled:O.disabled,children:O.metadata?(0,t.jsx)(zt.Z,{placement:"rightBottom",title:O.label,content:ra(O.metadata),trigger:"hover",getPopupContainer:function(Ie){return document.body},overlayClassName:"entity-id-popover",autoAdjustOverflow:!1,destroyTooltipOnHide:!0,zIndex:1500,children:O.label}):O.label},O.label)})})}),(0,t.jsx)(J.Z.Item,{label:"Node Ids",name:"nodeIds",tooltip:"Please select node id and node type from the above form first, and then select the composed node id. If you want to load a lot of nodes, please use the `Batch Query` form.",rules:[{required:!0,message:"Please select node id and node type from the above form."}],children:(0,t.jsx)(pe.default,{mode:"multiple",allowClear:!0,defaultActiveFirstOption:!1,onSelect:Q,placeholder:"Please select composed node id",getPopupContainer:function(_){return _.parentNode},filterOption:!0,children:T&&T.map(function(O){return(0,t.jsx)(pe.default.Option,{value:O.value,disabled:O.disabled,children:O.metadata?(0,t.jsx)(zt.Z,{placement:"rightBottom",title:O.label,content:ra(O.metadata),trigger:"hover",getPopupContainer:function(Ie){return document.body},overlayClassName:"entity-id-popover",autoAdjustOverflow:!1,destroyTooltipOnHide:!0,zIndex:1500,children:O.label}):O.label},O.label)})})}),(0,t.jsx)(J.Z.Item,{label:"Merging Mode",name:"merge_mode",initialValue:"append",tooltip:"The mode for merging nodes and relationships. If append, we will append the new nodes and relationships to the existing graph. If replace, we will replace the existing graph with the new nodes and relationships...",children:(0,t.jsx)(pe.default,{placeholder:"Please select mode for merging nodes & relationships",options:Un,getPopupContainer:function(_){return _.parentNode}})}),(0,t.jsxs)(J.Z.Item,{wrapperCol:{offset:18,span:6},children:[(0,t.jsx)(q.ZP,{style:{marginRight:"10px"},onClick:function(){r.resetFields()},children:"Reset"}),(0,t.jsx)(q.ZP,{type:"primary",onClick:se,children:"Search"})]})]})},pi=Lc,Za=g(55742),mi=function(){function l(e,n){Vt()(this,l),Ee()(this,"data",void 0),Ee()(this,"merge_mode",void 0),this.data=e,this.merge_mode=n}return Wt()(l,[{key:"get_instance_id",value:function(){return"shared-nodes-search-object"}},{key:"get_current_node_id",value:function(){if(this.data.start_node_id)return this.data.start_node_id;if(this.data.nodes.length!==0){var n=this.data.nodes[0];return"".concat(n.data.label).concat(nt).concat(n.data.id)}}},{key:"process",value:function(n){var a,r=void 0,i={start_node_id:this.data.start_node_id,node_ids:this.data.nodes.map(function(o){return"".concat(o.data.label).concat(nt).concat(o.data.id)}).join(","),target_node_types:(a=this.data.node_types)===null||a===void 0?void 0:a.join(","),topk:this.data.topk||10,nhops:this.data.nhops||1,nums_shared_by:this.data.nums_shared_by||this.data.nodes.length};return r&&(i.query_str=JSON.stringify(r)),n.GetSharedNodesFn(i)}}]),l}(),Tc=function(e){var n,a,r=J.Z.useForm(),i=v()(r,1),o=i[0],d=J.Z.useWatch("start_node_option",o),c=J.Z.useWatch("nhops",o),y=(0,s.useState)([]),S=v()(y,2),M=S[0],N=S[1],h=(0,s.useState)(void 0),w=v()(h,2),p=w[0],u=w[1],f=(0,s.useState)(!1),b=v()(f,2),L=b[0],D=b[1],k=(0,s.useState)(!1),U=v()(k,2),F=U[0],T=U[1];(0,s.useEffect)(function(){var C=e.entityTypes.map(function(j){return{order:0,label:j,value:j}});N((0,X.sortBy)((0,X.uniqBy)(C,"label"),"label"))},[e.entityTypes]),(0,s.useEffect)(function(){if(d===!1)u(void 0);else{var C;u((C=e.searchObject)===null||C===void 0?void 0:C.data.start_node_id)}},[d]),(0,s.useEffect)(function(){e.searchObject&&e.searchObject.get_instance_id()==="shared-nodes-search-object"&&o.setFieldsValue({node_types:e.searchObject.data.node_types,nhops:e.searchObject.data.nhops,topk:e.searchObject.data.topk,nums_shared_by:e.searchObject.data.nums_shared_by,merge_mode:e.searchObject.merge_mode})},[e.searchObject]),(0,s.useEffect)(function(){if(c===1)if(d===!0){var C,j;T(!0),D(!0),o.setFieldsValue({topk:((C=e.searchObject)===null||C===void 0?void 0:C.data.nodes.length)&&((j=e.searchObject)===null||j===void 0?void 0:j.data.nodes.length)+1,nums_shared_by:1})}else{var I,R;D(!0),T(!1),o.setFieldsValue({topk:((I=e.searchObject)===null||I===void 0?void 0:I.data.nodes.length)&&((R=e.searchObject)===null||R===void 0?void 0:R.data.nodes.length)+1})}else D(!1),T(!1)},[c,d]);var z=function(){o.validateFields().then(function(j){if(e.onOk){var I,R={start_node_id:p,nodes:((I=e.searchObject)===null||I===void 0?void 0:I.data.nodes)||[],node_types:j.node_types,topk:j.topk,nhops:j.nhops,nums_shared_by:j.nums_shared_by};e.onOk(new mi(R,j.merge_mode))}}).catch(function(j){console.log("onConfirm Error: ",j)})};return(0,t.jsxs)(J.Z,{className:"shared-nodes-searcher",layout:"horizontal",form:o,labelCol:{span:7},wrapperCol:{span:17},children:[(0,t.jsx)(J.Z.Item,{label:"Start Node?",name:"start_node_option",tooltip:"Enable to specify the node you selected as a start node for searching shared nodes with other nodes.",initialValue:!0,children:(0,t.jsxs)(Za.ZP.Group,{children:[(0,t.jsx)(Za.ZP,{value:!0,children:"Enable"}),(0,t.jsx)(Za.ZP,{value:!1,children:"Disable"})]})}),(0,t.jsx)(J.Z.Item,{label:"Node Type(s)",name:"node_types",tooltip:"The type of nodes to be searched. If not specified, all types of nodes will be searched.",rules:[{required:!1,message:"Please select node type(s)."}],children:(0,t.jsx)(pe.default,{allowClear:!0,mode:"multiple",defaultActiveFirstOption:!1,getPopupContainer:function(j){return j.parentNode},placeholder:"Please select node type(s)",options:M,filterOption:!0})}),(0,t.jsx)(J.Z.Item,{name:"nhops",label:"Number of Hops",tooltip:"The depth of the search. The maximum number of hops to be searched. For performance reasons, we limit the maximum number of hops to 2.",initialValue:1,rules:[{required:!1,message:"Please input your expected value",type:"number"},{type:"number",min:1,max:2,message:"The number of hops should be between 1 and 2."}],children:(0,t.jsx)($t.Z,{})}),(0,t.jsx)(J.Z.Item,{name:"topk",label:"Top K",hidden:L,tooltip:"The count of nodes to be returned.",initialValue:10,rules:[{required:!1,message:"Please input your expected value",type:"number"},{type:"number",min:1,max:50,message:"The number of top k should be between 1 and 50."}],children:(0,t.jsx)($t.Z,{})}),(0,t.jsx)(J.Z.Item,{hidden:F,name:"nums_shared_by",label:"Number of Shared By",tooltip:"The count of specified nodes connected to each found node, highlighting shared relationships.",initialValue:(n=e.searchObject)===null||n===void 0?void 0:n.data.nodes.length,rules:[{required:!1,message:"Please input your expected value",type:"number"},{type:"number",min:1,max:((a=e.searchObject)===null||a===void 0?void 0:a.data.nodes.length)||2,message:"The number of shared by should be between 1 and the number of nodes."}],children:(0,t.jsx)($t.Z,{})}),(0,t.jsx)(J.Z.Item,{label:"Merging Mode",name:"merge_mode",initialValue:"append",children:(0,t.jsx)(pe.default,{getPopupContainer:function(j){return j.parentNode},placeholder:"Please select mode for merging nodes & relationships",options:Un})}),(0,t.jsxs)(J.Z.Item,{wrapperCol:{offset:18,span:6},children:[(0,t.jsx)(q.ZP,{style:{marginRight:"10px"},onClick:function(){o.resetFields()},children:"Reset"}),(0,t.jsx)(q.ZP,{type:"primary",onClick:z,children:"Search"})]})]})},vi=Tc,Dc=function(e){var n=(0,s.useState)("linked-nodes-search-object"),a=v()(n,2),r=a[0],i=a[1],o=function(S){console.log("QueryForm onChange:",S),i(S)},d=function(S){var M;return!((S==null||(M=S.data)===null||M===void 0||(M=M.nodes)===null||M===void 0?void 0:M.length)>0)},c=[{key:"linked-nodes-search-object",label:"Linked Nodes",children:(0,t.jsx)(fi,m()({},e))},{key:"similarity-nodes-search-object",label:"Similar Nodes",children:(0,t.jsx)(yi,m()({},e))},{key:"batch-nodes-search-object",label:"Batch Nodes",children:(0,t.jsx)(pi,m()({},e))},{key:"shared-nodes-search-object",label:"Shared Nodes",children:(0,t.jsx)(vi,m()({},e)),disabled:d(e.searchObject)}];return(0,s.useEffect)(function(){e.searchObject&&i(e.searchObject.get_instance_id())},[e.searchObject]),(0,t.jsx)(Sn.Z,{className:"query-form",activeKey:r,items:c,onChange:o,defaultActiveKey:"linked-nodes-search-object"})},Si=Dc,Ec=function(e){return(0,t.jsxs)("div",{className:"question-queryer",children:[(0,t.jsx)("h3",{children:"Question:"}),(0,t.jsx)(Jt.Z.TextArea,{rows:4,placeholder:"Please input your question",maxLength:6}),(0,t.jsx)("h3",{children:"Query (generated by AI):"}),(0,t.jsx)(Jt.Z.TextArea,{rows:4,placeholder:"Wait for your input...",maxLength:6}),(0,t.jsxs)("div",{className:"button-group",children:[(0,t.jsx)(q.ZP,{onClick:e.onCancel,children:"Cancel"}),(0,t.jsx)(q.ZP,{type:"primary",onClick:function(){e.onOk&&e.onOk({})},children:"Search"})]})]})},Ac=Ec,kc=function(e){var n=(0,s.useState)("single"),a=v()(n,2),r=a[0],i=a[1],o=(0,s.useState)([]),d=v()(o,2),c=d[0],y=d[1],S=[{label:"Single Query",key:"single",children:(0,t.jsx)(Si,{entityTypes:e.entityTypes,relationStat:e.relationStat,onCancel:e.onCancel,onOk:e.onOk,searchObject:e.searchObject,getEntities:e.apis.GetEntitiesFn,getRelationCounts:e.apis.GetRelationCountsFn,getSharedNodes:e.apis.GetSharedNodesFn})},{label:"Batch Query",key:"batch",children:(0,t.jsx)(si,{dataSource:c,onOk:e.onOk,onCancel:e.onCancel})},{label:"Ask Question",key:"question",children:(0,t.jsx)(Ac,{onCancel:e.onCancel,onOk:e.onOk}),disabled:!0}];return(0,t.jsx)(on.Z,{className:"advanced-search",title:"Advanced Search",onCancel:e.onCancel,open:e.visible,destroyOnClose:!0,footer:null,getContainer:e.parent?e.parent:document.body,children:(0,t.jsx)(Sn.Z,{defaultActiveKey:"single",activeKey:r,tabPosition:"left",items:S,destroyInactiveTabPane:!0,onChange:function(N){i(N)},tabBarExtraContent:r==="batch"?(0,t.jsx)(ui,{onUpload:function(N){y(N)},getEntities:e.apis.GetEntitiesFn}):null})})},Oc=kc,Pc=function(e){console.log(e)},zc=function(e){var n=s.useState([]),a=v()(n,2),r=a[0],i=a[1];return(0,s.useEffect)(function(){var o=Object.keys(e.data),d=o.map(function(c,y){var S=e.data[c].title;return{label:S,key:y.toString(),children:(0,t.jsx)("div",{children:(0,t.jsx)(mn,{markdown:e.data[c].response,rehypePlugins:[]})})}});i(d)},[e.data]),(0,t.jsx)(Sn.Z,{defaultActiveKey:"1",items:r,onChange:Pc})},Zc=zc,Mi=function(e,n,a,r){return{title:{text:e,font:{family:"Arial",size:"1.3rem",color:"#333333"},xref:"paper",x:0},xaxis:{zeroline:!0,zerolinecolor:"#333333",zerolinewidth:1,tickangle:315,title:{text:n,font:{family:"Arial",size:"1.1rem",color:"#333333"}},tickfont:{family:"Arial",size:"1rem",color:"#333333"},showgrid:!1,margin:{l:50,r:50,b:50,t:50,pad:4},automargin:r},yaxis:{title:{text:a,font:{family:"Arial",size:"1.1rem",color:"#333333"}},tickfont:{family:"Arial",size:"1rem",color:"#333333"},showgrid:!1,zeroline:!0,zerolinecolor:"#333333",zerolinewidth:1,margin:{l:50,r:50,b:50,t:50,pad:4},automargin:r},plot_bgcolor:"#ffffff",paper_bgcolor:"#ffffff"}},Rc=function(e){var n=e.data,a=(0,s.useState)([]),r=v()(a,2),i=r[0],o=r[1];(0,s.useEffect)(function(){if(n.nodes.length!==0){var c=n.nodes,y=n.edges,S=(0,X.uniqBy)(c,"nlabel").map(function(p){return p.nlabel}),M=(0,X.uniqBy)(y,"reltype").map(function(p){return p.reltype}),N=S.map(function(p){return{type:p,count:c.filter(function(u){return u.nlabel===p}).length}}),h=M.map(function(p){return{type:p,count:y.filter(function(u){return u.reltype===p}).length}}),w=[];w.push({data:[{x:N.map(function(p){return p.type}),y:N.map(function(p){return p.count}),type:"bar",name:"Node Type Count",marker:{color:"#0083ff"}}],layout:Mi("Node Type Count","Node Type","Count",!1)}),w.push({data:[{x:h.map(function(p){return p.type}),y:h.map(function(p){return p.count}),type:"bar",name:"Edge Type Count",marker:{color:"#0083ff"}}],layout:Mi("Edge Type Count","Edge Type","Count",!1)}),o(w)}},[n]);var d=function(y){for(var S="",M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",N=M.length,h=0;h<y;)S+=M.charAt(Math.floor(Math.random()*N)),h+=1;return S};return(0,t.jsx)(_e.Z,{className:"complex-chart",children:i.length===0?(0,t.jsx)(Ze.Z,{span:24,children:(0,t.jsx)(Oe.Z,{})}):i.map(function(c,y){return(0,t.jsx)(Ze.Z,{span:12,style:{height:"400px"},children:(0,t.jsx)(vn,{mode:"Plotly",plotlyData:c,divId:"".concat(d(5)),forceResize:!0})},y)})})},ji=Rc,bn=function(e,n,a,r){return{title:{text:e,font:{family:"Arial",size:"1.3rem",color:"#333333"},xref:"paper",x:0},xaxis:{zeroline:!0,zerolinecolor:"#333333",zerolinewidth:1,tickangle:315,title:{text:n,font:{family:"Arial",size:"1.1rem",color:"#333333"}},tickfont:{family:"Arial",size:"1rem",color:"#333333"},showgrid:!1,margin:{l:50,r:50,b:50,t:50,pad:4},automargin:r},yaxis:{title:{text:a,font:{family:"Arial",size:"1.1rem",color:"#333333"}},tickfont:{family:"Arial",size:"1rem",color:"#333333"},showgrid:!1,zeroline:!0,zerolinecolor:"#333333",zerolinewidth:1,margin:{l:50,r:50,b:50,t:50,pad:4},automargin:r},plot_bgcolor:"#ffffff",paper_bgcolor:"#ffffff"}},ia=function(e,n){return e.reduce(function(a,r){return(a[r[n]]=a[r[n]]||[]).push(r),a},{})},xi=function(e,n,a,r){return e.forEach(function(i){i[r]=i[n]+"_"+i[a]}),e},_c=function(e,n,a,r){var i=e.reduce(function(o,d){var c="".concat(d[n],"-").concat(d[a]);return o[c]||(o[c]=Ee()(Ee()(Ee()({},n,d[n]),a,d[a]),r,0)),o[c][r]+=d[r],o},{});return Object.values(i)},Ni=function(e,n,a,r){var i=Object.values(e.reduce(function(o,d){var c=at.Z.snakeCase(d[n]);if(!o[c]){var y={};y[n]=d[n],o[c]=y}var S=at.Z.snakeCase(d[a]);return o[c][S]=d[r],o},{}));return i},Ci=function(e){return e.reduce(function(n,a){return a.map(function(r,i){return(n[i]||[]).concat(a[i])})},[])},Gc=function(e){var n=e.nodeStat,a=e.edgeStat,r=(0,s.useState)([]),i=v()(r,2),o=i[0],d=i[1],c=(0,s.useState)([]),y=v()(c,2),S=y[0],M=y[1];(0,s.useEffect)(function(){if(n.length!==0&&a.length!==0){var h=[],w=(0,In.stat_total_node_count)(n),p=(0,In.stat_total_relation_count)(a);console.log("Node Count: ",w,"Edge Count: ",p),h.push({data:[{labels:["Node Count","Edge Count"],values:[w,p],type:"pie",textinfo:"value"}],layout:m()({},bn("Total Count","Type","Count",!0))});var u=ia(n,"resource"),f=Object.keys(u).map(function(O){return{x:u[O].map(function(_){return _.entity_type}),y:u[O].map(function(_){return _.entity_count}),type:"bar",name:O}});h.push({data:f,layout:m()(m()({},bn("Node Count","Node Type","Count",!0)),{},{barmode:"stack"})}),u=ia(n,"entity_type"),f=Object.keys(u).map(function(O){return{x:u[O].map(function(_){return _.resource}),y:u[O].map(function(_){return _.entity_count}),type:"bar",name:O}}),h.push({data:f,layout:m()(m()({},bn("Node Count","Source","Count",!0)),{},{barmode:"stack"})});var b=ia(xi(a,"start_entity_type","end_entity_type","rel"),"rel"),L=Object.keys(b).map(function(O){return{x:b[O].map(function(_){return _.resource}),y:b[O].map(function(_){return _.relation_count}),type:"bar",name:O}});h.push({data:L,layout:m()(m()({},bn("Relation Count","Source","Count",!0)),{},{barmode:"stack"})}),b=ia(xi(a,"start_entity_type","end_entity_type","rel"),"resource"),L=Object.keys(b).map(function(O){return{x:b[O].map(function(_){return _.rel}),y:b[O].map(function(_){return _.relation_count}),type:"bar",name:O}}),h.push({data:L,layout:m()(m()({},bn("Relation Count","Relationship Type","Count",!0)),{},{barmode:"stack"})}),d(h);var D="grey",k="lightgrey",U="white",F=[],T=Ni(n,"entity_type","resource","entity_count"),z=Array.from(new Set(n.map(function(O){return O.resource}))),C=Ci(T.map(function(O){var _=[O.entity_type];return _.concat(z.map(function(Ie){var me=at.Z.snakeCase(Ie);return O[me]===void 0?0:O[me]}))})),j=C[0].length,I=Array.from({length:j},function(O,_){return _%2===0?k:U}),R={type:"table",header:{values:["Node Type"].concat(z),align:["center","center"],line:{width:1,color:"black"},fill:{color:D},font:{family:"Arial",size:12,color:"white"}},cells:{values:C,align:["center","center"],line:{color:"black",width:1},fill:{color:[I]},font:{family:"Arial",size:11,color:["black"]},height:30,format:[[void 0,void 0],[void 0,",d"]]}};console.log("Table: ",R,T,z,C),F.push({data:[R],layout:{title:"Node Count"}});var Q=_c(a,"resource","relation_type","relation_count");T=Ni(Q,"relation_type","resource","relation_count"),z=Array.from(new Set(a.map(function(O){return O.resource}))),C=Ci(T.map(function(O){var _=[O.relation_type];return _.concat(z.map(function(Ie){var me=at.Z.snakeCase(Ie);return O[me]===void 0?0:O[me]}))})),j=C[0].length,I=Array.from({length:j},function(O,_){return _%2===0?k:U});var se={type:"table",header:{values:["Relationship Type"].concat(z),align:["center","center"],line:{width:1,color:"black"},fill:{color:D},font:{family:"Arial",size:12,color:"white"}},cells:{values:C,align:["center","center"],line:{color:"black",width:1},fill:{color:[I]},font:{family:"Arial",size:11,color:["black"]},height:30,format:[[void 0,void 0],[void 0,",d"]]},columnwidth:Array.from({length:z.length},function(O,_){return _==0?150:50})};console.log("Table: ",se,T,z,C),F.push({data:[se],layout:{title:"Relationship Count"}}),M(F)}},[n,a]);var N=function(w){for(var p="",u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",f=u.length,b=0;b<w;)p+=u.charAt(Math.floor(Math.random()*f)),b+=1;return p};return(0,t.jsxs)(Tt.Z,{defaultActiveKey:["charts","tables"],children:[(0,t.jsx)(Tt.Z.Panel,{header:"Charts",children:(0,t.jsx)(_e.Z,{className:"complex-chart",children:o.length===0?(0,t.jsx)(Ze.Z,{span:24,children:(0,t.jsx)(Oe.Z,{})}):o.map(function(h,w){return(0,t.jsx)(Ze.Z,{span:12,style:{height:"350px",marginBottom:"10px"},children:(0,t.jsx)(vn,{mode:"Plotly",plotlyData:h,divId:"".concat(N(5)),forceResize:!0})},w)})})},"charts"),(0,t.jsx)(Tt.Z.Panel,{header:"Tables",children:(0,t.jsx)(_e.Z,{className:"complex-chart",children:S.length===0?(0,t.jsx)(Ze.Z,{span:24,children:(0,t.jsx)(Oe.Z,{})}):S.map(function(h,w){return(0,t.jsx)(Ze.Z,{span:24,style:{height:"350px",marginBottom:"10px"},children:(0,t.jsx)(vn,{mode:"Plotly",plotlyData:h,divId:"".concat(N(5)),forceResize:!0})},w)})})},"tables")]})},Ii=Gc,Fc=function(e,n,a,r){return{title:{text:e,font:{family:"Arial",size:"1.3rem",color:"#333333"},xref:"paper",x:0},xaxis:{zeroline:!0,zerolinecolor:"#333333",zerolinewidth:1,tickangle:315,title:{text:n,font:{family:"Arial",size:"1.1rem",color:"#333333"}},tickfont:{family:"Arial",size:"1rem",color:"#333333"},showgrid:!1,margin:{l:50,r:50,b:50,t:50,pad:4},automargin:r},yaxis:{title:{text:a,font:{family:"Arial",size:"1.1rem",color:"#333333"}},tickfont:{family:"Arial",size:"1rem",color:"#333333"},showgrid:!1,zeroline:!0,zerolinecolor:"#333333",zerolinewidth:1,margin:{l:50,r:50,b:50,t:50,pad:4},automargin:r},plot_bgcolor:"#ffffff",paper_bgcolor:"#ffffff"}},Uc=function(e){for(var n="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",r=a.length,i=0;i<e;)n+=a.charAt(Math.floor(Math.random()*r)),i+=1;return n},Yc=function(e){var n=(0,s.useContext)(La),a=(0,s.useState)([]),r=v()(a,2),i=r[0],o=r[1],d=(0,s.useState)(Uc(5)),c=v()(d,2),y=c[0],S=c[1];(0,s.useEffect)(function(){var N=e.selectedNodeIds||[];if(console.log("graphinContext.selectedNodes: ",n,n.selectedNodes),n.selectedNodes){var h;N=N.concat((h=n.selectedNodes)===null||h===void 0?void 0:h.map(function(f){return f.data.id}))}if(e.data.length!==0){var w=[],p=[],u={};e.data.forEach(function(f){u[f.entity_type]?u[f.entity_type].push(f):u[f.entity_type]=[f]}),Object.keys(u).forEach(function(f){var b=u[f],L=[0],D=[0];e.method==="tsne"?(L=b.map(function(T){return T.tsne_x||0}),D=b.map(function(T){return T.tsne_y||0})):e.method==="umap"&&(L=b.map(function(T){return T.umap_x||0}),D=b.map(function(T){return T.umap_y||0}));var k=b.map(function(T){return T.entity_type}),U=[];N?U=b.map(function(T){return console.log("item.data.id: ",T.entity_id,N),N.includes(T.entity_id)?T.entity_name:""}):U=b.map(function(T){return T.entity_name});var F=b.map(function(T){return T.entity_id});p.push({x:L,y:D,type:"scatter",mode:"markers+text",textposition:"bottom center",text:U,customdata:b,name:k[0],extra:F,marker:{color:b[0].color||"blue",size:10},hovertemplate:"<b>%{customdata.entity_name}</b><br>%{customdata.entity_id}<br>%{yaxis.title.text}: %{y}<br>%{xaxis.title.text}: %{x}<br><extra></extra>",texttemplate:"%{text}"})}),w.push({data:p,layout:Fc("","X","Y",!1)}),console.log("localCharts: ",w),o(w)}},[e.data,e.selectedNodeIds,n.selectedNodes]);var M=function(h){if(h.points.length===1){var w=h.points[0];w.customdata&&e.onClick&&e.onClick(w.customdata)}else console.log("onPlotlyClick: ",h),B.ZP.info("Please click one node to focus.")};return(0,t.jsxs)(_e.Z,{className:"complex-chart",children:[e.description?(0,t.jsx)("span",{className:"notice",children:e.description}):null,i.length===0?(0,t.jsx)(Ze.Z,{span:24,children:(0,t.jsx)(Oe.Z,{})}):i.map(function(N,h){return(0,t.jsx)(Ze.Z,{span:24,style:{height:"400px"},children:(0,t.jsx)(vn,{mode:"Plotly",plotlyData:N,divId:"".concat(y),onClick:M,forceResize:!0})},h)})]})},bi=Yc,Ra=g(47009),Wu=g(51906),Hu=g(92854),Ku=g(31115),Bc={type:"fitCellContents"},Qc=function(e){switch(e){case"number":return"agNumberColumnFilter";case"date":return"agDateColumnFilter";case"boolean":return"agSetColumnFilter";case"object":return"agTextColumnFilter";default:return"agTextColumnFilter"}},Vc=function(e){switch(e){case"number":return!0;case"date":return!0;case"boolean":return!1;case"object":return!1;default:return!0}},Wc=function(e){return at.Z.titleCase(e.replace(/_/g," "))},Hc=function(e){return e.map(function(n){return Object.keys(n).forEach(function(a){Rt()(n[a])==="object"&&delete n[a]}),n})},Gt=function(e,n,a,r,i){var o={field:e,filter:Qc(n),headerName:Wc(e),enableRowGroup:Vc(n),hide:a||!1};return i&&(o.minWidth=i),r&&(o.cellRenderer=r),o},Kc=function(e){var n=(0,s.useRef)(),a=(0,s.useMemo)(function(){return{width:"100%",height:"100%"}},[]),r=(0,s.useMemo)(function(){return{height:"100%",width:"100%"}},[]),i=(0,s.useState)(Hc(e.nodes)),o=v()(i,2),d=o[0],c=o[1],y=(0,s.useState)([]),S=v()(y,2),M=S[0],N=S[1],h=(0,s.useRef)([]);(0,s.useEffect)(function(){h.current=M},[M]);var w=["id","label","name","resource","description","degree","cluster"],p=(0,s.useState)([{headerName:"#",cellRenderer:function(z){return z.node.rowIndex+1},headerCheckboxSelection:!0,checkboxSelection:!0,showDisabledCheckboxes:!0,filter:"agTextColumnFilter"},Gt("id","string",!0),Gt("label","string"),Gt("name","string",!1,function(T){return console.log("NodeTable - makeField - name - params: ",T,Mn(T.label)),(0,t.jsx)("a",{href:Mn(T.label),target:"_blank",children:T.value})}),Gt("resource","string"),Gt("cluster","string"),Gt("description","string"),Gt("degree","number")]),u=v()(p,2),f=u[0],b=u[1];(0,s.useEffect)(function(){var T=e.nodes.map(function(j){return Object.keys(j).map(function(I){return{field:I,type:Rt()(j[I])}})}).reduce(function(j,I){return j.concat(I)},[]).filter(function(j,I,R){return R.findIndex(function(Q){return Q.field===j.field})===I});console.log("NodeTable - useEffect - allColumns: ",T);var z=T.filter(function(j){if(!w.includes(j.field))return!0});console.log("NodeTable - useEffect - additionalColumns: ",z);var C=z.map(function(j){return Gt(j.field,j.type,!0)});console.log("NodeTable - useEffect - additionalColumnDefs: ",C),b(f.concat(C))},[e.nodes]);var L=(0,s.useMemo)(function(){return{flex:1,filter:!0}},[]),D=(0,s.useCallback)(function(T){if(!(!n.current||n.current&&!n.current.api)){var z=h.current,C=n.current.api.getSelectedRows();console.log("NodeTable - onSelectedChanged - selectedRows: ",z,C),N(C),T.source!=="gridInitializing"&&e.onSelectedRows&&e.onSelectedRows(C,z)}},[]),k=function(z){z.api.forEachNode(function(C){if(console.log("onGridReady - node: ",C),C.data&&(e.selectedKeys&&e.selectedKeys.includes(C.data.id)?C.setSelected(!0,!1,"gridInitializing"):C.setSelected(!1,!1,"gridInitializing")),C.aggData){var j=C.aggData&&C.aggData.id&&C.aggData.id.split(",");j.length>0&&C.childrenAfterGroup.forEach(function(I){e.selectedKeys&&e.selectedKeys.includes(I.data.id)?I.setSelected(!0,!1,"gridInitializing"):I.setSelected(!1,!1,"gridInitializing")})}})};(0,s.useEffect)(function(){!n.current||n.current&&!n.current.api||k(n.current)},[e.selectedKeys,e.nodes]);var U=(0,s.useMemo)(function(){return{statusPanels:[{statusPanel:"agTotalAndFilteredRowCountComponent",align:"left"},{statusPanel:"agTotalRowCountComponent",align:"center"},{statusPanel:"agFilteredRowCountComponent"},{statusPanel:"agSelectedRowCountComponent"},{statusPanel:"agAggregationComponent"}]}},[]),F=function(z){if(console.log("onColumnRowGroupChanged: ",z),z.column.rowGroupActive){var C=f.map(function(I){return I.headerName==="#"?m()(m()({},I),{},{hide:!0}):I});b(C)}else{var j=f.map(function(I){return I.headerName==="#"?m()(m()({},I),{},{hide:!1}):I});b(j)}};return(0,t.jsx)("div",{style:a,children:(0,t.jsx)("div",{style:m()(m()({},r),e.style),className:"ag-theme-quartz",children:(0,t.jsx)(Ra.AgGridReact,{ref:n,rowData:d,columnDefs:f,rowSelection:"multiple",defaultColDef:L,enableAdvancedFilter:!0,groupSelectsChildren:!0,rowGroupPanelShow:"always",suppressRowClickSelection:!0,sideBar:!1,statusBar:U,enableCellTextSelection:!0,enableBrowserTooltips:!0,rowMultiSelectWithClick:!0,onGridReady:k,onColumnRowGroupChanged:F,autoSizeStrategy:Bc,onSelectionChanged:D})})})},wi=Kc,Jc=function(e){switch(e){case"number":return"agNumberColumnFilter";case"date":return"agDateColumnFilter";case"boolean":return"agSetColumnFilter";case"object":return"agTextColumnFilter";default:return"agTextColumnFilter"}},$c=function(e){switch(e){case"number":return!0;case"date":return!0;case"boolean":return!1;case"object":return!1;default:return!0}},Xc=function(e){return at.Z.titleCase(e.replace(/_/g," "))},qc=function(e){switch(e){case"number":return"avg";default:return function(n){return n.values.length===0?null:(0,X.uniq)(n.values).join(",")}}},wn=function(e,n,a,r,i){var o={field:e,filter:Jc(n),headerName:Xc(e),enableRowGroup:$c(n),hide:a||!1,tooltipField:e,aggFunc:qc(n)};return i?o.minWidth=i:o.minWidth=50,r&&(o.cellRenderer=r),o},ed=function(e){return e.map(function(n){return Object.keys(n).forEach(function(a){Rt()(n[a])==="object"&&delete n[a]}),n})},td=function(e){var n=(0,s.useRef)(),a=(0,s.useMemo)(function(){return{width:"100%",height:"100%"}},[]),r=(0,s.useMemo)(function(){return{height:"100%",width:"100%"}},[]),i=(0,s.useState)(ed(e.edges)),o=v()(i,2),d=o[0],c=o[1],y=(0,s.useState)([]),S=v()(y,2),M=S[0],N=S[1],h=(0,s.useRef)([]);(0,s.useEffect)(function(){h.current=M},[M]);var w=["reltype","source_name","target_name","score","source_type","target_type","source_id","target_id"],p=(0,s.useState)([{headerName:"#",cellRenderer:function(j){return j.node.rowIndex+1},headerCheckboxSelection:!0,checkboxSelection:!0,showDisabledCheckboxes:!0,filter:"agTextColumnFilter"}]),u=v()(p,2),f=u[0],b=u[1],L={type:"fitCellContents"};(0,s.useEffect)(function(){var C=e.edges.map(function(Q){return Object.keys(Q).map(function(se){return{field:se,type:Rt()(Q[se])}})}).reduce(function(Q,se){return Q.concat(se)},[]).filter(function(Q,se,O){return O.findIndex(function(_){return _.field===Q.field})===se});console.log("EdgeTable - useEffect - allColumns: ",C);var j=C.map(function(Q){return T(Q)});console.log("EdgeTable - useEffect - columnDefs: ",j);var I=(0,X.uniqBy)(f.concat(j),"field"),R=I.sort(function(Q,se){return w.indexOf(Q.field)-w.indexOf(se.field)});b(R)},[e.edges]);var D=(0,s.useMemo)(function(){return{flex:1,filter:!0}},[]),k=(0,s.useCallback)(function(C){if(!(!n.current||n.current&&!n.current.api)){var j=h.current,I=n.current.api.getSelectedRows();console.log("EdgeTable - onSelectedChanged - selectedRows: ",j,I),N(I),C.source!=="gridInitializing"&&e.onSelectedRows&&e.onSelectedRows(I,j)}},[]),U=function(j){console.log("onGridReady - selectedKeys: ",e.selectedKeys),j.api.forEachNode(function(I){if(console.log("onGridReady - node: ",I),I.data&&(e.selectedKeys&&e.selectedKeys.includes(I.data.relid)?I.setSelected(!0,!1,"gridInitializing"):I.setSelected(!1,!1,"gridInitializing")),I.aggData){var R=I.aggData&&I.aggData.relid&&I.aggData.relid.split(",");R.length>0&&I.childrenAfterGroup.forEach(function(Q){e.selectedKeys&&e.selectedKeys.includes(Q.data.relid)?Q.setSelected(!0,!1,"gridInitializing"):Q.setSelected(!1,!1,"gridInitializing")})}})};(0,s.useEffect)(function(){!n.current||n.current&&!n.current.api||U(n.current)},[e.selectedKeys,e.edges]);var F=(0,s.useMemo)(function(){return{statusPanels:[{statusPanel:"agTotalAndFilteredRowCountComponent",align:"left"},{statusPanel:"agTotalRowCountComponent",align:"center"},{statusPanel:"agFilteredRowCountComponent"},{statusPanel:"agSelectedRowCountComponent"},{statusPanel:"agAggregationComponent"}]}},[]),T=function(j){return j.field==="source_name"?wn(j.field,j.type,!1,function(I){return console.log("EdgeTable - makeField4Link - source_name: ",I.value),(0,t.jsx)("a",{href:Mn(I.data&&I.data.source_id),target:"_blank",children:I.value})},150):j.field==="reltype"?wn(j.field,j.type,!1,function(I){if(console.log("EdgeTable - makeField4Link - reltype: ",I,e.edgeStat),e.edgeStat){var R=e.edgeStat.find(function(se){return se.relation_type===I.value}),Q=R&&R.description?R.description:"";return(0,t.jsx)("span",{title:Q,style:{cursor:"help"},children:I.value})}else return I.value},150):j.field==="target_name"?wn(j.field,j.type,!1,function(I){return console.log("EdgeTable - makeField4Link - target_name: ",I.value),(0,t.jsx)("a",{href:Mn(I.data&&I.data.target_id),target:"_blank",children:I.value})},180):w.includes(j.field)?wn(j.field,j.type,!1):wn(j.field,j.type,!0)},z=function(j){if(console.log("onColumnRowGroupChanged: ",j),j.column.rowGroupActive){var I=f.map(function(Q){return Q.headerName==="#"?m()(m()({},Q),{},{hide:!0}):Q});b(I)}else{var R=f.map(function(Q){return Q.headerName==="#"?m()(m()({},Q),{},{hide:!1}):Q});b(R)}};return(0,t.jsx)("div",{style:a,children:(0,t.jsx)("div",{style:m()(m()({},r),e.style),className:"ag-theme-quartz",children:(0,t.jsx)(Ra.AgGridReact,{ref:n,rowData:d,columnDefs:f,rowSelection:"multiple",defaultColDef:D,enableAdvancedFilter:!0,groupSelectsChildren:!0,rowGroupPanelShow:"always",suppressRowClickSelection:!0,sideBar:!1,groupAllowUnbalanced:!0,enableCellTextSelection:!0,enableBrowserTooltips:!0,rowMultiSelectWithClick:!0,statusBar:F,onGridReady:U,onSelectionChanged:k,autoSizeStrategy:L,getContextMenuItems:function(j){var I,R,Q=[{name:"Explain the Current Predicted Relation",action:function(){var O=j.api.getSelectedRows();O.length===1&&e.onExplainRow&&e.onExplainRow(O[0])},disabled:!(e.onExplainRow&&(I=j.node)!==null&&I!==void 0&&I.isSelected()&&j.api.getSelectedRows().length===1)},"separator",{name:"Delete Selected Relations (Only)",action:function(){var O=j.api.getSelectedRows();j.api.applyTransaction({remove:O}),e.onDeletedRows&&e.onDeletedRows(O,[])},disabled:!((R=j.node)!==null&&R!==void 0&&R.isSelected())},{name:"Delete Selected Relations and Nodes",action:function(){var O=j.api.getSelectedRows(),_=O.map(function(Ae){return[{id:Ae.source_id,label:Ae.source_type},{id:Ae.target_id,label:Ae.target_type}]}).flat();if(_.length>0){var Ie=(0,X.uniqBy)(_,"id"),me=Ie.map(function(Ae){return{id:Ae.id,label:Ae.label}});j.api.applyTransaction({remove:O}),e.onDeletedRows&&e.onDeletedRows(O,me)}},disabled:!j.node.isSelected()},"separator","copy","copyWithHeaders","copyWithGroupHeaders","separator","autoSizeAll","resetColumns","expandAll","contractAll","separator","export"];return Q}})})})},Li=td,nd=function(e){var n=s.Children.count(e.children),a=s.Children.toArray(e.children),r=[{label:"Edges",key:"edges",children:n>=2?a[1]:"No Content",disabled:e.edgeTabDisabled},{label:"Nodes",key:"nodes",children:n>=2?a[0]:"No Content",disabled:e.nodeTabDisabled}];return(0,t.jsx)(Sn.Z,{className:"graph-table",items:r,tabPosition:"right",size:"small",tabBarExtraContent:e.onClose?(0,t.jsx)(q.ZP,{type:"text",icon:(0,t.jsx)(Br.Z,{}),onClick:function(){e.onClose&&e.onClose()}}):e.onLoadGraph?{left:(0,t.jsx)(q.ZP,{onClick:function(o){o.stopPropagation(),e.onLoadGraph&&e.onLoadGraph()},icon:(0,t.jsx)(ba.Z,{}),type:"primary",style:{margin:"5px"},children:"Explain"})}:null})},ad=(0,s.memo)(nd),rd=function(e){var n=(0,s.useContext)(La),a=n.graph,r=e.emptyMessage||"No data",i=(0,s.useState)([]),o=v()(i,2),d=o[0],c=o[1],y=(0,s.useState)({nodes:[],edges:[]}),S=v()(y,2),M=S[0],N=S[1],h=function(f,b){var L=e.nodeDataSources.filter(function(k){return f.includes(k.id)}).map(function(k){return k.metadata}),D=e.edgeDataSources.filter(function(k){return b.includes(k.relid)}).map(function(k){return k.metadata});return{nodes:L,edges:D}},w=function(f){var b=e.nodeDataSources.filter(function(D){return!f.includes(D.id)}).map(function(D){return D.metadata}),L=e.edgeDataSources.filter(function(D){return!f.includes(D.source)&&!f.includes(D.target)}).map(function(D){return D.metadata});return{nodes:b,edges:L}},p=function(){var f=e.nodeDataSources.map(function(L){return L.metadata}).filter(function(L){return L!==void 0}),b=e.edgeDataSources.map(function(L){return L.metadata}).filter(function(L){return L!==void 0});N({nodes:f,edges:b})};return(0,s.useEffect)(function(){var u=[];e.edgeDataSources.forEach(function(f){var b=f.source,L=f.target,D=e.nodeDataSources.find(function(U){return U.id===b}),k=e.nodeDataSources.find(function(U){return U.id===L});!D||!k||u.push(m()(m()({},f),{},{source_name:D.name,target_name:k.name,source_resource:D.resource,target_resource:k.resource,source_description:D.description,target_description:k.description}))}),c(u),p()},[e.nodeDataSources,e.edgeDataSources]),(0,t.jsxs)(ad,{onClose:e.onClose,onLoadGraph:e.onLoadGraph?function(){e.onLoadGraph(M)}:void 0,children:[e.nodeDataSources.length>0?(0,t.jsx)(wi,{nodes:e.nodeDataSources,selectedKeys:e.selectedNodeKeys,onSelectedRows:function(f,b){var L=(0,X.uniq)(f.map(function(U){return U.id})),D=(0,X.uniq)(b.map(function(U){return U.id}));if(!(L.length===0||!a)){var k=h(L,[]);console.log("selectedRows: ",f,b,k),N(k),e.onSelectedNodes&&e.onSelectedNodes(f).then(function(U){L===e.selectedNodeKeys||L===D||console.log("onSelectedRows: ",L,e.selectedNodeKeys,e.selectedEdgeKeys,D,a)})}},style:e.style?e.style:{minHeight:"300px",height:"300px"}},e.nodeDataSources.map(function(u){return u.id}).join(",")):(0,t.jsx)(Oe.Z,{description:r}),d.length>0?(0,t.jsx)(Li,{edgeStat:e.edgeStat,edges:d,selectedKeys:e.selectedEdgeKeys,onExplainRow:e.onExplainRow,onSelectedRows:function(f,b){var L=(0,X.uniq)(f.map(function(U){return U.relid})),D=(0,X.uniq)(f.map(function(U){return U.source}).concat(f.map(function(U){return U.target}))),k=h(D,L);console.log("selectedRows: ",f,b,k),N(k),e.onSelectedEdges&&e.onSelectedEdges(f).then(function(U){var F=(0,X.uniq)(b.map(function(z){return z.source}).concat(b.map(function(z){return z.target}))),T=(0,X.uniq)(b.map(function(z){return z.relid}));L.length===0||!a||D.length===0||L===e.selectedEdgeKeys||L===T&&D===F||console.log("onSelectedRows: ",L,D,T,F,a)})},onDeletedRows:function(f,b){var L=a==null?void 0:a.save();e.onDeletedEdges&&e.onDeletedEdges(f,b).then(function(D){}).catch(function(D){console.error("onDeletedEdges error: ",D)})},style:e.style?e.style:{minHeight:"300px",height:"60vh"}}):(0,t.jsx)(Oe.Z,{description:r})]})},Ti=(0,s.memo)(rd),Di=g(48013),id=function(e){switch(e){case"number":return"agNumberColumnFilter";case"date":return"agDateColumnFilter";case"boolean":return"agSetColumnFilter";case"object":return"agTextColumnFilter";default:return"agTextColumnFilter"}},od=function(e){switch(e){case"number":return!0;case"date":return!0;case"boolean":return!1;case"object":return!1;default:return!0}},ld=function(e){return at.Z.titleCase(e.replace(/_/g," "))},sd=function(e){switch(e){case"number":return"avg";default:return function(n){return n.values.length===0?null:(0,X.uniq)(n.values).join(",")}}},Ei=function(e,n,a,r,i){var o={field:e,filter:id(n),headerName:ld(e),enableRowGroup:od(n),hide:a||!1,tooltipField:e,aggFunc:sd(n)};return i?o.minWidth=i:o.minWidth=50,r&&(o.cellRenderer=r),o},cd=function(e){return e.map(function(n){return Object.keys(n).forEach(function(a){Rt()(n[a])==="object"&&delete n[a]}),n})},dd=function(){var l=Kt()(We()().mark(function e(n){var a;return We()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,Di.ZP)();case 2:return a=Di.Sb(n,void 0),i.abrupt("return",a.map(function(o){return{entity_id:o.entity_id,entity_type:o.entity_type,entity_name:o.entity_name,betweenness_score:o.betweenness_score,degree_score:o.degree_score,closeness_score:o.closeness_score,eigenvector_score:o.eigenvector_score,pagerank_score:o.pagerank_score}}));case 4:case"end":return i.stop()}},e)}));return function(n){return l.apply(this,arguments)}}(),ud=function(e){var n=(0,s.useRef)(),a=(0,s.useMemo)(function(){return{width:"100%",height:"100%"}},[]),r=(0,s.useMemo)(function(){return{height:"100%",width:"100%"}},[]),i=(0,s.useState)([]),o=v()(i,2),d=o[0],c=o[1],y=(0,s.useState)([]),S=v()(y,2),M=S[0],N=S[1];(0,s.useEffect)(function(){var T=cd(e.edges);dd(T).then(function(z){console.log("EdgeTable - useEffect - calculate_centrality - result: ",z),c(z)})},[e.edges]);var h=(0,s.useRef)([]);(0,s.useEffect)(function(){h.current=M},[M]);var w=["entity_id","entity_type","entity_name","betweenness_score","degree_score","closeness_score","eigenvector_score","pagerank_score"],p=(0,s.useState)([{headerName:"#",cellRenderer:function(z){return z.node.rowIndex+1},headerCheckboxSelection:!0,checkboxSelection:!0,showDisabledCheckboxes:!0,filter:"agTextColumnFilter"}].concat(Ne()(w.map(function(T){return T.endsWith("_score")?Ei(T,"number",!1,function(z){return z.value.toFixed(3)}):Ei(T,"string")})))),u=v()(p,2),f=u[0],b=u[1],L={type:"fitCellContents"},D=(0,s.useMemo)(function(){return{flex:1,filter:!0}},[]),k=(0,s.useCallback)(function(T){if(!(!n.current||n.current&&!n.current.api)){var z=h.current,C=n.current.api.getSelectedRows();console.log("MetricsTable - onSelectedChanged - selectedRows: ",z,C),N(C),T.source!=="gridInitializing"&&e.onSelectedRows&&e.onSelectedRows(C,z)}},[]),U=function(z){};(0,s.useEffect)(function(){!n.current||n.current&&!n.current.api||U(n.current)},[e.edges]);var F=(0,s.useMemo)(function(){return{statusPanels:[{statusPanel:"agTotalAndFilteredRowCountComponent",align:"left"},{statusPanel:"agTotalRowCountComponent",align:"center"},{statusPanel:"agFilteredRowCountComponent"},{statusPanel:"agSelectedRowCountComponent"},{statusPanel:"agAggregationComponent"}]}},[]);return(0,t.jsx)("div",{style:a,children:(0,t.jsx)("div",{style:m()(m()({},r),e.style),className:"ag-theme-quartz",children:(0,t.jsx)(Ra.AgGridReact,{ref:n,rowData:d,columnDefs:f,rowSelection:"multiple",defaultColDef:D,enableAdvancedFilter:!0,groupSelectsChildren:!0,rowGroupPanelShow:"always",suppressRowClickSelection:!0,sideBar:!1,groupAllowUnbalanced:!0,enableCellTextSelection:!0,enableBrowserTooltips:!0,rowMultiSelectWithClick:!0,statusBar:F,onGridReady:U,onSelectionChanged:k,autoSizeStrategy:L,getContextMenuItems:function(z){var C=["copy","copyWithHeaders","copyWithGroupHeaders","separator","autoSizeAll","resetColumns","expandAll","contractAll","separator","export"];return C}})})})},hd=ud,fd=g(68666),gd=function(e){var n={name:"file",action:"/api/upload",showUploadList:!1,beforeUpload:function(r){var i=new FileReader;return i.readAsText(r),i.onload=function(){try{var o=JSON.parse(i.result);e.onUpload&&e.onUpload(o)}catch(d){za.ZP.error({message:"Failed to parse file",description:"Please make sure the file is a valid JSON file"})}},i.onerror=function(o){B.ZP.error("Failed to read file")},!1}};return(0,t.jsx)(ci.Z,m()(m()({},n),{},{children:(0,t.jsx)(q.ZP,{icon:(0,t.jsx)(di.Z,{}),children:"Upload"})}))},yd=gd,pd=fd.Z.DirectoryTree,md=function(e){var n={};e.forEach(function(o){n[o.id]=o});var a=[];e.forEach(function(o){if(console.log("parent: ",o.parent,"id: ",o.id),o.parent===o.id){var d=m()(m()({},o),{},{title:o.name,key:o.id});a.push(d)}else{var c=n[o.parent||""];c&&(c.children=c.children||[],c.children.push(m()(m()({},o),{},{title:o.name+"-"+o.id.slice(0,8),key:o.id,isLeaf:!0})))}});var r=function o(d){var c=[];return d.forEach(function(y){y.children?c=c.concat(o(y.children).concat([m()(m()({},y),{},{children:void 0})])):c.push(y)}),c},i=[];return a.forEach(function(o){o.children?o.children=r(o.children).concat(m()(m()({},o),{},{children:void 0})):o.children=[m()(m()({},o),{},{children:void 0})],i.push(o)}),console.log("makeTree",e,n,a,i),i},vd=function(e){var n=6,a=s.useState(!1),r=v()(a,2),i=r[0],o=r[1],d=s.useState([]),c=v()(d,2),y=c[0],S=c[1],M=s.useState([]),N=v()(M,2),h=N[0],w=N[1],p=s.useState([]),u=v()(p,2),f=u[0],b=u[1],L=s.useState(n),D=v()(L,2),k=D[0],U=D[1],F=[{title:"Name",dataIndex:"name",key:"name",align:"center",width:150,fixed:"left"},{title:"Created At",dataIndex:"created_time",key:"created_time",align:"center",render:function(j){return new Date(j).toLocaleString()},width:200},{title:"Version",key:"version",align:"center",dataIndex:"version",width:100},{title:"UUID",key:"id",align:"center",dataIndex:"id",width:200},{title:"DB Version",key:"db_version",align:"center",dataIndex:"db_version",width:150},{title:"Action",key:"action",align:"center",fixed:"right",width:240,render:function(j,I,R){return(0,t.jsxs)(jn.Z,{size:"small",children:[(0,t.jsxs)(q.ZP,{size:"small",type:"link",disabled:e.selectedGraphId===I.id,onClick:function(se){if(o(!0),f){var O=f[R];O&&e.onLoad&&e.onLoad(I,O).finally(function(){return o(!1)})}else console.log("GraphTable load: something wrong.",f,R,I),e.onLoad&&e.onLoad(I,I).finally(function(){return o(!1)})},children:["Load",e.selectedGraphId===I.id?"ed":""]}),(0,t.jsx)(q.ZP,{size:"small",type:"link",onClick:function(se){o(!0);var O=JSON.stringify(I),_=new Blob([O],{type:"application/json"}),Ie=URL.createObjectURL(_),me=document.createElement("a");me.href=Ie,me.download=I.name+".json",document.body.appendChild(me),me.click(),document.body.removeChild(me),o(!1)},children:"Download"}),(0,t.jsx)(q.ZP,{size:"small",type:"link",danger:!0,onClick:function(se){o(!0),e.onDelete&&e.onDelete(I).finally(function(){return o(!1)})},children:"Delete"})]})}}],T=function(j,I){if(console.log("Trigger Select",j,I),I.selectedNodes[0]&&I.selectedNodes[0].children){var R=I.selectedNodes[0];b(R.children),w(j)}else w([]),b([])},z=function(j,I){console.log("Trigger Expand",j,I)};return(0,s.useEffect)(function(){if(e.treeFormat&&e.graphs&&e.graphs.length>0){var C=md(e.graphs);S(C);var j=C[0]?C[0].children:[];b(j),U(n),w(C[0]?[C[0].key]:[])}else b(e.graphs||[]),U(0)},[e.graphs]),(0,t.jsx)(on.Z,{className:"graph-table",title:"Graph Table",open:e.visible,width:1e3,closable:!0,onCancel:e.onClose?e.onClose:function(){},getContainer:e.parent?e.parent:document.body,footer:e.onUpload?[(0,t.jsx)(yd,{onUpload:function(j){if(o(!0),e.onUpload){var I=j;delete I.parent,delete I.created_time,e.onUpload(I).finally(function(){return o(!1)})}}},"upload-graph")]:null,children:(0,t.jsx)(Wn.Z,{spinning:i,children:(0,t.jsxs)(_e.Z,{gutter:16,children:[(0,t.jsx)(Ze.Z,{span:k,children:e.treeFormat?(0,t.jsx)(pd,{defaultExpandAll:!0,selectedKeys:h,onSelect:T,onExpand:z,treeData:y,fieldNames:{title:"title",key:"key",children:"notShown"}}):null}),(0,t.jsx)(Ze.Z,{span:24-k,children:(0,t.jsx)(Vn.Z,{rowKey:"id",columns:F,dataSource:f,pagination:!1,scroll:{y:500,x:800},size:"small",expandable:{expandedRowRender:function(j){return(0,t.jsx)("p",{style:{margin:0},children:j.description||"No description"})},rowExpandable:function(j){return j.name!=="Not Expandable"}}})})]})})})},Ai=vd,Sd=function(e){var n=(0,s.useContext)(He.Z),a=n.graph,r=s.useState(!1),i=v()(r,2),o=i[0],d=i[1],c=function(){var S=Kt()(We()().mark(function M(N){var h,w,p;return We()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(d(!0),!e.payload){f.next=12;break}return h=e.payload,a&&(console.log("Save graph data which are from graphin."),h=m()(m()({},h),Ar(a))),f.next=6,Cr();case 6:w=f.sent,p=m()(m()({payload:JSON.stringify(h)},N),{},{id:"0",created_time:void 0,db_version:"v1.0.0",version:"v1.0.0"}),p=m()(m()({},p),{},{owner:w||"ANONYMOUS-USER-PLACEHOLDER"}),e.onSubmit&&e.onSubmit(p).then(function(){d(!1)}).catch(function(){d(!1)}),f.next=14;break;case 12:B.ZP.error("Failed to submit graph, you must provide a payload for your graph"),d(!1);case 14:case"end":return f.stop()}},M)}));return function(N){return S.apply(this,arguments)}}(),y=function(M){console.log("Failed:",M),B.ZP.error("Failed to submit graph")};return(0,t.jsx)(on.Z,{className:"graph-form",title:"Save the current graph",open:e.visible,footer:null,width:500,closable:!0,onCancel:e.onClose,destroyOnClose:!0,getContainer:e.parent?e.parent:document.body,children:(0,t.jsx)(Wn.Z,{spinning:o,tip:"Submitting...",children:(0,t.jsxs)(J.Z,{name:"basic",labelCol:{span:8},wrapperCol:{span:16},style:{maxWidth:600},initialValues:{remember:!0},onFinish:c,onFinishFailed:y,autoComplete:"off",children:[(0,t.jsx)(J.Z.Item,{label:"name",name:"name",rules:[{required:!0,message:"Please input a graph name!"}],children:(0,t.jsx)(Jt.Z,{placeholder:"Please input a graph name"})}),(0,t.jsx)(J.Z.Item,{label:"description",name:"description",rules:[{required:!1,message:"Please input description!"}],children:(0,t.jsx)(Nr.Z,{rows:5,placeholder:"Please input description!"})}),(0,t.jsx)(J.Z.Item,{wrapperCol:{offset:18,span:5},hidden:!e.onSubmit,children:(0,t.jsxs)(q.ZP,{type:"primary",htmlType:"submit",children:[(0,t.jsx)(ba.Z,{})," Submit"]})})]})})})},ki=Sd,Md=[{type:"force",title:"D3 gForce",options:[{key:"preventOverlap",title:"Prevent Overlap?",defaultValue:!0,component:"switch",description:"Whether to Prevent Node Overlap."},{key:"linkDistance",title:"Link Distance",defaultValue:250,component:"slider",min:100,max:500,description:"The Link Distance Between Two Adjacent Nodes."},{key:"nodeStrength",title:"Node Strength",defaultValue:30,component:"slider",min:10,max:100,description:"The Strength of the Force Applied to the Node."},{key:"edgeStrength",title:"Edge Strength",defaultValue:.1,component:"slider",min:0,max:1,description:"The Strength of the Force Applied to the Edge."},{key:"collideStrength",title:"Collide Strength",defaultValue:.8,component:"slider",max:1,min:0,description:"The Strength of the Force Applied to the Collision."}]},{type:"concentric",title:"Concentric",options:[{component:"slider",key:"nodeSize",title:"Node Size",defaultValue:50,description:"Node Size (Diameter) Used for Collision Detection to Prevent Node Overlap."},{component:"slider",key:"minNodeSpacing",title:"Min Node Spacing",defaultValue:10,description:"Minimum Spacing Between Rings to Adjust Radius, Default Value is 10."},{component:"switch",key:"preventOverlap",title:"Prevent Overlap?",defaultValue:!0,description:"Prevent Overlapping, when set to true, it can avoid nodes overlapping with each other; nodeSize must be configured. Node collision detection will only occur when nodeSize is set to be consistent with node size."},{component:"slider",key:"sweep",title:"Sweep",defaultValue:void 0,min:0,max:10,description:"Angular Difference Between the First Node and the Last Node."},{component:"switch",key:"equidistant",title:"Equidistant?",defaultValue:!1,description:"Is the Distance Between Rings Equal, Default is False, Setting to True Creates Visual Uniformity"},{component:"slider",key:"startAngle",title:"Start Angle",defaultValue:3/2*Math.PI,min:0,max:2*Math.PI,step:.1*Math.PI,description:"The Default Starting Radian Value for Nodes is 3 / 2 * Math.PI."},{component:"switch",key:"clockwise",title:"Clockwise?",defaultValue:!1,description:"Is Arranged in Clockwise Direction, Default is False."},{component:"select",key:"sortBy",title:"Sort By",defaultValue:"degree",enums:[{key:"degree",value:"degree"},{key:"topology",value:"topology"}],description:"Specify the Sorting Criterion, i.e., a Node's Property Name; Higher Values Result in Nodes Being Placed More Centered."}]},{type:"grid",options:[{component:"slider",key:"width",title:"Width",defaultValue:200,min:10,max:5e3,description:"The Width of the Layout"},{component:"slider",key:"height",title:"Height",defaultValue:200,min:10,max:5e3,description:"The Height of the Layout"},{component:"switch",key:"preventOverlap",title:"Prevent Overlap?",defaultValue:!0,description:"Prevent Node Overlap, when enabled, it avoids nodes from overlapping; it must be used in conjunction with the nodeSize property. Collision detection is only possible when the nodeSize is set to be the same size as the nodes in the graph."},{component:"slider",key:"preventOverlapPadding",title:"Prevent Overlap Padding",defaultValue:10,min:1,max:100,description:"Spacing Value for Nodes When Avoiding Overlap, Active when preventOverlap is True"},{component:"switch",key:"condense",title:"Condense?",defaultValue:!1,description:"True for Utilizing the Minimum Canvas Space, False for Utilizing the Entire Available Canvas Size."},{component:"slider",key:"rows",title:"Grid Rows",defaultValue:10,min:1,max:500,description:"The Number of Rows in the Grid, Default is 10"},{component:"slider",key:"cols",title:"Grid Columns",defaultValue:10,min:1,max:500,description:"The Number of Columns in the Grid, Default is 10"},{component:"select",key:"sortBy",title:"Sort By",defaultValue:void 0,enums:[{key:null,value:null},{key:"topology",value:"topology"},{key:"degree",value:"degree"}],description:"Specify the Sorting Criterion, i.e., based on which node property the sorting is performed; higher values result in nodes being placed more centrally. If not specified, the node's degree will be calculated, and nodes with higher degrees will be placed more centrally."}],title:"Grid"},{type:"radial",options:[{component:"slider",key:"linkDistance",title:"Link Distance",defaultValue:100,min:10,max:500,description:"The Link Distance Between Two Adjacent Nodes."},{component:"slider",key:"maxIteration",title:"Max Iteration",defaultValue:1e3,min:100,max:1e4,description:"The Maximum Number of Iterations. If you don't want to wait too long, you can set a smaller value."},{component:"switch",key:"preventOverlap",title:"Prevent Overlap?",defaultValue:!0,description:"Whether to Prevent Node Overlap."},{component:"slider",key:"nodeSize",title:"Node Size",defaultValue:30,min:10,max:100,description:"The Size of the Node, Used for Collision Detection to Prevent Node Overlap."},{component:"slider",key:"nodeSpacing",title:"Node Spacing",defaultValue:10,min:0,max:100,description:"The Spacing Between Nodes. It is only valid when the preventOverlap property is true."},{component:"slider",key:"unitRadius",title:"Unit Radius",defaultValue:100,min:10,max:500,description:"The Radius of the Circle."},{component:"switch",key:"strictRadial",title:"Strict Radial?",defaultValue:!1,description:"Whether the Layout is Strictly Radial. It is only valid when the preventOverlap property is true. When you set it to true, the overlaped nodes will be shown in the side of the circle for a better visual effect."},{component:"select",key:"sortBy",title:"Sort By",defaultValue:void 0,enums:[{key:null,value:null},{key:"data",value:"data"},{key:"nlabel",value:"nlabel"},{key:"name",value:"name"}],description:"The Property of the Node Used for Sorting. The nodes in the same layer will be sorted by this property. All nodes have the closer value will be placed in the same layer as much as possible."},{component:"slider",key:"sortStrength",title:"Sort Strength",defaultValue:100,min:0,max:1e3,description:"The Strength of the Force Applied to the Node."},{component:"switch",key:"workerEnabled",title:"Worker Enabled?",defaultValue:!0,description:"Whether to Enable Web Worker for Layout Calculation to Improve Performance."}],title:"Radial"},{type:"dagre",options:[{component:"select",key:"rankdir",title:"Layout Direction",defaultValue:"TB",enums:[{key:"TB",value:"TB"},{key:"BT",value:"BT"},{key:"LR",value:"LR"},{key:"RL",value:"RL"}],description:"Layout Direction, Default is TB, which means top to bottom layout. TB represents top to bottom layout, BT represents bottom to top layout, LR represents left to right layout, and RL represents right to left layout."},{component:"select",key:"align",title:"Node Alignment",defaultValue:void 0,enums:[{key:null,value:null},{key:"UL",value:"UL"},{key:"UR",value:"UR"},{key:"DL",value:"DL"},{key:"DR",value:"DR"}],description:"Node Alignment, Default is UL, meaning aligned to the upper-left corner. UL represents alignment to the upper-left corner, UR represents alignment to the upper-right corner, DL represents alignment to the lower-left corner, and DR represents alignment to the lower-right corner."},{component:"slider",key:"nodeSize",title:"Node Size",defaultValue:0,max:200,min:0,description:"Node Size, Default is 0, which means the node size is automatically calculated based on the node label."},{component:"slider",key:"nodesep",title:"Node Spacing",defaultValue:10,max:200,min:1,description:"Node Spacing, horizontal spacing when rankdir is TB or BT, and vertical spacing when rankdir is LR or RL."},{component:"input",key:"ranksep",title:"Rank Spacing",defaultValue:10,max:200,min:1,description:"Spacing Between Layers, vertical spacing between adjacent layers when rankdir is TB or BT, and horizontal spacing between adjacent layers when rankdir is LR or RL."}],title:"Dagre"},{type:"circular",options:[{component:"slider",key:"radius",title:"Radius",defaultValue:void 0,min:10,max:500,description:"The Radius of the Circular Layout. If you set the radius, then the startRadius and endRadius will be ignored."},{component:"slider",key:"startRadius",title:"Start Radius",defaultValue:void 0,min:10,max:500,description:"The Radius of the First Circle."},{component:"slider",key:"endRadius",title:"End Radius",defaultValue:void 0,min:10,max:500,description:"The Radius of the Last Circle."},{component:"switch",key:"clockwise",title:"Clockwise?",defaultValue:!0,description:"Whether the Layout is Clockwise."},{component:"select",key:"ordering",title:"Ordering",defaultValue:"degree",enums:[{key:"null",value:null},{key:"degree",value:"degree"},{key:"topology",value:"topology"}],description:"The Sorting Criterion of the Circular Layout."},{component:"switch",key:"workerEnabled",title:"Worker Enabled?",defaultValue:!0,description:"Whether to Enable Web Worker for Layout Calculation to Improve Performance."}],title:"Circular"},{type:"gForce",options:[{component:"select",key:"preset",title:"Preset",defaultValue:"random",enums:[{key:"random",value:"random"},{key:"grid",value:"grid"},{key:"concentric",value:"concentric"},{key:"circular",value:"circular"},{key:"radial",value:"radial"},{key:"dagre",value:"dagre"}],description:"The Preset Layout, Default is Random. The Preset Layout Will Be Used to Initialize the Nodes Before the Force Simulation Starts. Good Initialization Can Shorten the Layout Time."},{component:"slider",key:"linkDistance",title:"Link Distance",defaultValue:100,min:10,max:500,description:"The Link Distance Between Two Adjacent Nodes."},{component:"slider",key:"nodeStrength",title:"Node Strength",defaultValue:1e3,min:100,max:1e4,description:"The Strength of the Force Applied to the Node."},{component:"slider",key:"edgeStrength",title:"Edge Strength",defaultValue:100,min:100,max:300,description:"The Strength of the Force Applied to the Edge."},{component:"switch",key:"preventOverlap",title:"Prevent Overlap?",defaultValue:!0,description:"Whether to Prevent Node Overlap."},{component:"slider",key:"nodeSize",title:"Node Size",defaultValue:30,min:10,max:100,description:"The Size of the Node, Used for Collision Detection to Prevent Node Overlap."},{component:"slider",key:"nodeSpacing",title:"Node Spacing",defaultValue:10,min:0,max:100,description:"The Spacing Between Nodes. It is only valid when the preventOverlap property is true."},{component:"slider",key:"minMovement",title:"Min Movement",defaultValue:.5,min:0,max:10,description:"The Minimum Movement of the Node. When the Node Movement is Less Than this Value, the Layout Stops."},{component:"slider",key:"maxIteration",title:"Max Iteration",defaultValue:1e3,min:100,max:1e4,description:"The Maximum Number of Iterations. If you don't want to wait too long, you can set a smaller value."},{component:"switch",key:"workerEnabled",title:"Worker Enabled?",defaultValue:!0,description:"Whether to Enable Web Worker for Layout Calculation to Improve Performance."}],title:"G6 gForce"},{type:"mds",options:[{component:"slider",key:"linkDistance",title:"Link Distance",defaultValue:100,min:10,max:500,description:"The Link Distance Between Two Adjacent Nodes."},{component:"switch",key:"workerEnabled",title:"Worker Enabled?",defaultValue:!0,description:"Whether to Enable Web Worker for Layout Calculation to Improve Performance."}],title:"Multidimensional Scaling"},{type:"random",options:[{component:"switch",key:"workerEnabled",title:"Worker Enabled?",defaultValue:!0,description:"Whether to Enable Web Worker for Layout Calculation to Improve Performance."}],title:"Random Layout"},{type:"force2",hidden:!0,options:[{component:"switch",key:"animate",title:"Animate?",defaultValue:!0,description:"Whether to Enable Animation. If Enabled, the Layout Will Be Animated to the Final State. But you can not change the layout during the animation until the animation ends."},{component:"select",key:"preset",title:"Preset",defaultValue:"random",enums:[{key:"random",value:"random"},{key:"grid",value:"grid"},{key:"concentric",value:"concentric"},{key:"circular",value:"circular"},{key:"radial",value:"radial"},{key:"dagre",value:"dagre"}],description:"The Preset Layout, Default is Random. The Preset Layout Will Be Used to Initialize the Nodes Before the Force Simulation Starts. Good Initialization Can Shorten the Layout Time."},{component:"slider",key:"linkDistance",title:"Link Distance",defaultValue:100,min:10,max:500,description:"The Link Distance Between Two Adjacent Nodes."},{component:"slider",key:"nodeStrength",title:"Node Strength",defaultValue:1e3,min:100,max:1e4,description:"The Strength of the Force Applied to the Node."},{component:"slider",key:"edgeStrength",title:"Edge Strength",defaultValue:100,min:100,max:1e4,description:"The Strength of the Force Applied to the Edge."},{component:"switch",key:"preventOverlap",title:"Prevent Overlap?",defaultValue:!0,description:"Whether to Prevent Node Overlap."},{component:"slider",key:"nodeSize",title:"Node Size",defaultValue:30,min:10,max:100,description:"The Size of the Node, Used for Collision Detection to Prevent Node Overlap."},{component:"slider",key:"nodeSpacing",title:"Node Spacing",defaultValue:10,min:0,max:100,description:"The Spacing Between Nodes. It is only valid when the preventOverlap property is true."},{component:"slider",key:"minMovement",title:"Min Movement",defaultValue:.5,min:0,max:10,description:"The Minimum Movement of the Node. When the Node Movement is Less Than this Value, the Layout Stops."},{component:"slider",key:"maxIteration",title:"Max Iteration",defaultValue:1e3,min:100,max:1e4,description:"The Maximum Number of Iterations. If you don't want to wait too long, you can set a smaller value."},{component:"switch",key:"clustering",title:"Clustering?",defaultValue:!1,description:"Whether to Enable Clustering. If Enabled, the Nodes Will Be Clustered Together."},{component:"select",key:"nodeClusterBy",title:"Node Cluster By",defaultValue:void 0,enums:[{key:null,value:null},{key:"nlabel",value:"Label"}],description:"The Property of the Node Used for Clustering."},{component:"switch",key:"workerEnabled",title:"Worker Enabled?",defaultValue:!0,description:"Whether to Enable Web Worker for Layout Calculation to Improve Performance."}],title:"Progressive gForce"},{type:"fruchterman",title:"Fruchterman",options:[{component:"select",key:"preset",title:"Preset",defaultValue:"random",enums:[{key:"random",value:"random"},{key:"grid",value:"grid"},{key:"concentric",value:"concentric"},{key:"circular",value:"circular"},{key:"radial",value:"radial"},{key:"dagre",value:"dagre"}],description:"The Preset Layout, Default is Random. The Preset Layout Will Be Used to Initialize the Nodes Before the Force Simulation Starts. Good Initialization Can Shorten the Layout Time."},{component:"slider",key:"gravity",title:"Gravity",defaultValue:10,min:0,max:100,description:"The Strength of the Force Applied to the Node."},{component:"slider",key:"speed",title:"Speed",defaultValue:1,min:0,max:10,description:"The Speed of the Force Simulation."},{component:"slider",key:"maxIteration",title:"Max Iteration",defaultValue:1e3,min:100,max:1e4,description:"The Maximum Number of Iterations. If you don't want to wait too long, you can set a smaller value."},{component:"switch",key:"clustering",title:"Clustering?",defaultValue:!1,description:"Whether to Enable Clustering. If Enabled, the Nodes Will Be Clustered Together."},{component:"slider",key:"clusterGravity",title:"Cluster Gravity",defaultValue:10,min:0,max:100,description:"The Strength of the Force Applied to the Cluster."},{component:"switch",key:"workerEnabled",title:"Worker Enabled?",defaultValue:!0,description:"Whether to Enable Web Worker for Layout Calculation to Improve Performance."}]},{type:"preset",title:"Preset Layout",options:void 0}],jd=Md,xd=g(85418),Nd=g(4393),Cd=g(96074),Id=g(85920),bd=g(96616),Oi=g(92087),wd=g(43331),Ld=g(33931),Td=g(99842),Dd=g(21419),Ed=g(93702),Ad=g(14616),kd=g(71338),Od=function(e,n){console.log("getAntdComponent",e,n);var a=n.onChange,r=n.value,i=n.defaultValue,o=e.min,d=o===void 0?0:o,c=e.max,y=c===void 0?500:c,S=e.component,M=e.key,N=e.enums,h=e.step,w=h===void 0?1:h;if(S==="slider")return{component:kd.Z,props:{min:d,max:y,onChange:function(u){a(M,u)},value:r,step:(y-d)/10,defaultValue:i}};if(S==="input")return{component:$t.Z,props:{onChange:function(u){a(M,u)},value:r,defaultValue:i}};if(S==="switch")return{component:Zt.Z,props:{onChange:function(u){a(M,u)},checked:r==null?i:r,defaultValue:i,step:.01,size:"small"}};if(S==="select")return{component:pe.default,props:{value:r,options:N,onChange:function(u){a(M,u)},size:"small",defaultValue:i}};if(S==="text")return{component:function(){return(0,t.jsx)("span",{children:"No Settings"})},props:{}}},Pd=[{key:"work-in-progress",component:"text",title:"Work In Progress",defaultValue:""}],zd=function(e){var n=e.options,a=n===void 0?Pd:n,r=e.type,i=e.handleChange,o=s.useState({}),d=v()(o,2),c=d[0],y=d[1],S=a.map(function(N){var h=N.key,w=N.defaultValue;return Ee()({},h,w)}).reduce(function(N,h){return m()(m()({},N),h)},{}),M=function(h,w){var p=m()(m()(m()({},S),c),{},Ee()({},h,w));y(p),i&&i(r,p)};return(0,t.jsx)(_e.Z,{children:a?a.map(function(N){var h=N.title,w=N.defaultValue,p=N.key,u=N.description,f=c[p],b=Od(N,{onChange:M,value:f,defaultValue:w}),L=b.component,D=b.props;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Ze.Z,{span:12,children:(0,t.jsx)(Et.Z,{title:u,trigger:"hover",children:h})}),(0,t.jsx)(Ze.Z,{span:12,children:(0,t.jsx)(L,m()(m()({},D),{},{getPopupContainer:function(U){return U}}))})]})}):"No Options"})},Zd=zd,Pi={"graphin-force":(0,t.jsx)(qn.Z,{}),random:(0,t.jsx)(Id.Z,{}),concentric:(0,t.jsx)(bd.Z,{}),circular:(0,t.jsx)(Ea.Z,{}),force:(0,t.jsx)(Oi.Z,{}),dagre:(0,t.jsx)(wd.Z,{}),grid:(0,t.jsx)(Ld.Z,{}),radial:(0,t.jsx)(Td.Z,{}),gForce:(0,t.jsx)(xn.Z,{}),mds:(0,t.jsx)(Dd.Z,{}),preset:(0,t.jsx)(Da.Z,{}),force2:(0,t.jsx)(Oi.Z,{}),fruchterman:(0,t.jsx)(Ed.Z,{})},Rd={"graphin-force":"This layout algorithm uses a force-directed approach to arrange nodes in a graph, allowing them to naturally repel and attract each other for an optimized layout.",random:"This algorithm arranges nodes in a graph randomly, resulting in an unpredictable and chaotic arrangement.",concentric:"Nodes are organized into concentric circles or rings, with nodes of higher importance placed closer to the center.",circular:"Nodes are arranged in a circular pattern, often with a central node and radiating outward, providing a clear visual hierarchy.",force:"Similar to 'graphin-force,' this algorithm utilizes a force- directed approach to position nodes, ensuring an organized and visually pleasing graph layout.",dagre:"This algorithm applies the Directed Acyclic Graph(DAG) layout, useful for arranging nodes in hierarchical structures with no cycles, such as trees.",grid:"Nodes are placed in a grid or matrix - like pattern, creating an organized and easily navigable structure.",radial:"This layout arranges nodes in a circular or radial form, commonly used for visualizing hierarchical structures or tree diagrams.",gForce:"An alternative force - directed layout approach, similar to 'graphin-force,' for achieving well - organized graph layouts.",mds:"This algorithm employs multidimensional scaling techniques to position nodes based on their pairwise distances, often used for visualizing high - dimensional data in lower dimensions.",preset:"This algorithm applies a preset layout, useful for arranging nodes in a specific pattern.",force2:"This algorithm applies a force-directed layout, useful for arranging nodes in a specific pattern.",fruchterman:"This algorithm applies a force-directed layout, useful for arranging nodes in a specific pattern."},_d=function(e){var n=e.handleChange,a=e.description,r=e.layouts,i=s.useState(!1),o=v()(i,2),d=o[0],c=o[1],y=function(h){c(h)},S=function(h){n(h.key),c(!1)},M=(0,t.jsx)(Cn.Z,{onClick:S,children:r.map(function(N){var h=N.type,w=N.title;return(0,t.jsx)(Cn.Z.Item,{children:(0,t.jsxs)(_e.Z,{style:{display:"flex",flexDirection:"column",maxWidth:"240px"},children:[(0,t.jsxs)(Ze.Z,{children:[Pi[h]," ",w]}),(0,t.jsx)(Ze.Z,{children:(0,t.jsx)("small",{children:Rd[h]})})]})},h)})});return(0,t.jsx)(xd.Z,{overlay:M,onOpenChange:y,open:d,trigger:["click"],getPopupContainer:function(h){return h||document.body},overlayStyle:{height:"300px",overflow:"scroll"},children:(0,t.jsxs)(_e.Z,{style:{paddingTop:"15px"},children:[(0,t.jsx)(Ze.Z,{span:8,children:"Layout Type"}),(0,t.jsxs)(Ze.Z,{span:16,children:[" ",a]})]})})},Gd=function(e){var n=e.style,a=e.onChange,r=e.layouts,i=e.type||"preset",o=r.find(function(M){return M.type===i});if(!o)return B.ZP.error("Can't find layout by type ".concat(i)),null;var d=o.options,c=o.title,y=function(N,h){var w=r.find(function(p){return p.type===N});console.log("Select Layout Type: ",N,h,w),!h&&w&&w.options&&(h=w.options.map(function(p){var u=p.key,f=p.defaultValue;return Ee()({},u,f)}).reduce(function(p,u){return m()(m()({},p),u)},{})),a&&a({type:N,options:h})},S=(0,t.jsxs)(jn.Z,{children:[Pi[i]," ",c," ",(0,t.jsx)(Ad.Z,{})]});return(0,t.jsxs)(Nd.Z,{title:null,bordered:!1,style:m()({},n),className:"layout-settings-panel",children:[(0,t.jsx)(_d,{handleChange:y,description:S,layouts:r.filter(function(M){return!M.hidden})}),(0,t.jsx)(Cd.Z,{style:{margin:"15px 0px"}}),(0,t.jsx)("div",{style:{height:"260px",overflow:"scroll"},children:(0,t.jsx)(Zd,{options:d,type:i,handleChange:y},i)})]})},Fd=s.memo(Gd),Ud="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyVpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ4IDc5LjE2NDAzNiwgMjAxOS8wOC8xMy0wMTowNjo1NyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIxLjAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6Q0ZCRkQ0NkYzNTJGMTFFQUI3RjZDREY0RTU0QUE3MTkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6Q0ZCRkQ0NzAzNTJGMTFFQUI3RjZDREY0RTU0QUE3MTkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3RkI5RkU5QzM1MkQxMUVBQjdGNkNERjRFNTRBQTcxOSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpDRkJGRDQ2RTM1MkYxMUVBQjdGNkNERjRFNTRBQTcxOSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pkh8jE8AAABFSURBVHjaYrzz5KUzAwODORCfBOK9DBQCJiC2AmI2qKEM1DDwGBD/grqQYsAI9DIDNQETA5XBqIGjBo4aOGrgEDUQIMAAUHwKeXWC3WEAAAAASUVORK5CYII=",Yd=g(8322),zi=g.n(Yd);B.ZP.config({duration:2,maxCount:3,getContainer:function(){return document.getElementById("knowledge-graph-container")||document.body}});var Bd={backgroundImage:"url(".concat(Ud,")")},_a=function(e){var n=e.nodes.map(function(o){return o.id}).sort(),a=e.edges.map(function(o){return o.relid}).sort(),r=JSON.stringify({nodes:n,edges:a}),i=zi().hash(r).toString();return i},Qd=function(e){return zi().hash(e).toString()},Vd=function(e){var n=on.Z.useModal(),a=v()(n,2),r=a[0],i=a[1],o=(0,s.useState)(e.data||{nodes:[],edges:[]}),d=v()(o,2),c=d[0],y=d[1],S=(0,s.useState)([]),M=v()(S,2),N=M[0],h=M[1],w=(0,s.useState)([]),p=v()(w,2),u=p[0],f=p[1],b=(0,s.useState)({}),L=v()(b,2),D=L[0],k=L[1],U=(0,s.useState)({}),F=v()(U,2),T=F[0],z=F[1],C=(0,s.useState)([]),j=v()(C,2),I=j[0],R=j[1],Q=(0,s.useState)([]),se=v()(Q,2),O=se[0],_=se[1],Ie=(0,s.useState)(!1),me=v()(Ie,2),Ae=me[0],ge=me[1],it=(0,s.useState)(!1),ut=v()(it,2),ht=ut[0],Ge=ut[1],ft=(0,s.useState)(void 0),St=v()(ft,2),Mt=St[0],$e=St[1],gt=(0,s.useState)(!1),yt=v()(gt,2),jt=yt[0],ae=yt[1],ne=(0,s.useState)(void 0),be=v()(ne,2),Ye=be[0],Be=be[1],Xe=(0,s.useState)(!1),ue=v()(Xe,2),P=ue[0],A=ue[1],Z=(0,s.useState)([]),$=v()(Z,2),ye=$[0],le=$[1],re=(0,s.useState)([]),we=v()(re,2),ce=we[0],Ce=we[1],ot=(0,s.useState)([]),xt=v()(ot,2),lt=xt[0],Fe=xt[1],Ga=(0,s.useState)(!1),oa=v()(Ga,2),Se=oa[0],Ln=oa[1],Zi=(0,s.useState)(),la=v()(Zi,2),Re=la[0],Nt=la[1],sa=(0,s.useState)("New Graph"),Xt=v()(sa,2),sn=Xt[0],ca=Xt[1],Ft=(0,s.useState)("New Graph"),Fa=v()(Ft,2),Ut=Fa[0],cn=Fa[1],Ua=(0,s.useState)(!1),Ya=v()(Ua,2),dn=Ya[0],qt=Ya[1],da=(0,s.useState)([]),en=v()(da,2),Ba=en[0],ua=en[1],Qa=(0,s.useState)(!1),un=v()(Qa,2),de=un[0],E=un[1],V=(0,s.useState)(!1),W=v()(V,2),te=W[0],Me=W[1],De=(0,s.useState)({}),fe=v()(De,2),ie=fe[0],je=fe[1],ke=(0,s.useState)(!1),st=v()(ke,2),Ct=st[0],Le=st[1],ct=(0,s.useState)(!1),qe=v()(ct,2),tn=qe[0],Yt=qe[1],Bt=(0,s.useState)(void 0),et=v()(Bt,2),Ue=et[0],It=et[1],Qe=(0,s.useState)([]),nn=v()(Qe,2),pt=nn[0],Ve=nn[1],dt=(0,s.useState)(!1),Tn=v()(dt,2),Dn=Tn[0],bt=Tn[1],Hd=(0,s.useState)(!1),Ri=v()(Hd,2),Va=Ri[0],_i=Ri[1],Kd=(0,s.useState)(ei),Gi=v()(Kd,2),Fi=Gi[0],Wa=Gi[1],Jd=(0,s.useState)(oi),Ui=v()(Jd,2),Pe=Ui[0],mt=Ui[1],$d=function(x,Y){var K=Y.find(function(H){return H.relation_type===x.reltype});return K&&(x.description=K.description||"",x.prompt_template=K.prompt_template||""),x},an=function(x){var Y=new Set(x.nodes.map(function(ee){return ee.id})),K=x.edges.filter(function(ee){return Y.has(ee.source)&&Y.has(ee.target)}).map(function(ee){return $d(ee,u)});qt(!0);var H=x.nodes,he=ls(K,{});y({nodes:H,edges:he})},Xd=function(){y({nodes:[],edges:[]}),R([]),_([]),Nt(void 0),ca(""),cn(""),qt(!1),gs(),fs(),It(void 0)},ha=function(x,Y){R(Hr(x)),_(Hr(Y))};(0,s.useEffect)(function(){ha(c.nodes,c.edges),k({numNodes:c.nodes.length,numEdges:c.edges.length,numAllNodes:(0,In.stat_total_node_count)(N),numAllEdges:(0,In.stat_total_relation_count)(u),isDirty:dn,currentParentUUID:Ut})},[c,u,N,Ut]),(0,s.useEffect)(function(){Ue&&us(Ue)},[Ue]);var Ha=function(){e.apis.GetGraphHistoryFn({page:1,page_size:100}).then(function(x){ua(x.records)}).catch(function(x){console.log(x),B.ZP.error("Failed to get graph histories, please check the network connection.")})},qd=function(x,Y){var K=function(ee,xe){return{operator:"and",items:[{operator:"=",field:"entity_id",value:ee},{operator:"=",field:"entity_type",value:xe}]}},H={operator:"or",items:x.map(function(he,ee){return K(he,Y[ee])})};return new Promise(function(he,ee){e.apis.GetEntity2DFn({query_str:JSON.stringify(H),page:1,page_size:x.length}).then(function(xe){console.log("Get dimensions: ",xe);var tt=xe.records.map(function(Ke){return m()(m()({},Ke),{},{color:T[Ke.entity_type]})});he(tt)}).catch(function(xe){console.log("Error when getting dimensions: ",xe),ee([])})})},Yi=function(x,Y){var K=JSON.parse(x.payload);K&&(qt(!1),ca(Y.id),cn(x.id),an(K.data),Wa(K.layout||{}),E(!1))},eu=function(x,Y){return console.log("Load graph: ",x,Y,dn),new Promise(function(K,H){if(dn)r.confirm({title:"You have unsaved changes",icon:(0,t.jsx)(Dl.Z,{}),content:"Are you sure to load another graph?",okText:"Load",cancelText:"Cancel",onOk:function(){return qt(!1),Yi(x,Y),K(x)},onCancel:function(){return H(x)},getContainer:function(){return document.getElementById("knowledge-graph-container")||document.body}});else return Yi(x,Y),K(x)})},tu=function(x){return new Promise(function(Y,K){console.log("Delete graph: ",x),e.apis.DeleteGraphHistoryFn({id:x.id}).then(function(H){return B.ZP.success("Graph deleted successfully."),Ha(),Y()}).catch(function(H){return console.log(H),B.ZP.error("Failed to delete graph, please check the network connection."),K()})})},nu=function(){e.apis.GetEntityColorMapFn().then(function(x){console.log("Entity Color Map: ",x),z(x)}).catch(function(x){console.log(x),B.ZP.error("Failed to get entity color map, please check the network connection.")})},au=function(){var x=$r();console.log("Load Preset Graph Data: ",x,c,na),x&&(an({nodes:(0,X.uniqBy)([].concat(Ne()(c.nodes),Ne()(x.nodes)),"id"),edges:(0,X.uniqBy)([].concat(Ne()(c.edges),Ne()(x.edges)),"relid")}),Wa(x.layout||{}),qt(x.isDirty),x.currentUUID&&cn(x.currentUUID))};(0,s.useEffect)(function(){e.apis.GetStatisticsFn().then(function(H){h(H.entity_stat),f(H.relation_stat)}).catch(function(H){console.log(H),B.ZP.error("Failed to get statistics, please check the network connection.")}),e.apis.GetPromptsFn&&e.apis.GetPromptsFn().then(function(H){console.log("Get Prompts: ",H),Ve(H.records)}).catch(function(H){console.log("Get Prompts Error: ",H),B.ZP.error("Failed to get prompts, please check the network connection.")}),Ha(),nu(),au();var G=hs();if(G){var x=_a(c),Y=Object.keys(G).filter(function(H){return H.endsWith(x)}),K={};Y.forEach(function(H){K[H]=G[H]}),It(K)}},[]),(0,s.useEffect)(function(){Se===!1&&Re?(ge(!0),B.ZP.info("Loading data, please wait..."),console.log("Search Object: ",Re),Re.process(e.apis).then(function(G){if(console.log("Query Graph Response: ",G),Re.merge_mode=="replace")an(G);else if(Re.merge_mode=="append")an({nodes:(0,X.uniqBy)([].concat(Ne()(c.nodes),Ne()(G.nodes)),"id"),edges:(0,X.uniqBy)([].concat(Ne()(c.edges),Ne()(G.edges)),"relid")});else if(Re.merge_mode=="subtract"){var x=G.nodes,Y=G.edges,K=x.map(function(xe){return xe.id});K=K.filter(function(xe){var tt=function(At,kt,En){return(At.target==kt||At.source==kt)&&En.indexOf(At.reltype)>-1},Ke=Re.data.relation_types||Y.map(function(ze){return ze.reltype}),Je=c.edges.filter(function(ze){return tt(ze,xe,Ke)});return console.log("Found: ",Je,xe,Ke),Je.length<2});var H=c.nodes.filter(function(xe){return!K.includes(xe.id)}),he=c.edges.filter(function(xe){return!K.includes(xe.source)&&!K.includes(xe.target)}),ee={nodes:H,edges:he};console.log("New Data: ",ee,c,G,K),an(ee)}else B.ZP.warning("Unknown merge mode, please retry later.");B.ZP.success("Find ".concat(G.nodes.length," entities and ").concat(G.edges.length," relationships.")),ge(!1),Nt(void 0)}).catch(function(G){console.log("getNodes Error: ",G),B.ZP.warning("Unknown errors or Cannot find any entities & relationships."),ge(!1),Nt(void 0)})):console.log("Advanced Search Panel is active or search object is invalid: ",Se,Re)},[Re]);var fa=function(){Ln(!0)},Bi=function(){Ln(!1)},ru=function(x){console.log("Search Object: ",x),Bi(),Nt(x)},Qi=function(x,Y,K,H,he){if(Y){var ee=new hi({entity_type:x,entity_id:Y,nsteps:H||1,limit:he||10},K||"append");Nt(ee)}},iu=function(x,Y,K,H,he){if(Y){var ee=new gi({entity_type:x,entity_id:Y,relation_type:K||"",topk:he||10},H||"append");Nt(ee)}},ou=function(x,Y,K,H,he,ee){if(Y&&Y.length>1){var xe=new mi({start_node_id:x.id,nodes:Y,node_types:K||[],topk:he||10,nhops:ee||1,nums_shared_by:Y&&Y.length},H||"append");Nt(xe)}else B.ZP.warning("Please select at least two nodes to find shared nodes.")},lu=function(x,Y,K,H,he){if(x&&Y&&K&&H){var ee=new yl({source_entity_id:x,source_entity_type:Y,target_entity_id:K,target_entity_type:H,relation_types:[],nsteps:he||1},"append");Nt(ee)}else B.ZP.warning("Please select two nodes to expand.")},su=function(x,Y,K){if(x.key=="auto-connect"){B.ZP.info("Auto connecting nodes, please wait..."),ge(!0);var H=Y.getNodes().map(function(ee){return ee.getModel()}),he=H.map(function(ee){return os(ee)});if(he.length==0){B.ZP.warning("Please load some nodes first."),ge(!1);return}e.apis.GetConnectedNodesFn({node_ids:he.join(",")}).then(function(ee){console.log("Auto Connect Response: ",ee),an({nodes:(0,X.uniqBy)([].concat(Ne()(c.nodes),Ne()(ee.nodes)),"id"),edges:(0,X.uniqBy)([].concat(Ne()(c.edges),Ne()(ee.edges)),"relid")}),ee.nodes.length==0&&ee.edges.length==0?B.ZP.warning("No more relationships can be found."):B.ZP.success("Find ".concat(ee.nodes.length," entities and ").concat(ee.edges.length," relationships."))}).catch(function(ee){console.log("Auto Connect Error: ",ee),B.ZP.warning("Something went wrong, please try again later.")}).finally(function(){ge(!1)})}else x.key=="clear-node-edge-status"&&(Ce([]),Fe([]))},cu=function(x,Y,K,H,he,ee){if(x.key=="what-is-the-relationship")e.postMessage&&e.postMessage("what is the relationship between ".concat(Y.data.name," and ").concat(K.data.name,"?"));else if(x.key=="show-edge-details")ae(!0),Be({startNode:Y,endNode:K,edge:H});else if(x.key=="hide-current-edge"){var xe=H.relid,tt=[];if(lt.length==0){var Ke=he.getEdges().map(function(ve){return ve.getModel().relid});tt=Ke.filter(function(ve){return ve!=xe})}else tt=lt.filter(function(ve){return ve!=xe});var Je=he.getNodes().map(function(ve){return ve.getModel().id}),ze=(0,X.uniq)(tt),At=(0,X.uniq)(Je);Fe(ze),Ce(At)}else if(x.key=="hide-edges-with-same-type"){var kt=H.reltype,En=he.getEdges().filter(function(ve){var rn=ve.getModel();return rn.reltype==kt}),ga=En.map(function(ve){return ve.getModel().relid}),Ot=[];if(lt.length==0){var Ka=he.getEdges().map(function(ve){return ve.getModel().relid});Ot=Ka.filter(function(ve){return!ga.includes(ve)})}else Ot=lt.filter(function(ve){return!ga.includes(ve)});var An=he.getNodes().map(function(ve){return ve.getModel().id}),ya=(0,X.uniq)(Ot),pa=(0,X.uniq)(An);Fe(ya),Ce(pa)}else if(x.key.match(/explain_path_with_attention_subgraph/)){var ma=Y.data.name,va=K.data.name,kn=H.reltype,On="".concat(ma,"#").concat(kn,"#").concat(va),Ja=JSON.stringify(Pa(c));e.apis.AskLlmFn?(B.ZP.info("Explaining the edge with an attention subgraph, please wait a moment...(Don't leave this page)",5),ge(!0),e.apis.AskLlmFn({prompt_template_id:x.key},{subgraph_with_ctx:{context_str:On,subgraph:Ja}}).then(function(ve){console.log("AskLlmFn Response: ",ve);var rn=_a(c),zn=Ee()({},"edge_".concat(rn),m()(m()({},ve),{},{title:"Edge - ".concat(On)}));It(m()(m()({},Ue),zn)),bt(!0),ge(!1)}).catch(function(ve){console.log("AskLlmFn Error: ",ve),B.ZP.warning("The AskLlm function encounter an error, please try again later.",5),ge(!1)})):B.ZP.warning("The admin has not enabled the AskLlm function.",5)}else if(x.key.match(/explain_edge_.*/)){var Pn={source:m()(m()({},Y.data),{},{idx:Math.random()*1e6}),target:m()(m()({},K.data),{},{idx:Math.random()*1e6}),relation:m()(m()({},H.data),{},{id:Math.random()*1e6})};console.log("Explain Edge: ",x,Pn,H.relid),e.apis.AskLlmFn&&(B.ZP.info("Explaining the edge, please wait a moment...(Don't leave this page)",5),ge(!0),e.apis.AskLlmFn({prompt_template_id:x.key},{expanded_relation:Pn}).then(function(ve){console.log("AskLlmFn Response: ",ve);var rn=Ee()({},"".concat(H.relid),m()(m()({},ve),{},{title:"Edge - ".concat(H.relid)}));It(m()(m()({},Ue),rn)),bt(!0),ge(!1)}).catch(function(ve){console.log("AskLlmFn Error: ",ve),B.ZP.warning("The AskLlm function encounter an error, please try again later.",5),ge(!1)}))}},du=function(x,Y,K,H){if(console.log("onNodeMenuClick [".concat(x.key,"]: "),x,Y),x.key=="delete-nodes"){var he=ta(K),ee=Ne()(he.map(function(oe){return oe.id}));if(he.length==0){B.ZP.info("Please select one or more nodes to delete.");return}else{B.ZP.info("Deleting ".concat(he.length," nodes, please wait..."));var xe=c.nodes.filter(function(oe){return!ee.includes(oe.id)}),tt=c.edges.filter(function(oe){return!ee.includes(oe.source)&&!ee.includes(oe.target)});he.forEach(function(oe){K.removeItem(oe.id,!1)}),an({nodes:xe,edges:tt}),ha(xe,tt)}}else if(x.key=="expand-one-step")fa(),Qi(Y.data.label,Y.data.id,"append",1,10);else if(x.key=="find-similar-nodes")fa(),iu(Y.data.label,Y.data.id,void 0,"append",10);else if(x.key=="find-shared-nodes"){var Ke=ta(K);Ke&&Ke.length>=1?(fa(),ou(Y,Ke,void 0,"append",10,1)):B.ZP.warning("Please select at least one node to find shared nodes.")}else if(["expand-all-paths-1","expand-all-paths-2","expand-all-paths-3"].includes(x.key)){console.log("Expand All Paths: ",x.key);var Je=ta(K);if(Je.length!==2){B.ZP.info('Please select two nodes to expand, and only two nodes are allowed. If you want to expand more nodes, please use the "Find Shared Nodes" / "Auto Connect" function instead.');return}else{var ze=Vr(Je[0]),At=Wr(Je[0]),kt=Vr(Je[1]),En=Wr(Je[1]),ga=Number(x.key.split("-").pop());lu(At,ze,En,kt,ga)}}else if(x.key!="expand-selected-nodes"){if(x.key=="what-is-the-node")e.postMessage&&e.postMessage("what is the ".concat(Y.data.name,"?"));else if(x.key.match(/explain_node_.*/)){var Ot=Y.data;console.log("Explain Node: ",x,Ot,Y.data.label,Y.data.id),e.apis.AskLlmFn&&(B.ZP.info("Explaining the node, please wait a moment...(Don't leave this page)",5),ge(!0),e.apis.AskLlmFn({prompt_template_id:x.key},{entity:Ot}).then(function(oe){console.log("AskLlmFn Response: ",oe);var fn=Qd("".concat(Ot.name,"_").concat(Ot.id)),gn=Ee()({},"node_".concat(fn),m()(m()({},oe),{},{title:"Node - ".concat(Ot.name)}));It(m()(m()({},Ue),gn)),bt(!0),ge(!1)}).catch(function(oe){console.log("AskLlmFn Error: ",oe),B.ZP.warning("The AskLlm function encounter an error, please try again later.",5),ge(!1)}))}else if(x.key.match(/explain_subgraph_.*$/)){var Ka=Y.data.label;if(Ka==="Disease"){var An=Y.data.name,ya=JSON.stringify(Pa(c));console.log("Explain Subgraph: ",An,ya,x.key),e.apis.AskLlmFn?(B.ZP.info("Explaining the subgraph, please wait a moment...(Don't leave this page)",5),ge(!0),e.apis.AskLlmFn({prompt_template_id:x.key},{subgraph_with_ctx:{context_str:An,subgraph:ya}}).then(function(oe){console.log("AskLlmFn Response: ",oe);var fn=_a(c),gn=Ee()({},"subgraph_".concat(fn),m()(m()({},oe),{},{title:"Subgraph - ".concat(An)}));It(m()(m()({},Ue),gn)),bt(!0),ge(!1)}).catch(function(oe){console.log("AskLlmFn Error: ",oe),B.ZP.warning("The AskLlm function encounter an error, please try again later.",5),ge(!1)})):B.ZP.warning("The admin has not enabled the AskLlm function.",5)}else B.ZP.warning("Only the disease are supported to choose as a context node for explaining the subgraph now.")}else if(x.key!="predict-relationships"){if(x.key=="visulize-similarities"){var pa=ds(K),ma=pa.map(function(oe){return oe.data.id}),va=pa.map(function(oe){return oe.data.label});ge(!0),qd(ma,va).then(function(oe){console.log("Get Dimensions Response: ",oe,ma,va),le(oe),A(!0),ge(!1)}).catch(function(oe){console.log("Get Dimensions Error: ",oe),le([]),A(!1),B.ZP.error("Failed to get similarities, please check the network connection."),ge(!1)}).finally(function(){ge(!1)})}else if(x.key=="show-node-details")Ge(!0),$e(Y);else if(x.key=="hide-selected-nodes"){var kn=ta(K);kn.push(Y);var On=kn.map(function(oe){return oe.id}),Ja=K.getEdges().filter(function(oe){var fn=oe.getModel(),gn=kn.map(function(vu){return vu.id});return gn.includes(fn.source)||gn.includes(fn.target)}),Pn=Ja.map(function(oe){return oe.getModel().relid}),ve=[];if(lt.length==0){var rn=K.getEdges().map(function(oe){return oe.getModel().relid});ve=rn.filter(function(oe){return!Pn.includes(oe)})}else ve=lt.filter(function(oe){return!Pn.includes(oe)});var zn=[];if(ce.length==0){var yu=K.getNodes().map(function(oe){return oe.getModel().id});zn=yu.filter(function(oe){return!On.includes(oe)})}else zn=ce.filter(function(oe){return!On.includes(oe)});var pu=(0,X.uniq)(zn),mu=(0,X.uniq)(ve);Ce(pu),Fe(mu)}}}},uu=function(){Me(!0),je({data:c,isDirty:dn,currentUUID:Ut})},hu=function(x,Y){console.log("Node Clicked: ",x,c,Y),Y&&(Ge(!0),$e(Y))},fu=function(x,Y,K,H){console.log("Edge Clicked: ",x),x&&(ae(!0),Be({edge:H,startNode:Y,endNode:K}))},gu=function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"graphin-settings",Y=JSON.parse(localStorage.getItem(x)||"{}");Object.keys(Y).length===0?mt(oi):(mt(Y),B.ZP.success("Settings loaded"))},Vi=function(){ae(!1),Ge(!1)},hn=(0,zr.r)(),Wi=function(x){return new Promise(function(Y,K){sn&&cs(sn)&&(x=m()(m()({},x),{},{parent:sn})),delete x.id,e.apis.PostGraphHistoryFn(x).then(function(H){return B.ZP.success("Graph data saved."),Ha(),Y(H)}).catch(function(H){return console.log("Post Graphs Error: ",H),B.ZP.error("Graph save failed."),K(H)})})};return(0,t.jsx)(zr.I,{handle:hn,children:(0,t.jsx)(_e.Z,{className:"knowledge-graph-container",id:"knowledge-graph-container",children:(0,t.jsxs)(Wn.Z,{spinning:Ae,children:[(0,t.jsx)(_t,{className:"settings-panel",title:"Settings",width:"320px",height:"auto",minWidth:"260px",minHeight:"auto",maxWidth:"320px",maxHeight:"auto",top:"150px",left:"30px",resizable:!1,help:"You can set several settings here, such as the layout, node size, and edge style.",children:(0,t.jsxs)(Tt.Z,{defaultActiveKey:["1"],accordion:!0,children:[(0,t.jsx)(Tt.Z.Panel,{header:"Quick Operations",children:(0,t.jsxs)(_e.Z,{className:"button-toolbar",children:[(0,t.jsx)(q.ZP,{className:"graph-table-button",onClick:function(){Le(!Ct)},icon:Ct?(0,t.jsx)(El.Z,{}):(0,t.jsx)(Al.Z,{}),children:Ct?"Hide Graph Table":"Show Graph As a Table"}),(0,t.jsx)(q.ZP,{className:"graph-table-button",onClick:function(){Yt(!tn)},icon:(0,t.jsx)(kl.Z,{}),children:tn?"Hide Metrics Panel":"Analyze Subgraph"}),(0,t.jsx)(q.ZP,{className:"statistics-button",onClick:function(){_i(!Va)},icon:(0,t.jsx)(Zr.Z,{}),children:Va?"Hide Statistics Panel":"Show Statistics Panel"}),(0,t.jsx)(q.ZP,{className:"full-screen-button",onClick:hn.active?hn.exit:hn.enter,icon:hn.active?(0,t.jsx)(Ol.Z,{}):(0,t.jsx)(Rr.Z,{}),children:hn.active?"Exit Full Screen":"Enter Full Screen"}),(0,t.jsx)(q.ZP,{className:"save-button",onClick:uu,icon:(0,t.jsx)(ba.Z,{}),children:"Save Current Subgraph"}),(0,t.jsx)(q.ZP,{className:"clear-button",onClick:function(){E(!0)},icon:(0,t.jsx)(_r.Z,{}),children:"Load Saved Subgraphs"}),(0,t.jsx)(q.ZP,{className:"explain-button",onClick:function(){Dn===!1?Ue&&Object.keys(Ue).length>0?bt(!0):(B.ZP.warning('No explanation data available. If you want to generate an explanation, please right click on a disease node and select "Explain Subgraph" first, then click this button again.',5),bt(!1)):ae(!1)},disabled:!(Ue&&Object.keys(Ue).length>0),icon:(0,t.jsx)(Pl.Z,{}),children:Dn?"Hide Explaination Panel":"Show Explaination Panel"})]})},"1"),(0,t.jsx)(Tt.Z.Panel,{header:"Layout Settings",extra:(0,t.jsx)(zt.Z,{content:(0,t.jsx)("p",{style:{width:"400px"},children:'If you would like to change the layout, please click the "Layout Type" button and select a new layout. After that, you can change the layout settings.'}),title:"Help",placement:"topRight",children:(0,t.jsx)(wa.Z,{})}),children:(0,t.jsx)(Fd,{type:Fi.type||"preset",layouts:jd,onChange:function(x){Wa(x)}})},"2"),(0,t.jsx)(Tt.Z.Panel,{header:"Graph Settings",extra:(0,t.jsx)(zt.Z,{content:(0,t.jsx)("p",{style:{width:"400px"},children:'If you would like to select multiple nodes, please set the interactive mode to "select-nodes". Then press the "Shift" key and click the nodes you want to select.'}),title:"Help",placement:"topRight",children:(0,t.jsx)(wa.Z,{})}),children:(0,t.jsxs)(rt.Z,{style:{position:"relative",marginBottom:"0px",opacity:.8},direction:"horizontal",children:[(0,t.jsx)(rt.Z.Item,{children:(0,t.jsx)(pe.default,{style:{width:"100%"},allowClear:!0,value:Pe.interactiveMode,getPopupContainer:function(x){return x.parentNode},onChange:function(x){mt(m()(m()({},Pe),{},{interactiveMode:x}))},placeholder:"Select a interactive mode",children:["show-details","select-nodes","show-paths"].map(function(G){return(0,t.jsxs)(pe.default.Option,{value:G,children:[(0,t.jsx)(xn.Z,{}),"\xA0",at.Z.titleCase(G)]},G)})})}),(0,t.jsx)(rt.Z.Item,{children:(0,t.jsx)(pe.default,{style:{width:"100%"},allowClear:!0,defaultValue:"brush-select",getPopupContainer:function(x){return x.parentNode},disabled:Pe.interactiveMode!=="select-nodes",onChange:function(x){mt(m()(m()({},Pe),{},{selectionMode:x}))},placeholder:"Select a selection mode",children:["brush-select","lasso-select"].map(function(G){return(0,t.jsxs)(pe.default.Option,{value:G,children:[(0,t.jsx)(xn.Z,{}),"\xA0",at.Z.titleCase(G)]},G)})})}),(0,t.jsxs)(rt.Z.Item,{children:[(0,t.jsx)(Zt.Z,{onChange:function(x){mt(m()(m()({},Pe),{},{nodeLabelVisible:x}))},checked:Pe.nodeLabelVisible}),"Node Label"]}),(0,t.jsxs)(rt.Z.Item,{children:[(0,t.jsx)(Zt.Z,{onChange:function(x){mt(m()(m()({},Pe),{},{edgeLabelVisible:x}))},checked:Pe.edgeLabelVisible}),"Edge Label"]}),(0,t.jsxs)(rt.Z.Item,{children:[(0,t.jsx)(Zt.Z,{onChange:function(x){mt(m()(m()({},Pe),{},{nodeTooltipEnabled:x}))},checked:Pe.nodeTooltipEnabled}),"Node Tooltip"]}),(0,t.jsxs)(rt.Z.Item,{children:[(0,t.jsx)(Zt.Z,{onChange:function(x){mt(m()(m()({},Pe),{},{edgeTooltipEnabled:x}))},checked:Pe.edgeTooltipEnabled}),"Edge Tooltip"]}),(0,t.jsxs)(rt.Z.Item,{children:[(0,t.jsx)(Zt.Z,{onChange:function(x){mt(m()(m()({},Pe),{},{miniMapEnabled:x}))},checked:Pe.miniMapEnabled}),"MiniMap"]}),(0,t.jsxs)(rt.Z.Item,{children:[(0,t.jsx)(Zt.Z,{onChange:function(x){mt(m()(m()({},Pe),{},{snapLineEnabled:x}))},checked:Pe.snapLineEnabled}),"SnapLine"]}),(0,t.jsxs)(rt.Z.Item,{children:[(0,t.jsx)(Zt.Z,{onChange:function(x){mt(m()(m()({},Pe),{},{infoPanelEnabled:x}))},checked:Pe.infoPanelEnabled}),"Info Panel"]}),(0,t.jsx)(rt.Z.Item,{children:(0,t.jsx)(q.ZP,{type:"primary",size:"small",style:{width:"100%"},onClick:function(){localStorage.setItem("graphin-settings",JSON.stringify(Pe)),B.ZP.success("Settings saved")},children:"Save Settings"})}),(0,t.jsx)(rt.Z.Item,{children:(0,t.jsx)(q.ZP,{danger:!0,size:"small",style:{width:"100%"},onClick:function(){gu()},children:"Load Settings"})})]})},"3")]})}),(0,t.jsxs)(_e.Z,{className:"top-toolbar",children:[(0,t.jsx)(ic,{onChange:Qi,onAdvancedSearch:fa,entityTypes:N.map(function(G){return G.entity_type}),getEntities:e.apis.GetEntitiesFn}),(0,t.jsx)(Oc,{onOk:ru,visible:Se,onCancel:Bi,entityTypes:N.map(function(G){return G.entity_type}),searchObject:Re,relationStat:u,parent:document.getElementById("knowledge-graph-container"),apis:e.apis},(Re==null?void 0:Re.get_current_node_id())||"default")]}),(0,t.jsxs)(Ze.Z,{className:"graphin",style:{width:"100%",height:"100%",position:"relative"},children:[(0,t.jsxs)(nc,{layout:Fi,prompts:pt,askLlmFn:e.apis.AskLlmFn,onDataChanged:function(x,Y,K,H){x&&y(x)},selectedNodes:ce,selectedEdges:lt,changeSelectedEdges:function(x){Fe(x)},changeSelectedNodes:function(x){Ce((0,X.uniq)(x))},data:c,style:Bd,queriedId:(Re==null?void 0:Re.get_current_node_id())||"",statistics:D,settings:Pe,onClearGraph:Xd,onEdgeMenuClick:cu,chatbotVisible:!!e.postMessage,onClickNode:hu,onClickEdge:fu,onCanvasMenuClick:su,onNodeMenuClick:du,children:[(0,t.jsx)(Nn,{position:"top",width:"300px",height:"100%",closable:!0,title:"Statistics",visible:Va,onClose:function(){_i(!1)},children:(0,t.jsx)(Ii,{nodeStat:N,edgeStat:u})}),(0,t.jsx)(Nn,{position:"bottom",width:"300px",height:"60vh",title:"Charts",closable:!1,children:(0,t.jsx)(ji,{data:c})}),(0,t.jsx)(Nn,{position:"right",width:"80%",closable:!1,maskVisible:!0,visible:ht,onClose:Vi,children:Mt&&e.NodeInfoPanel?(0,t.jsx)(e.NodeInfoPanel,{node:Mt}):(0,t.jsx)(Oe.Z,{description:"No node selected"})}),(0,t.jsx)(Nn,{position:"right",width:"80%",closable:!1,maskVisible:!0,visible:jt,onClose:Vi,children:Ye&&e.EdgeInfoPanel?(0,t.jsx)(e.EdgeInfoPanel,{edgeInfo:Ye}):(0,t.jsx)(Oe.Z,{description:"No edge selected"})}),Ct?(0,t.jsx)(_t,{onClose:function(){Le(!1)},minWidth:"600px",minHeight:"400px",width:"800px",height:"600px",maxWidth:"80vw",title:"Graph Table",children:(0,t.jsx)(Ti,{style:{width:"100%",height:"100%"},nodeDataSources:I,edgeDataSources:O,selectedNodeKeys:ce,selectedEdgeKeys:lt,onSelectedNodes:function(x){return new Promise(function(Y,K){var H=x.map(function(he){return he.id});Ce((0,X.uniq)(H)),Y()})},onSelectedEdges:function(x){return new Promise(function(Y,K){var H=x.map(function(ee){return ee.relid});Fe(H);var he=x.map(function(ee){return ee.source}).concat(x.map(function(ee){return ee.target}));Ce((0,X.uniq)(he)),Y()})},onDeletedEdges:function(x,Y){var K=function(he){return"".concat(he.label,"::").concat(he.id)};return new Promise(function(H,he){var ee=x.map(function(ze){return ze.relid}),xe=c.edges.filter(function(ze){return!ee.includes(ze.relid)});if(Y.length==0)return y({nodes:c.nodes,edges:xe}),ha(c.nodes,xe),Ce([]),Fe([]),H();var tt=Y.map(function(ze){return K(ze)}),Ke=tt.filter(function(ze){var At=xe.find(function(kt){return kt.source==ze||kt.target==ze});return!At}),Je=c.nodes.filter(function(ze){return!Ke.includes(K({id:ze.data.id,label:ze.data.label}))});return console.log("Deleting Node Keys: ",Ke,tt,xe,Je),y({nodes:Je,edges:xe}),ha(Je,xe),Ce([]),Fe([]),H()})},edgeStat:u})}):null,tn?(0,t.jsx)(_t,{onClose:function(){Yt(!1)},width:"600px",minWidth:"600px",minHeight:"500px",height:"600px",maxWidth:"80vw",title:"Metrics Panel (Graph Algorithms)",children:(0,t.jsx)(hd,{onSelectedRows:function(x){},edges:ys(O,I)})}):null,P?(0,t.jsx)(_t,{onClose:function(){A(!1)},width:"600px",title:"Node Similarity [t-SNE]",children:(0,t.jsx)(bi,{data:ye,method:"tsne",description:'If you expect to highlight nodes on the chart, you need to enable the "Focus" and "Select" mode.',onClick:function(x){Ce([is(x)])}})}):null,Dn&&Ue?(0,t.jsx)(_t,{onClose:function(){bt(!1)},width:"600px",minWidth:"600px",minHeight:"500px",height:"600px",maxWidth:"80vw",title:"Explanation Panel",children:(0,t.jsx)(Zc,{data:Ue})}):null,(0,t.jsx)(Ai,{visible:de,graphs:Ba,onLoad:eu,onDelete:tu,treeFormat:!0,parent:document.getElementById("knowledge-graph-container"),onClose:function(){E(!1)},onUpload:function(x){return Wi(x)},selectedGraphId:Ut}),(0,t.jsx)(ki,{visible:te,payload:ie,parent:document.getElementById("knowledge-graph-container"),onClose:function(){return new Promise(function(x,Y){Me(!1),x()})},onSubmit:function(x){return Wi(x).then(function(Y){var K=Y.id;cn(K)}).finally(function(){Me(!1)})}})]}),i]})]})})})},Wd=Vd}}]);
